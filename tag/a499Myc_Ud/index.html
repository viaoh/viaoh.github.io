<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="keywords" content="Gridea静态个人博客">
<meta name="description" content="Windy City Rose">
<meta name="theme-color" content="#000">
<title>liuyoung&#39;s blog</title>
<link rel="shortcut icon" href="/favicon.ico?v=1761614689580">
<link rel="stylesheet" href="/media/css/pisces.css">
<link rel="stylesheet" href="/media/fonts/font-awesome.css">
<link
  href="//fonts.loli.net/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Rosario:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext"
  rel="stylesheet" type="text/css">

<link href="/media/hljs/styles/default.css"
  rel="stylesheet">

<link rel="stylesheet" href="/styles/main.css">
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script src="/media/js/jquery.js"></script>
<script src="/media/hljs/highlight.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.ui.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"
  integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"
  integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"
  integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
  onload="renderMathInElement(document.body);"></script>






</head>

<body>
  <div class="head-top-line"></div>
  <div class="header-box">
    
<div class="pisces">
  <header class="header  ">
    <div class="blog-header box-shadow-wrapper bg-color " id="header">
      <div class="nav-toggle" id="nav_toggle">
        <div class="toggle-box">
          <div class="line line-top"></div>
          <div class="line line-center"></div>
          <div class="line line-bottom"></div>
        </div>
      </div>
      <div class="site-meta">       
        <div class="site-title">
          
            <a href="/" class="brand">
              <span>liuyoung&#39;s blog</span>
            </a>  
          
        </div>
        
          <p class="subtitle">青云当自致  何必求知音</p>
        
      </div>
      <nav class="site-nav" id="site_nav">
        <ul id="nav_ul">
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/" target="_self">
                  <i class="fa fa-globe"></i> 首页
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/archives" target="_self">
                  <i class="fa fa-globe"></i> 归档
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/tags" target="_self">
                  <i class="fa fa-globe"></i> 标签
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="https://viaoh.github.io/post/XuQvrNvEf" target="_self">
                  <i class="fa fa-globe"></i> 关于
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="https://viaoh.github.io/post/BOgj-ybOJ" target="_self">
                  <i class="fa fa-globe"></i> 成绩单
                </a>
              
            </li>
          
          
            
              <li class="nav-item ">
                <a href="/friends/" target="_self">
                  
                    <i class="fa fa-address-book"></i> 友链
                  
                </a>
              </li>
            
          
          
            <li id="fa_search" class="nav-item">
              <a href="javascript:void(0);">
                <i class="fa fa-search"></i> <span class="language" data-lan="search">搜索</span>
              </a>
            </li>
          
        </ul>
      </nav>
    </div>
  </header>
</div>

<script type="text/javascript"> 
 
  let showNav = true;

  let navToggle = document.querySelector('#nav_toggle'),
  siteNav = document.querySelector('#site_nav');
  
  function navClick() {
    let sideBar = document.querySelector('.sidebar');
    let navUl = document.querySelector('#nav_ul');
    navToggle.classList.toggle('nav-toggle-active');
    siteNav.classList.toggle('nav-menu-active');
    if (siteNav.classList.contains('nav-menu-active')) {
      siteNav.style = "height: " + (navUl.children.length * 42) +"px !important";
    } else {
      siteNav.style = "";
    }
  }

  navToggle.addEventListener('click',navClick);  
</script>
  </div>
  <div class="main-continer">
    
    <div
      class="section-layout  pisces">
      <div class="section-layout-wrapper">
        <div id="sidebarMeta" class="sidebar">
    
<div class="sidebar-wrapper box-shadow-wrapper bg-color">
  <div class="sidebar-item">
    <img class="site-author-image right-motion" src="/images/avatar.png"/>
    <p class="site-author-name">Windy City Rose</p>
    
    <div class="site-description right-motion">
      
      
      
        <p>这个人很懒</p>
      
        <p>什么也没有留下</p>
      
      
    </div>
    
  </div>
  <div class="sidebar-item side-item-stat right-motion">
    <div class="sidebar-item-box">
      <a href="/archives/">
        
        <span class="site-item-stat-count">45</span>
        <span class="site-item-stat-name language" data-lan="article">文章</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="/tags/">
        <span class="site-item-stat-count">11</span>
        <span class="site-item-stat-name language" data-lan="tag">标签</span>
      </a>
    </div>
  </div>
  
    
      <div class="sidebar-item">
        <span class="site-item-rss">
            <i class="fa fa-rss"></i>
            <a href="https://viaoh.github.io/atom.xml" target="_blank">RSS</a>
        </span>
      </div>
    
  
  
    <div class="sidebar-item sidebar-item-social">
      <div class="social-item">
        
          
            <a href="https://www.zhihu.com/people/viaoh-">
              <i class="fa fa-envelope-square" title="知乎"></i>
            </a>
          
            <a href="https://weibo.com/viaoh">
              <i class="fa fa-weibo" title="微博"></i>
            </a>
          
            <a href="https://github.com/viaoh/viaoh.github.io">
              <i class="fa fa-github-alt" title="github"></i>
            </a>
          
        
        
      </div>
    </div>
  



</div>
</div>
<script>
  let sidebarMeta = document.querySelector('#sidebarMeta');
  let scheme = 'pisces';
  let sidebarWrapper = document.querySelector('.sidebar-wrapper');
  if (sidebarMeta && (scheme === 'pisces' || scheme === 'gemini')) {
    document.addEventListener('scroll', function(e) {
      if (document.scrollingElement.scrollTop > parseInt(sidebarMeta.style.marginTop) + 10) {
        sidebarWrapper.classList.add('home-sidebar-fixed')
      } else {
        sidebarWrapper.classList.remove('home-sidebar-fixed')
      }
    });
  }
  </script>
        <div class="section-box tag-line box-shadow-wrapper">
          <section class="section tags-section posts-expand bg-color">
            <div class="padding-wrapper">
  <div class="tag-timeline-box">
    <div class="tag-timeline-wrapper">
      <div class="tag-timeline-title">
        <h2>
          软件安装和环境配置
          <small class="language" data-lan="tag">标签</small>
        </h2>
      </div>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <a href="https://viaoh.github.io/post/d01CVJdU_d/">
        <div class="motion-warpper">
          <div class="tag-post-node">
            <h1>
              09-13
              <small>IntelliJ IDEA 2020.2 破解版（附永久破解激活方法）</small>
            </h1>
          </div>
        </div>
      </a>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <a href="https://viaoh.github.io/post/QiGBPxk_U/">
        <div class="motion-warpper">
          <div class="tag-post-node">
            <h1>
              05-11
              <small>指定路径执行指定命令</small>
            </h1>
          </div>
        </div>
      </a>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <a href="https://viaoh.github.io/post/qVu2LurYm/">
        <div class="motion-warpper">
          <div class="tag-post-node">
            <h1>
              05-11
              <small>Spring Boot配置文件</small>
            </h1>
          </div>
        </div>
      </a>
      
      
      
      
      
      <a href="https://viaoh.github.io/post/KBCRP8JEb/">
        <div class="motion-warpper">
          <div class="tag-post-node">
            <h1>
              05-11
              <small>Java JDK和Maven配置</small>
            </h1>
          </div>
        </div>
      </a>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
    </div>
  </div>
</div>
          </section>
        </div>
      </div>
    </div>
    <div class="footer-box">
  <footer class="footer">
    <center id="runTimeBox">
      已运行:<span id="run_time"></span>
    </center>
    <span id="busuanzi_container_site_pv">浏览数:<span id="busuanzi_value_site_pv"></span> 次</span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">访客数:<span id="busuanzi_value_site_uv"></span> 人</span>

    <script>
      BirthDay = new Date('');
      if (BirthDay.getTime()) {
        function runTime() {
          str = "";
          today = new Date();
          timeold = today.getTime() - BirthDay.getTime();
          msPerDay = 24 * 60 * 60 * 1000;
          e_daysold = timeold / msPerDay;
          daysold = Math.floor(e_daysold);
          str += daysold + "天";
          return str;
        }
        setInterval(function () {
          $("#run_time").html(runTime());
        }, 1000);
      } else {
        document.querySelector('.footer').removeChild(document.querySelector('#runTimeBox'));
      }
    </script>
    <div class="poweredby">
      
    </div>
  </footer>
  
    
        <div class="pisces back-to-top" id="back_to_top">
          <i class="fa fa-arrow-up"></i>
          
            <span class="scrollpercent"> <span id="back_to_top_text">0</span>% </span>
            
        </div>
        
                  
                        
</div>
<script>
  let sideBarOpen = "sidebar-open";
  let body = document.body;
  let back2Top = document.querySelector("#back_to_top"),
    back2TopText = document.querySelector("#back_to_top_text"),
    drawerBox = document.querySelector("#drawer_box"),
    rightSideBar = document.querySelector(".sidebar"),
    viewport = document.querySelector("body");

  function scrollAnimation(currentY, targetY) {
    let needScrollTop = targetY - currentY;
    let _currentY = currentY;
    setTimeout(() => {
      const dist = Math.ceil(needScrollTop / 10);
      _currentY += dist;
      window.scrollTo(_currentY, currentY);
      if (needScrollTop > 10 || needScrollTop < -10) {
        scrollAnimation(_currentY, targetY);
      } else {
        window.scrollTo(_currentY, targetY);
      }
    }, 1);
  }

  back2Top.addEventListener("click", function (e) {
    scrollAnimation(document.scrollingElement.scrollTop, 0);
    e.stopPropagation();
    return false;
  });

  window.addEventListener("scroll", function (e) {
    let percent =
      (document.scrollingElement.scrollTop /
        (document.scrollingElement.scrollHeight -
          document.scrollingElement.clientHeight)) *
      100;
    if (percent > 1 && !back2Top.classList.contains("back-top-active")) {
      back2Top.classList.add("back-top-active");
    }
    if (percent == 0) {
      back2Top.classList.remove("back-top-active");
    }
    if (back2TopText) {
      back2TopText.textContent = Math.floor(percent);
    }
  });

  let hasCacu = false;
  window.addEventListener("resize", function (e) {
    calcuHeight();
  });

  function calcuHeight() {
    // 动态调整站点概览高度
    if (
      (!hasCacu && back2Top.classList.contains("pisces")) ||
      back2Top.classList.contains("gemini")
    ) {
      let sideBar = document.querySelector(".sidebar");
      let navUl = document.querySelector("#site_nav");
      sideBar.style =
        "margin-top:" + (navUl.offsetHeight + navUl.offsetTop + 15) + "px;";
      hasCacu = true;
    }
  }
  calcuHeight();

  let open = false,
    MOTION_TIME = 300,
    RIGHT_MOVE_DIS = "320px";

  if (drawerBox) {
    let rightMotions = document.querySelectorAll(".right-motion");
    let right = drawerBox.classList.contains("right");

    let transitionDir = right
      ? "transition.slideRightIn"
      : "transition.slideLeftIn";

    let openProp, closeProp;
    if (right) {
      openProp = {
        paddingRight: RIGHT_MOVE_DIS,
      };
      closeProp = {
        paddingRight: "0px",
      };
    } else {
      openProp = {
        paddingLeft: RIGHT_MOVE_DIS,
      };
      closeProp = {
        paddingLeft: "0px",
      };
    }

    drawerBox.onclick = function () {
      open = !open;
      jQuery.Velocity(rightSideBar, "stop");
      jQuery.Velocity(viewport, "stop");
      jQuery.Velocity(rightMotions, "stop");
      if (open) {
        jQuery.Velocity(
          rightSideBar,
          {
            width: RIGHT_MOVE_DIS,
          },
          {
            duration: MOTION_TIME,
            begin: function () {
              jQuery.Velocity(rightMotions, transitionDir, {});
            },
          }
        );
        jQuery.Velocity(viewport, openProp, {
          duration: MOTION_TIME,
        });
      } else {
        jQuery.Velocity(
          rightSideBar,
          {
            width: "0px",
          },
          {
            duration: MOTION_TIME,
            begin: function () {
              jQuery.Velocity(rightMotions, {
                opacity: 0,
              });
            },
          }
        );
        jQuery.Velocity(viewport, closeProp, {
          duration: MOTION_TIME,
        });
      }
      for (let i = 0; i < drawerBox.children.length; i++) {
        drawerBox.children[i].classList.toggle("muse-line");
      }
      drawerBox.classList.toggle(sideBarOpen);
    };
  }

  // 链接跳转
  let newWindow = "true";
  if (newWindow === "true") {
    let links = document.querySelectorAll(".post-body a");
    links.forEach((item) => {
      if (!item.classList.contains("btn")) {
        item.setAttribute("target", "_blank");
      }
    });
  }

  let faSearch = document.querySelector("#fa_search");
  faSearch &&
    faSearch.addEventListener("click", function () {
      document.querySelector("#search_mask").style = "";
    });

  // 代码高亮
  hljs.initHighlightingOnLoad();

  // 离开当前页title变化
  var leaveTitle = "";
  var normal_title = document.title;
  if (leaveTitle) {
    document.addEventListener("visibilitychange", function () {
      if (document.visibilityState == "hidden") {
        normal_title = document.title;
        document.title = leaveTitle;
      } else {
        document.title = normal_title;
      }
    });
  }
</script>

<link rel="stylesheet" href="/media/css/jquery.fancybox.css" />
<script src="/media/js/jquery.fancybox.js"></script>

<script>
  let images = document.querySelectorAll(".section img");
  images.forEach((image) => {
    var parent = image.parentElement;
    var next = image.nextElementSibling;
    parent.removeChild(image);
    var aelem = document.createElement("a");
    aelem.href = image.src;
    aelem.dataset["fancybox"] = "images";
    aelem.dataset["rel"] = "fancybox-button";
    aelem.classList.add("fancybox");
    aelem.appendChild(image);
    parent.insertBefore(aelem, next);
  });
</script>
  </div>
</body>

  <div class="search-mask" id="search_mask" style="display: none;">
  <div class="search-box">
    <div class="search-title">
      <i class="fa fa-search"></i>
      <div class="input-box">
        <input id="search" type="text" class="language" data-lan="search" placeholder="搜索">
      </div>
      <i id="close" class="fa fa-times-circle"></i>
    </div>
    <div class="stat-box">
      <span id="stat_count">0</span><span class="language" data-lan="stat">条相关条目，使用了</span><span id="stat_times">0</span><span class="language" data-lan="stat-time">毫秒</span>
      <hr>
    </div>
    <div class="result" id="result">
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/HoVv5q9zHi/"" data-c="
          &lt;p&gt;国内从 Docker Hub 拉取镜像有时会遇到困难或拉取失败，但可以配置国内镜像源加速镜像拉取。但许多曾经常用的国内镜像站（包括各种云服务商和高校镜像站）已经无法使用。因此，本人开始搜索并汇总了目前可用的镜像站和镜像加速地址，并计划定期测试它们的可用性，并更新这个列表。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;9月18日确认可用 &lt;a href=&#34;https://docker.1ms.run/&#34;&gt;https://docker.1ms.run&lt;/a&gt;（&lt;strong&gt;免费/拉取速度快/稳定/企业级保障&lt;/strong&gt;，支持各大NAS厂商：群晖 ，极空间等。&lt;strong&gt;主流服务已内置该镜像源：宝塔，IStore，linuxmirrors， 爱快等&lt;/strong&gt;，来自各厂商的认同）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;主流 Docker Hub 镜像加速站清单（长期维护）&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;地址&lt;/th&gt;
&lt;th&gt;运营方&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&#34;https://docker.1ms.run/&#34;&gt;https://docker.1ms.run&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;毫秒镜像(木雷坞公司)&lt;/td&gt;
&lt;td&gt;Cloudflare、境内CDN&lt;/td&gt;
&lt;td&gt;提供在线技术支持、长期维护、完整文档、活跃社区，远程协助。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&#34;https://mirror.ccs.tencentyun.com/&#34;&gt;https://mirror.ccs.tencentyun.com&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;腾讯云&lt;/td&gt;
&lt;td&gt;境内CDN&lt;/td&gt;
&lt;td&gt;仅腾讯云服务器内推荐使用&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&#34;https://docker.m.daocloud.io/&#34;&gt;https://docker.m.daocloud.io&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;DaoCloud&lt;/td&gt;
&lt;td&gt;云服务器转发&lt;/td&gt;
&lt;td&gt;白名单 &amp;amp; 限流&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&#34;https://docker.1panel.live/&#34;&gt;https://docker.1panel.live&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;1Panel&lt;/td&gt;
&lt;td&gt;Cloudflare&lt;/td&gt;
&lt;td&gt;部分地区可能无法访问&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&#34;https://hub.rat.dev/&#34;&gt;https://hub.rat.dev&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;耗子面板&lt;/td&gt;
&lt;td&gt;使用毫秒镜像&lt;/td&gt;
&lt;td&gt;部分地区可能无法访问&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&#34;https://docker.1panel.dev/&#34;&gt;https://docker.1panel.dev&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;1Panel 核心用户无名驱动&lt;/td&gt;
&lt;td&gt;Cloudflare&lt;/td&gt;
&lt;td&gt;部分地区可能无法访问&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&#34;https://docker.anye.in/&#34;&gt;https://docker.anye.in&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;1Panel 核心用户 Anye 驱动&lt;/td&gt;
&lt;td&gt;Cloudflare&lt;/td&gt;
&lt;td&gt;部分地区可能无法访问&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&#34;https://docker.amingg.com/&#34;&gt;https://docker.amingg.com&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;爱铭网络&lt;/td&gt;
&lt;td&gt;Cloudflare&lt;/td&gt;
&lt;td&gt;部分地区可能无法访问&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href=&#34;https://docker.367231.xyz/&#34;&gt;https://docker.367231.xyz&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;1Panel 核心用户 GXL 驱动&lt;/td&gt;
&lt;td&gt;Cloudflare&lt;/td&gt;
&lt;td&gt;部分地区可能无法访问&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;传统的docker-镜像加速配置方法&#34;&gt;&lt;strong&gt;传统的Docker 镜像加速配置方法&lt;/strong&gt;&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;从上面选一个或多个地址&lt;/li&gt;
&lt;li&gt;执行以下命令，注意替换地址&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json &amp;lt;&amp;lt;EOF
{
    &amp;quot;registry-mirrors&amp;quot;: [
        &amp;quot;https://docker.1ms.run&amp;quot;
    ]
}
EOF
sudo systemctl daemon-reload
sudo systemctl restart docker
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;验证镜像加速是否生效&#34;&gt;&lt;strong&gt;验证镜像加速是否生效&lt;/strong&gt;&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;docker pull docker.1ms.run/library/mysql
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;一个命令完成所有&#34;&gt;&lt;strong&gt;一个命令完成所有&lt;/strong&gt;&lt;/h3&gt;
&lt;h3 id=&#34;安装docker并配置镜像加速&#34;&gt;安装Docker并配置镜像加速&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-text&#34;&gt;bash &amp;lt;(curl -f -s --connect-timeout 10 --retry 3 https://linuxmirrors.cn/docker.sh) --source mirrors.tencent.com/docker-ce --source-registry docker.1ms.run --protocol https --install-latested true --close-firewall false --ignore-backup-tips
&lt;/code&gt;&lt;/pre&gt;
">（9月18日更新）Docker 国内镜像源加速列表</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/43WtI8Lt1k/"" data-c="
          &lt;h3 id=&#34;1删除登录用户凭据&#34;&gt;&lt;strong&gt;1.删除登录用户凭据&lt;/strong&gt;&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://pica.zhimg.com/80/v2-b81a63885d35dc17f6fe70d4f6942edd_720w.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;打开控制面板凭据管理器——–windows凭据，找到要删除的登录用户&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://pic1.zhimg.com/80/v2-3a1ef1dc628dbdc9e4a6095c5d64ae1f_720w.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://pic-private.zhihu.com/v2-1c44f1fa5d65e0231d36e1d52da33e93~resize:1440:q75.png?source=1f5c5e47&amp;amp;expiration=1758536674&amp;amp;auth_key=1758536674-0-0-b4be711b20206c12a7726d578b10c862&amp;amp;protocol=v2&amp;amp;sampling=False&amp;amp;animatedImagePlayCount=1&amp;amp;overTime=60&amp;amp;incremental=False&amp;amp;sceneCode=article_draft_web&amp;amp;animatedImageAutoPlay=False&amp;amp;retryCount=3&amp;amp;precoder=False&amp;amp;draft_token=1953509978800357674&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;这样登录的&lt;a href=&#34;https://so.csdn.net/so/search?q=%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF&amp;amp;spm=1001.2101.3001.7020&#34;&gt;用户信息&lt;/a&gt;就没有了&lt;/p&gt;
&lt;h3 id=&#34;2删除登录地址信息&#34;&gt;&lt;strong&gt;2.删除登录地址信息&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://so.csdn.net/so/search?q=%E6%89%93%E5%BC%80%E6%B3%A8%E5%86%8C%E8%A1%A8&amp;amp;spm=1001.2101.3001.7020&#34;&gt;打开注册表&lt;/a&gt;管理器*（快捷键”win+r”，输入regedit）&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://so.csdn.net/so/search?q=%E8%AE%A1%E7%AE%97%E6%9C%BA&amp;amp;spm=1001.2101.3001.7020&#34;&gt;计算机&lt;/a&gt;\HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://pica.zhimg.com/80/v2-f702647b65ba80e1cfa7e9c51604c99b_720w.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://pica.zhimg.com/80/v2-570c18f80c1bbede5753375d32194133_720w.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;再次重新打开远程桌面，就看不到任何的登录信息了&lt;/p&gt;
">windows 远程桌面删除登录IP和用户信息记录</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/7nZEOIzXbg/"" data-c="
          &lt;p&gt;【出现问题】&lt;/p&gt;
&lt;p&gt;远程桌面提示密码过期等信息，无法连接。&lt;/p&gt;
&lt;p&gt;【问题原因】&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://so.csdn.net/so/search?q=%E7%B3%BB%E7%BB%9F%E8%AE%BE%E7%BD%AE&amp;amp;spm=1001.2101.3001.7020&#34;&gt;系统设置&lt;/a&gt;问题。&lt;/p&gt;
&lt;p&gt;【解决方案】&lt;/p&gt;
&lt;p&gt;1、右击此电脑，打开属性&amp;gt;高级系统设置&amp;gt;远程&amp;gt;远程桌面      选择“允许&lt;a href=&#34;https://so.csdn.net/so/search?q=%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5&amp;amp;spm=1001.2101.3001.7020&#34;&gt;远程连接&lt;/a&gt;到此计算机”      不勾选“仅允许运行使用网络级别身份验证的远程桌面的计算机连接（建议）”。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://picx.zhimg.com/80/v2-fce87ebcf1278eb52ec9ece990f9df73_720w.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;2、右键单击“开始”按钮，选择“运行”，输入gpedit.msc，打开“本底组策略编辑器”。      依次选择 计算机配置&amp;gt;管理模板&amp;gt;Windows组件&amp;gt;远程桌面服务&amp;gt;远程桌面会话主机&amp;gt;安全&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://picx.zhimg.com/80/v2-80b92697af4daa1e6fd131d86d127f73_720w.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;3、双击“远程（RDP）连接要求使用指定的安全层”，选择“已启用”，安全层选择“RCP”。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://picx.zhimg.com/80/v2-58435e96a92f4bcaed3796830364f71a_720w.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;4、重启电脑或更新策略。      右键单击“开始”按钮，选择“运行”，输入cmd，打开命令行。      执行 gpupdate命令，更新组策略。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://pic1.zhimg.com/80/v2-d806db8b184618baeb1a861a32af3744_720w.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;【备注说明】&lt;/p&gt;
&lt;p&gt;d=====(￣▽￣*)b&lt;/p&gt;
">Win11系统远程桌面连接问题</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/d01CVJdU_d/"" data-c="
          &lt;p&gt;对于Java学习者和开发者而言，IDEA是很多人最常用的软件了，也是站长一直推荐大家使用的，在百度、腾讯、阿里巴巴等一线互联网公司也是被重度使用的工具了，深受程序员和开发者的喜爱了。 jetbrains公司发布了Java的最强编辑器IntelliJ IDEA 2020.2。本次更新提供了重大的性能和可用性改进，包括更快的启动，主题和键盘映射插件的更容易安装，增强的VCS工作流以及增加了对微服务框架，MongoDB等的支持。 IntelliJ IDEA被认为是当前Java开发效率最快的IDE工具，比eclipse不知道高哪去了。它整合了开发过程中实用的众多功能，几乎可以不用鼠标可以方便的完成你要做的任何事情，最大程度的加快开发的速度。简单而又功能强大。与其他的一些繁冗而复杂的IDE工具有鲜明的对比。 不多哔哔了，直接进入主题！&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://pica.zhimg.com/80/v2-cc748f01fba07b7f3bf55359f179f69d_720w.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;安装破解教程（原创） 1.先下载安装包，然后安装，一路next即可，这里直接附上官网安装包下载地址： &lt;a href=&#34;https://download.jetbrains.com/idea/ideaIU-2020.2.3.exe?_ga=2.264306831.1489878717.1603972199-2094421438.1596698041&#34;&gt;https://download.jetbrains.com/idea/ideaIU-2020.2.3.exe?_ga=2.264306831.1489878717.1603972199-2094421438.1596698041&lt;/a&gt; 点击下载，静心等待其下载完毕即可。 2.下载完成后，双击 ideaIU-2020.2.3.exe,打开安装软件； PS: 如果电脑上之前有安装老版本的 IDEA, 会提示卸载，小伙伴们按照提示，先卸载掉老版本的 IDEA。 安装目录默认为 C:\Program Files\JetBrains\IntelliJ IDEA 2020.2, 这里笔者选择的是默认路径，一路默认安装即可； 勾选自己想要创建的桌面快捷方式，笔者的操作系统是 64 位的，所以勾选的 64 位快捷方式：&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://pic1.zhimg.com/80/v2-6fcf245e4c73c994fbf6d16af0f6a08f_720w.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://picx.zhimg.com/80/v2-785f1b6f963e453d54bc133028f6277c_720w.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;安装完成后，勾选 Run IntelliJ IDEA，点击 finish 运行软件:&lt;/li&gt;
&lt;/ol&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://pic1.zhimg.com/80/v2-d203b8a6f505a3b922a27c33fceedb1c_720w.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;会先弹出一个注册框，勾选 Evaluate for free, 点击 Evaluate，然后再进入主界面；&lt;/li&gt;
&lt;/ol&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://pic1.zhimg.com/80/v2-103f3075cac264461ab0311e2ebb1820_720w.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;先下载破解补丁，然后解压： 破解补丁下载地址：&lt;a href=&#34;https://wwsp.lanzouw.com/iK81a19zcy7e&#34;&gt;IDEA永久激活补丁.zip - 蓝奏云&lt;/a&gt; 注意，如果没有弹出上面的界面，可执行破解补丁重置30天试用期脚本，打开reset_script文件夹后，有对应系统的执行脚本，执行即可（双击执行）：&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://picx.zhimg.com/80/v2-c10b0fd97c4e6af2caf7d395c2ade4e4_720w.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;windows系统：reset_jetbrains_eval_windows.vbs linux/mac系统：reset_jetbrains_eval_mac_linux.sh 5. 记得安装成功之后先打开IDEA主界面哦，然后将网盘中最新的 IDEA 破解补丁 BetterIntelliJ.zip拖入 IDEA 界面中，如下图所示： 如果有出现拖不进去的情况，请重启 IDEA ，新建一个Java 项目，再次试试&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://picx.zhimg.com/80/v2-ad4ed9c22fe2c7da807a37ec6698547e_720w.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;拖入补丁后会弹框，点击 restart 重启 idea： 7.激活后补丁不要移动，不要删除~ 补丁安装成功后，先打开IDEA软件，点击register，然后需要输入激活补丁key.txt里面的激活码到activation code里面激活即可，两个步骤缺一不可，否则会激活失败~&lt;/li&gt;
&lt;/ol&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://picx.zhimg.com/80/v2-d7eb5e3378815c37b7b7354ddef9a9b4_720w.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://picx.zhimg.com/80/v2-86a9820e23567ea599b105fabd03d8bf_720w.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;点击activate，重启 IDEA 即可； 8. 重启IDE，搞定，完美破解（激活到2099年~perfect）。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://picx.zhimg.com/80/v2-26b423b0587156ad301037aa72cad633_720w.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
此方法和破解补丁同样适用于以下版本：&lt;br&gt;
以下IDE版本实测可成功激活：&lt;br&gt;
IntelliJ IDEA 2020.2.3及以下&lt;br&gt;
AppCode 2019.3.7及以下&lt;br&gt;
CLion 2019.3.5及以下&lt;br&gt;
DataGrip 2020.2.3及以下&lt;br&gt;
GoLand 2020.2.3及以下&lt;br&gt;
PhpStorm 2020.2.3及以下&lt;br&gt;
PyCharm 2020.2.3及以下&lt;br&gt;
Rider 2019.3.4及以下&lt;br&gt;
RubyMine 2019.3.4及以下&lt;br&gt;
WebStorm 2020.2.3及以下&lt;/p&gt;
">IntelliJ IDEA 2020.2 破解版（附永久破解激活方法）</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/hRey3Ee7Kl/"" data-c="
          &lt;pre&gt;&lt;code class=&#34;language-vb&#34;&gt;Sub BatchMultipleReplaceInDocuments()
    Dim strFolder As String
    Dim strFile As String
    Dim doc As Document
    Dim fDialog As FileDialog
    Dim i As Integer, j As Integer
    Dim replaceList(1 To 10, 1 To 2) As String &#39; 最多10个替换对
    
    &#39; 设置替换列表 - 您可以在这里添加更多的查找/替换对
    replaceList(1, 1) = &amp;quot;A、&amp;quot;  &#39; 查找
    replaceList(1, 2) = &amp;quot;A.&amp;quot;  &#39; 替换
    
    replaceList(2, 1) = &amp;quot;B、&amp;quot;
    replaceList(2, 2) = &amp;quot;B.&amp;quot;
    
    replaceList(3, 1) = &amp;quot;C、&amp;quot;
    replaceList(3, 2) = &amp;quot;C.&amp;quot;
    
    replaceList(4, 1) = &amp;quot;D、&amp;quot;
    replaceList(4, 2) = &amp;quot;D.&amp;quot;
    
    replaceList(5, 1) = &amp;quot;E、&amp;quot;
    replaceList(5, 2) = &amp;quot;E.&amp;quot;
    
    replaceList(6, 1) = &amp;quot;F、&amp;quot;
    replaceList(6, 2) = &amp;quot;F.&amp;quot;
    
    replaceList(7, 1) = &amp;quot;G、&amp;quot;
    replaceList(7, 2) = &amp;quot;G.&amp;quot;
    
    replaceList(8, 1) = &amp;quot;答案：&amp;quot;
    replaceList(8, 2) = &amp;quot;正确答案:&amp;quot;
    
    replaceList(9, 1) = &amp;quot;解析：&amp;quot;
    replaceList(9, 2) = &amp;quot;解题思路:&amp;quot;
    
    &#39; 选择文件夹对话框
    Set fDialog = Application.FileDialog(msoFileDialogFolderPicker)
    With fDialog
        .Title = &amp;quot;选择包含Word文档的文件夹&amp;quot;
        .AllowMultiSelect = False
        If .Show &amp;lt;&amp;gt; -1 Then Exit Sub
        strFolder = .SelectedItems(1)
    End With
    
    If Right(strFolder, 1) &amp;lt;&amp;gt; &amp;quot;\&amp;quot; Then strFolder = strFolder &amp;amp; &amp;quot;\&amp;quot;
    
    strFile = Dir(strFolder &amp;amp; &amp;quot;*.doc*&amp;quot;)
    Application.StatusBar = &amp;quot;正在处理文档...&amp;quot;
    
    Do While strFile &amp;lt;&amp;gt; &amp;quot;&amp;quot;
        On Error Resume Next
        Set doc = Documents.Open(strFolder &amp;amp; strFile)
        
        If Err.Number = 0 Then
            &#39; 执行所有替换操作
            For j = 1 To UBound(replaceList)
                If replaceList(j, 1) &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then
                    With doc.Content.Find
                        .Text = replaceList(j, 1)
                        .Replacement.Text = replaceList(j, 2)
                        .Wrap = wdFindContinue
                        .Execute Replace:=wdReplaceAll
                    End With
                End If
            Next j
            
            doc.Save
            doc.Close
            i = i + 1
            Application.StatusBar = &amp;quot;已处理 &amp;quot; &amp;amp; i &amp;amp; &amp;quot; 个文档，当前处理: &amp;quot; &amp;amp; strFile
        Else
            MsgBox &amp;quot;无法打开文件: &amp;quot; &amp;amp; strFile, vbExclamation
            Err.Clear
        End If
        
        strFile = Dir()
    Loop
    
    Application.StatusBar = False
    MsgBox &amp;quot;处理完成！共处理了 &amp;quot; &amp;amp; i &amp;amp; &amp;quot; 个文档。&amp;quot;, vbInformation
End Sub
&lt;/code&gt;&lt;/pre&gt;
">WPS宏多个docx文档批量替换文本</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/wXJDiLgYXY/"" data-c="
          &lt;p&gt;&lt;strong&gt;安装包依赖检查&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import sys
import os
import subprocess
import platform
import importlib.util
import site

# 国内镜像源配置
MIRROR_SOURCES = {
    &amp;quot;1&amp;quot;: &amp;quot;https://pypi.tuna.tsinghua.edu.cn/simple&amp;quot;,  # 清华大学
    &amp;quot;2&amp;quot;: &amp;quot;https://mirrors.aliyun.com/pypi/simple&amp;quot;,    # 阿里云
    &amp;quot;3&amp;quot;: &amp;quot;https://pypi.mirrors.ustc.edu.cn/simple&amp;quot;,   # 中国科技大学
    &amp;quot;4&amp;quot;: &amp;quot;https://pypi.doubanio.com/simple&amp;quot;,          # 豆瓣
    &amp;quot;5&amp;quot;: &amp;quot;https://mirrors.bfsu.edu.cn/pypi/web/simple&amp;quot;,# 北京外国语大学
    &amp;quot;0&amp;quot;: None  # 默认官方源
}

def get_interpreter_info():
    &amp;quot;&amp;quot;&amp;quot;获取当前Python解释器信息（增强版）&amp;quot;&amp;quot;&amp;quot;
    # 获取解释器路径（这是最可靠的路径）
    interpreter_path = sys.executable
    
    # 更可靠的虚拟环境检测方法
    is_venv = False
    env_type = &amp;quot;系统环境&amp;quot;
    
    # 方法1：检查标准虚拟环境标志
    if hasattr(sys, &#39;base_prefix&#39;) and sys.prefix != sys.base_prefix:
        is_venv = True
        env_type = &amp;quot;标准虚拟环境&amp;quot;
    
    # 方法2：检查virtualenv创建的环境
    elif hasattr(sys, &#39;real_prefix&#39;):
        is_venv = True
        env_type = &amp;quot;virtualenv环境&amp;quot;
    
    # 方法3：检查conda环境
    elif &#39;CONDA_PREFIX&#39; in os.environ and &#39;CONDA_DEFAULT_ENV&#39; in os.environ:
        is_venv = True
        env_type = f&amp;quot;Conda环境 ({os.environ[&#39;CONDA_DEFAULT_ENV&#39;]})&amp;quot;
    
    # 方法4：检查环境变量（通用方法）
    elif &#39;VIRTUAL_ENV&#39; in os.environ:
        is_venv = True
        env_type = &amp;quot;虚拟环境&amp;quot;
        # 更新解释器路径为虚拟环境的路径
        venv_path = os.environ[&#39;VIRTUAL_ENV&#39;]
        if platform.system() == &amp;quot;Windows&amp;quot;:
            interpreter_path = os.path.join(venv_path, &#39;Scripts&#39;, &#39;python.exe&#39;)
        else:
            interpreter_path = os.path.join(venv_path, &#39;bin&#39;, &#39;python&#39;)
    
    # 方法5：检查当前路径下的venv目录（常见情况）
    if not is_venv:
        current_dir = os.getcwd()
        venv_dirs = [&#39;.venv&#39;, &#39;venv&#39;, &#39;env&#39;]
        for venv_dir in venv_dirs:
            venv_path = os.path.join(current_dir, venv_dir)
            if os.path.exists(venv_path):
                # 检查是否是有效的虚拟环境
                if platform.system() == &amp;quot;Windows&amp;quot;:
                    python_path = os.path.join(venv_path, &#39;Scripts&#39;, &#39;python.exe&#39;)
                else:
                    python_path = os.path.join(venv_path, &#39;bin&#39;, &#39;python&#39;)
                
                if os.path.exists(python_path):
                    is_venv = True
                    env_type = &amp;quot;本地虚拟环境&amp;quot;
                    interpreter_path = python_path
                    break
    
    # 获取Python版本
    python_version = platform.python_version()
    
    return {
        &amp;quot;path&amp;quot;: interpreter_path,
        &amp;quot;is_venv&amp;quot;: is_venv,
        &amp;quot;env_type&amp;quot;: env_type,
        &amp;quot;version&amp;quot;: python_version
    }

def confirm_continue():
    &amp;quot;&amp;quot;&amp;quot;确认是否继续执行&amp;quot;&amp;quot;&amp;quot;
    print(&amp;quot;\n&amp;quot; + &amp;quot;=&amp;quot;*50)
    print(&amp;quot;警告：当前在虚拟环境中操作&amp;quot;)
    print(&amp;quot;=&amp;quot;*50)
    choice = input(&amp;quot;是否要继续在当前环境安装包? (y/n): &amp;quot;).strip().lower()
    return choice == &#39;y&#39;

def select_mirror():
    &amp;quot;&amp;quot;&amp;quot;让用户选择镜像源&amp;quot;&amp;quot;&amp;quot;
    print(&amp;quot;\n请选择PyPI镜像源(输入序号):&amp;quot;)
    print(&amp;quot;0. 官方源 (默认)&amp;quot;)
    print(&amp;quot;1. 清华大学&amp;quot;)
    print(&amp;quot;2. 阿里云&amp;quot;)
    print(&amp;quot;3. 中国科技大学&amp;quot;)
    print(&amp;quot;4. 豆瓣&amp;quot;)
    print(&amp;quot;5. 北京外国语大学&amp;quot;)
    
    choice = input(&amp;quot;请输入选项 (0-5, 默认为0): &amp;quot;).strip()
    return MIRROR_SOURCES.get(choice, None)

def get_user_packages():
    &amp;quot;&amp;quot;&amp;quot;获取用户输入的依赖包列表&amp;quot;&amp;quot;&amp;quot;
    print(&amp;quot;\n请输入需要检查/安装的依赖包 (多个包用空格分隔)&amp;quot;)
    print(&amp;quot;示例: pandas numpy openpyxl&amp;quot;)
    user_input = input(&amp;quot;或直接回车使用默认包: &amp;quot;).strip()
    
    # 使用默认包列表如果用户未输入
    default_packages = [&#39;pandas&#39;, &#39;openpyxl&#39;, &#39;numpy&#39;]
    return default_packages if not user_input else user_input.split()

def check_and_install(packages, mirror=None):
    &amp;quot;&amp;quot;&amp;quot;检查并安装缺失的包&amp;quot;&amp;quot;&amp;quot;
    missing_packages = []
    
    # 检查哪些包未安装
    for package in packages:
        try:
            __import__(package)
            print(f&amp;quot;✓ {package} 已安装&amp;quot;)
        except ImportError:
            print(f&amp;quot;✗ {package} 未安装&amp;quot;)
            missing_packages.append(package)
    
    # 安装缺失的包
    if missing_packages:
        print(f&amp;quot;\n正在安装缺失的包: {&#39;, &#39;.join(missing_packages)}&amp;quot;)
        
        # 构建安装命令
        install_cmd = [sys.executable, &amp;quot;-m&amp;quot;, &amp;quot;pip&amp;quot;, &amp;quot;install&amp;quot;]
        
        # 添加镜像源参数
        if mirror:
            install_cmd += [&amp;quot;-i&amp;quot;, mirror]
            print(f&amp;quot;使用镜像源: {mirror}&amp;quot;)
        
        # 添加信任主机参数 (Windows需要)
        if mirror and platform.system() == &amp;quot;Windows&amp;quot;:
            domain = mirror.split(&amp;quot;//&amp;quot;)[1].split(&amp;quot;/&amp;quot;)[0]
            install_cmd += [&amp;quot;--trusted-host&amp;quot;, domain]
        
        # 执行安装命令
        install_cmd += missing_packages
        
        try:
            subprocess.check_call(install_cmd)
            print(&amp;quot;安装成功!&amp;quot;)
        except subprocess.CalledProcessError as e:
            print(f&amp;quot;安装失败! 错误代码: {e.returncode}&amp;quot;)
            print(&amp;quot;请尝试更换镜像源或手动安装&amp;quot;)
            return False
    else:
        print(&amp;quot;\n所有依赖包已安装，无需操作&amp;quot;)
    
    return True

def diagnose_import_failure(package):
    &amp;quot;&amp;quot;&amp;quot;诊断包导入失败的原因&amp;quot;&amp;quot;&amp;quot;
    print(f&amp;quot;\n诊断 {package} 导入失败原因:&amp;quot;)
    
    # 1. 检查当前Python环境
    print(&amp;quot;\n当前Python环境:&amp;quot;)
    print(f&amp;quot;解释器路径: {sys.executable}&amp;quot;)
    print(f&amp;quot;sys.path: {sys.path}&amp;quot;)
    
    # 2. 检查包是否实际安装
    try:
        # 使用importlib检查包是否存在
        spec = importlib.util.find_spec(package)
        if spec is None:
            print(f&amp;quot;⚠ 错误: {package} 包未正确安装&amp;quot;)
            return False
        
        print(f&amp;quot;✓ {package} 包已安装&amp;quot;)
        print(f&amp;quot;包位置: {spec.origin}&amp;quot;)
    except Exception as e:
        print(f&amp;quot;⚠ 检查包状态时出错: {str(e)}&amp;quot;)
        return False
    
    # 3. 检查包安装位置是否在sys.path中
    package_dir = os.path.dirname(spec.origin)
    if package_dir not in sys.path:
        print(f&amp;quot;⚠ 错误: 包安装位置 {package_dir} 不在sys.path中&amp;quot;)
        print(&amp;quot;尝试手动添加路径...&amp;quot;)
        sys.path.append(package_dir)
    
    # 4. 尝试导入包并捕获具体错误
    try:
        __import__(package)
        print(f&amp;quot;✓ {package} 导入成功&amp;quot;)
        return True
    except Exception as e:
        print(f&amp;quot;⚠ 导入错误: {str(e)}&amp;quot;)
        
        # 5. 提供特定包的解决方案
        if package.lower() == &amp;quot;pillow&amp;quot;:
            print(&amp;quot;\nPillow 导入失败的常见解决方案:&amp;quot;)
            
            # 检查操作系统
            system = platform.system()
            
            if system == &amp;quot;Windows&amp;quot;:
                print(&amp;quot;1. 确保已安装 Microsoft Visual C++ Redistributable&amp;quot;)
                print(&amp;quot;   - 下载地址: https://aka.ms/vs/16/release/vc_redist.x64.exe&amp;quot;)
                
                # 检查是否安装了正确的VC++版本
                vc_redist_path = r&amp;quot;C:\Windows\System32\vcruntime140.dll&amp;quot;
                if not os.path.exists(vc_redist_path):
                    print(&amp;quot;⚠ 未找到 vcruntime140.dll，请安装VC++ Redistributable&amp;quot;)
                else:
                    print(f&amp;quot;✓ 已找到 vcruntime140.dll: {vc_redist_path}&amp;quot;)
                
            elif system == &amp;quot;Linux&amp;quot;:
                print(&amp;quot;1. 安装系统依赖:&amp;quot;)
                print(&amp;quot;   sudo apt-get install libjpeg-dev zlib1g-dev&amp;quot;)
                
            elif system == &amp;quot;Darwin&amp;quot;:
                print(&amp;quot;1. 安装 Homebrew 和依赖:&amp;quot;)
                print(&#39;   /bin/bash -c &amp;quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)&amp;quot;&#39;)
                print(&amp;quot;   brew install libjpeg zlib&amp;quot;)
            
            print(&amp;quot;\n2. 尝试重新安装 Pillow:&amp;quot;)
            print(&amp;quot;   pip uninstall pillow&amp;quot;)
            print(&amp;quot;   pip install pillow --no-cache-dir --force-reinstall&amp;quot;)
            
            print(&amp;quot;\n3. 尝试安装预编译版本:&amp;quot;)
            print(&amp;quot;   pip install pillow --only-binary :all:&amp;quot;)
            
            print(&amp;quot;\n4. 检查环境变量:&amp;quot;)
            print(&amp;quot;   echo %PATH% (Windows)&amp;quot;)
            print(&amp;quot;   echo $PATH (Linux/macOS)&amp;quot;)
            
            print(&amp;quot;\n5. 尝试使用其他Python版本:&amp;quot;)
            print(&amp;quot;   某些Python版本可能与Pillow存在兼容性问题&amp;quot;)
        
        return False

def check_environment_consistency():
    &amp;quot;&amp;quot;&amp;quot;检查环境一致性&amp;quot;&amp;quot;&amp;quot;
    print(&amp;quot;\n&amp;quot; + &amp;quot;=&amp;quot;*50)
    print(&amp;quot;环境一致性检查&amp;quot;)
    print(&amp;quot;=&amp;quot;*50)
    
    # 1. 检查当前Python解释器
    print(f&amp;quot;当前解释器: {sys.executable}&amp;quot;)
    
    # 2. 检查pip关联的解释器
    try:
        pip_output = subprocess.check_output(
            [sys.executable, &amp;quot;-m&amp;quot;, &amp;quot;pip&amp;quot;, &amp;quot;--version&amp;quot;],
            text=True
        )
        pip_info = pip_output.split()
        if len(pip_info) &amp;gt; 3:
            print(f&amp;quot;pip关联的解释器: {pip_info[3]}&amp;quot;)
        else:
            print(&amp;quot;⚠ 无法解析pip版本信息&amp;quot;)
    except Exception as e:
        print(f&amp;quot;⚠ 无法获取pip信息: {str(e)}&amp;quot;)
    
    # 3. 检查site-packages路径
    try:
        site_packages = site.getsitepackages()
        if site_packages:
            print(&amp;quot;\nSite-packages路径:&amp;quot;)
            for path in site_packages:
                print(f&amp;quot; - {path}&amp;quot;)
        else:
            print(&amp;quot;⚠ 无法获取site-packages路径&amp;quot;)
    except Exception:
        # 回退方法
        print(&amp;quot;\nSite-packages路径:&amp;quot;)
        for path in sys.path:
            if &amp;quot;site-packages&amp;quot; in path:
                print(f&amp;quot; - {path}&amp;quot;)
    
    # 4. 检查环境变量
    print(&amp;quot;\n环境变量:&amp;quot;)
    print(f&amp;quot;PATH: {os.environ.get(&#39;PATH&#39;, &#39;未设置&#39;)}&amp;quot;)
    print(f&amp;quot;PYTHONPATH: {os.environ.get(&#39;PYTHONPATH&#39;, &#39;未设置&#39;)}&amp;quot;)
    
    # 5. 检查虚拟环境激活状态
    if &#39;VIRTUAL_ENV&#39; in os.environ:
        print(f&amp;quot;\n虚拟环境已激活: {os.environ[&#39;VIRTUAL_ENV&#39;]}&amp;quot;)
    else:
        print(&amp;quot;\n虚拟环境未激活&amp;quot;)

def main():
    print(&amp;quot;=&amp;quot;*50)
    print(&amp;quot;Python 依赖包检查与安装工具&amp;quot;)
    print(&amp;quot;=&amp;quot;*50)
    
    # 获取当前解释器信息
    interpreter_info = get_interpreter_info()
    
    print(&amp;quot;\n当前Python环境信息:&amp;quot;)
    # 在路径后添加环境类型标识
    env_status = f&amp;quot;({interpreter_info[&#39;env_type&#39;]})&amp;quot; if interpreter_info[&amp;quot;is_venv&amp;quot;] else &amp;quot;(系统环境)&amp;quot;
    print(f&amp;quot;解释器路径: {interpreter_info[&#39;path&#39;]} {env_status}&amp;quot;)
    print(f&amp;quot;Python版本: Python {interpreter_info[&#39;version&#39;]}&amp;quot;)
    
    # 运行环境一致性检查
    check_environment_consistency()
    
    # 如果是虚拟环境，请求用户确认
    if interpreter_info[&amp;quot;is_venv&amp;quot;]:
        if not confirm_continue():
            print(&amp;quot;\n操作已取消&amp;quot;)
            return
    
    # 获取用户配置
    packages = get_user_packages()
    mirror = select_mirror()
    
    print(&amp;quot;\n&amp;quot; + &amp;quot;=&amp;quot;*50)
    print(&amp;quot;开始检查依赖包...&amp;quot;)
    print(&amp;quot;=&amp;quot;*50)
    
    # 执行检查安装
    success = check_and_install(packages, mirror)
    
    print(&amp;quot;\n&amp;quot; + &amp;quot;=&amp;quot;*50)
    if success:
        print(&amp;quot;操作完成! 正在导入包...&amp;quot;)
        print(&amp;quot;=&amp;quot;*50)
        
        # 尝试导入所有包并记录失败的包
        failed_packages = []
        for package in packages:
            try:
                __import__(package)
                print(f&amp;quot;✓ {package} 导入成功&amp;quot;)
            except ImportError:
                print(f&amp;quot;⚠ 警告: {package} 安装但导入失败&amp;quot;)
                failed_packages.append(package)
        
        # 诊断失败的包
        if failed_packages:
            print(&amp;quot;\n&amp;quot; + &amp;quot;=&amp;quot;*50)
            print(&amp;quot;部分包导入失败，正在诊断问题...&amp;quot;)
            print(&amp;quot;=&amp;quot;*50)
            
            for package in failed_packages:
                diagnose_import_failure(package)
    else:
        print(&amp;quot;操作未完成，请检查错误信息&amp;quot;)
        print(&amp;quot;=&amp;quot;*50)

if __name__ == &amp;quot;__main__&amp;quot;:
    main()
    
    # 如果已经安装，则导入常用库
    try:
        import pandas as pd
        import numpy as np
        print(&amp;quot;\n常用库导入完成，可以开始工作!&amp;quot;)
    except ImportError:
        print(&amp;quot;\n警告: 部分常用库导入失败&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;程序打包&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import sys
import os
import subprocess
import shutil
import time
from PyQt5.QtWidgets import (QApplication, QMainWindow, QWidget, QVBoxLayout, QHBoxLayout, 
                             QLabel, QLineEdit, QPushButton, QFileDialog, QGroupBox, 
                             QRadioButton, QCheckBox, QTextEdit, QMessageBox, QProgressBar)
from PyQt5.QtGui import QIcon, QFont
from PyQt5.QtCore import Qt, QThread, pyqtSignal

class BuildThread(QThread):
    &amp;quot;&amp;quot;&amp;quot;后台打包线程&amp;quot;&amp;quot;&amp;quot;
    update_signal = pyqtSignal(str)
    finished_signal = pyqtSignal(bool, str)
    progress_signal = pyqtSignal(int)

    def __init__(self, args):
        super().__init__()
        self.args = args

    def run(self):
        try:
            self.update_signal.emit(&amp;quot;开始打包过程...&amp;quot;)
            self.progress_signal.emit(10)
            
            # 检查脚本文件是否存在
            if not os.path.exists(self.args[&amp;quot;script_path&amp;quot;]):
                self.finished_signal.emit(False, f&amp;quot;错误：脚本文件不存在 - {self.args[&#39;script_path&#39;]}&amp;quot;)
                return

            # 检查图标文件是否存在（如果提供了）
            if self.args[&amp;quot;icon_path&amp;quot;] and not os.path.exists(self.args[&amp;quot;icon_path&amp;quot;]):
                self.finished_signal.emit(False, f&amp;quot;错误：图标文件不存在 - {self.args[&#39;icon_path&#39;]}&amp;quot;)
                return

            # 清理旧构建
            if os.path.exists(&#39;build&#39;):
                try:
                    shutil.rmtree(&#39;build&#39;)
                    self.update_signal.emit(&amp;quot;清理旧构建目录...&amp;quot;)
                except Exception as e:
                    self.update_signal.emit(f&amp;quot;清理构建目录时出错: {str(e)}&amp;quot;)
            
            if os.path.exists(&#39;spec&#39;):
                try:
                    shutil.rmtree(&#39;spec&#39;)
                    self.update_signal.emit(&amp;quot;清理旧spec文件...&amp;quot;)
                except Exception as e:
                    self.update_signal.emit(f&amp;quot;清理spec目录时出错: {str(e)}&amp;quot;)
            
            self.progress_signal.emit(20)
            
            # 构建PyInstaller命令
            cmd = [
                sys.executable,  # 使用当前 Python 解释器
                &amp;quot;-m&amp;quot;, &amp;quot;PyInstaller&amp;quot;
            ]
            
            # 添加主脚本（使用绝对路径）
            script_path = os.path.abspath(self.args[&amp;quot;script_path&amp;quot;])
            cmd.append(script_path)
            
            # 程序名称
            cmd.extend([&amp;quot;--name&amp;quot;, self.args[&amp;quot;app_name&amp;quot;]])
            
            # 输出目录（使用绝对路径）
            output_dir = os.path.abspath(self.args[&amp;quot;output_dir&amp;quot;])
            cmd.extend([&amp;quot;--distpath&amp;quot;, output_dir])
            
            # 工作目录
            cmd.extend([&amp;quot;--workpath&amp;quot;, &amp;quot;build&amp;quot;])
            
            # spec目录
            cmd.extend([&amp;quot;--specpath&amp;quot;, &amp;quot;spec&amp;quot;])
            
            # 图标（使用绝对路径）
            if self.args[&amp;quot;icon_path&amp;quot;]:
                icon_path = os.path.abspath(self.args[&amp;quot;icon_path&amp;quot;])
                cmd.extend([&amp;quot;--icon&amp;quot;, icon_path])
            
            # 单文件模式
            if self.args[&amp;quot;onefile&amp;quot;]:
                cmd.append(&amp;quot;--onefile&amp;quot;)
            
            # 控制台窗口
            if not self.args[&amp;quot;console&amp;quot;]:
                cmd.append(&amp;quot;--windowed&amp;quot;)
            
            # 添加数据文件（处理路径）
            for data in self.args[&amp;quot;add_data&amp;quot;]:
                # 分割源路径和目标路径
                source, target = data.split(os.pathsep)
                # 处理源路径（使用绝对路径）
                abs_source = os.path.abspath(source)
                # 重新组合
                cmd.extend([&amp;quot;--add-data&amp;quot;, f&amp;quot;{abs_source}{os.pathsep}{target}&amp;quot;])
            
            # 添加隐藏导入
            for imp in self.args[&amp;quot;hidden_imports&amp;quot;]:
                cmd.extend([&amp;quot;--hidden-import&amp;quot;, imp])
            
            # 其他选项
            cmd.append(&amp;quot;--noconfirm&amp;quot;)
            cmd.append(&amp;quot;--clean&amp;quot;)
            
            self.update_signal.emit(f&amp;quot;执行命令: {&#39; &#39;.join(cmd)}&amp;quot;)
            self.progress_signal.emit(30)
            
            # 运行打包命令
            try:
                # 设置环境变量以支持中文路径
                env = os.environ.copy()
                env[&#39;PYTHONUTF8&#39;] = &#39;1&#39;  # 确保Python使用UTF-8编码
                
                process = subprocess.Popen(
                    cmd, 
                    stdout=subprocess.PIPE, 
                    stderr=subprocess.STDOUT, 
                    universal_newlines=True,
                    encoding=&#39;utf-8&#39;,
                    errors=&#39;replace&#39;,
                    env=env  # 传递修改后的环境变量
                )
                
                # 实时输出
                for line in process.stdout:
                    self.update_signal.emit(line.strip())
                
                # 等待完成
                process.wait()
                self.progress_signal.emit(90)
                
                if process.returncode == 0:
                    self.finished_signal.emit(True, &amp;quot;打包成功完成！&amp;quot;)
                else:
                    self.finished_signal.emit(False, f&amp;quot;打包失败，错误代码: {process.returncode}&amp;quot;)
                
            except Exception as e:
                self.finished_signal.emit(False, f&amp;quot;执行打包命令时出错: {str(e)}&amp;quot;)
                
            self.progress_signal.emit(100)
            
        except Exception as e:
            self.finished_signal.emit(False, f&amp;quot;打包过程中发生错误: {str(e)}&amp;quot;)
            self.progress_signal.emit(100)


class PackagerApp(QMainWindow):
    &amp;quot;&amp;quot;&amp;quot;主应用程序窗口&amp;quot;&amp;quot;&amp;quot;
    def __init__(self):
        super().__init__()
        self.setWindowTitle(&amp;quot;Python程序打包工具&amp;quot;)
        self.setGeometry(100, 100, 800, 600)
        self.setWindowIcon(QIcon(self.resource_path(&amp;quot;icon.ico&amp;quot;)))
        
        # 创建主部件
        main_widget = QWidget()
        self.setCentralWidget(main_widget)
        
        # 主布局
        main_layout = QVBoxLayout()
        main_widget.setLayout(main_layout)
        
        # 创建标签
        title_label = QLabel(&amp;quot;Python程序打包工具&amp;quot;)
        title_label.setFont(QFont(&amp;quot;Arial&amp;quot;, 16, QFont.Bold))
        title_label.setAlignment(Qt.AlignCenter)
        main_layout.addWidget(title_label)
        
        # 创建配置区域
        config_group = QGroupBox(&amp;quot;打包配置&amp;quot;)
        config_layout = QVBoxLayout()
        config_group.setLayout(config_layout)
        main_layout.addWidget(config_group)
        
        # 脚本路径
        script_layout = QHBoxLayout()
        script_layout.addWidget(QLabel(&amp;quot;Python脚本:&amp;quot;))
        self.script_input = QLineEdit()
        script_layout.addWidget(self.script_input)
        self.script_button = QPushButton(&amp;quot;浏览...&amp;quot;)
        self.script_button.clicked.connect(self.browse_script)
        script_layout.addWidget(self.script_button)
        config_layout.addLayout(script_layout)
        
        # 程序名称
        name_layout = QHBoxLayout()
        name_layout.addWidget(QLabel(&amp;quot;程序名称:&amp;quot;))
        self.name_input = QLineEdit()
        name_layout.addWidget(self.name_input)
        config_layout.addLayout(name_layout)
        
        # 图标路径
        icon_layout = QHBoxLayout()
        icon_layout.addWidget(QLabel(&amp;quot;程序图标:&amp;quot;))
        self.icon_input = QLineEdit()
        icon_layout.addWidget(self.icon_input)
        self.icon_button = QPushButton(&amp;quot;浏览...&amp;quot;)
        self.icon_button.clicked.connect(self.browse_icon)
        icon_layout.addWidget(self.icon_button)
        config_layout.addLayout(icon_layout)
        
        # 打包模式
        mode_group = QGroupBox(&amp;quot;打包模式&amp;quot;)
        mode_layout = QHBoxLayout()
        self.onefile_radio = QRadioButton(&amp;quot;单文件模式&amp;quot;)
        self.dir_radio = QRadioButton(&amp;quot;目录模式&amp;quot;)
        self.dir_radio.setChecked(True)
        mode_layout.addWidget(self.onefile_radio)
        mode_layout.addWidget(self.dir_radio)
        mode_group.setLayout(mode_layout)
        config_layout.addWidget(mode_group)
        
        # 控制台选项
        console_group = QGroupBox(&amp;quot;控制台选项&amp;quot;)
        console_layout = QHBoxLayout()
        self.console_radio = QRadioButton(&amp;quot;显示控制台&amp;quot;)
        self.windowed_radio = QRadioButton(&amp;quot;隐藏控制台&amp;quot;)
        self.windowed_radio.setChecked(True)
        console_layout.addWidget(self.console_radio)
        console_layout.addWidget(self.windowed_radio)
        console_group.setLayout(console_layout)
        config_layout.addWidget(console_group)
        
        # 输出目录
        output_layout = QHBoxLayout()
        output_layout.addWidget(QLabel(&amp;quot;输出目录:&amp;quot;))
        self.output_input = QLineEdit(&amp;quot;dist&amp;quot;)
        output_layout.addWidget(self.output_input)
        self.output_button = QPushButton(&amp;quot;浏览...&amp;quot;)
        self.output_button.clicked.connect(self.browse_output)
        output_layout.addWidget(self.output_button)
        config_layout.addLayout(output_layout)
        
        # 添加数据文件
        self.data_label = QLabel(&amp;quot;添加数据文件 (源路径;目标路径):&amp;quot;)
        config_layout.addWidget(self.data_label)
        
        self.data_layout = QVBoxLayout()
        self.data_inputs = []
        self.add_data_button = QPushButton(&amp;quot;添加数据文件&amp;quot;)
        self.add_data_button.clicked.connect(self.add_data_field)
        config_layout.addLayout(self.data_layout)
        config_layout.addWidget(self.add_data_button)
        
        # 进度条
        self.progress_bar = QProgressBar()
        self.progress_bar.setRange(0, 100)
        self.progress_bar.setValue(0)
        main_layout.addWidget(self.progress_bar)
        
        # 日志输出
        self.log_output = QTextEdit()
        self.log_output.setReadOnly(True)
        self.log_output.setFont(QFont(&amp;quot;Courier New&amp;quot;, 10))
        main_layout.addWidget(self.log_output)
        
        # 按钮区域
        button_layout = QHBoxLayout()
        self.build_button = QPushButton(&amp;quot;开始打包&amp;quot;)
        self.build_button.clicked.connect(self.start_build)
        self.build_button.setStyleSheet(&amp;quot;background-color: #4CAF50; color: white; font-weight: bold;&amp;quot;)
        button_layout.addWidget(self.build_button)
        
        self.cancel_button = QPushButton(&amp;quot;取消&amp;quot;)
        self.cancel_button.clicked.connect(self.close)
        self.cancel_button.setStyleSheet(&amp;quot;background-color: #f44336; color: white;&amp;quot;)
        button_layout.addWidget(self.cancel_button)
        
        main_layout.addLayout(button_layout)
        
        # 初始化线程
        self.build_thread = None
        
        # 设置默认值
        self.name_input.setText(&amp;quot;MyApp&amp;quot;)
        
    def resource_path(self, relative_path):
        &amp;quot;&amp;quot;&amp;quot;获取资源绝对路径&amp;quot;&amp;quot;&amp;quot;
        try:
            base_path = sys._MEIPASS
        except Exception:
            base_path = os.path.abspath(&amp;quot;.&amp;quot;)
        return os.path.join(base_path, relative_path)
    
    def browse_script(self):
        &amp;quot;&amp;quot;&amp;quot;浏览Python脚本&amp;quot;&amp;quot;&amp;quot;
        file_path, _ = QFileDialog.getOpenFileName(
            self, &amp;quot;选择Python脚本&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;Python文件 (*.py)&amp;quot;
        )
        if file_path:
            self.script_input.setText(file_path)
            # 自动设置程序名称为脚本文件名
            app_name = os.path.splitext(os.path.basename(file_path))[0]
            self.name_input.setText(app_name)
    
    def browse_icon(self):
        &amp;quot;&amp;quot;&amp;quot;浏览图标文件&amp;quot;&amp;quot;&amp;quot;
        file_path, _ = QFileDialog.getOpenFileName(
            self, &amp;quot;选择图标文件&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;图标文件 (*.ico)&amp;quot;
        )
        if file_path:
            self.icon_input.setText(file_path)
    
    def browse_output(self):
        &amp;quot;&amp;quot;&amp;quot;浏览输出目录&amp;quot;&amp;quot;&amp;quot;
        dir_path = QFileDialog.getExistingDirectory(self, &amp;quot;选择输出目录&amp;quot;)
        if dir_path:
            self.output_input.setText(dir_path)
    
    def add_data_field(self):
        &amp;quot;&amp;quot;&amp;quot;添加数据文件输入行&amp;quot;&amp;quot;&amp;quot;
        data_layout = QHBoxLayout()
        
        # 源路径
        source_input = QLineEdit()
        source_button = QPushButton(&amp;quot;浏览...&amp;quot;)
        source_button.clicked.connect(lambda: self.browse_data_source(source_input))
        
        # 目标路径
        target_input = QLineEdit()
        
        # 删除按钮
        remove_button = QPushButton(&amp;quot;删除&amp;quot;)
        remove_button.setStyleSheet(&amp;quot;background-color: #f44336; color: white;&amp;quot;)
        remove_button.clicked.connect(lambda: self.remove_data_field(data_layout))
        
        data_layout.addWidget(QLabel(&amp;quot;源:&amp;quot;))
        data_layout.addWidget(source_input)
        data_layout.addWidget(source_button)
        data_layout.addWidget(QLabel(&amp;quot;目标:&amp;quot;))
        data_layout.addWidget(target_input)
        data_layout.addWidget(remove_button)
        
        self.data_layout.addLayout(data_layout)
        self.data_inputs.append((source_input, target_input, data_layout))
    
    def browse_data_source(self, source_input):
        &amp;quot;&amp;quot;&amp;quot;浏览数据文件源&amp;quot;&amp;quot;&amp;quot;
        # 允许选择文件或目录
        path = QFileDialog.getOpenFileName(
            self, &amp;quot;选择数据文件&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;所有文件 (*.*)&amp;quot;
        )[0]
        if not path:
            return
            
        # 如果是目录，选择整个目录
        if os.path.isdir(path):
            path = QFileDialog.getExistingDirectory(self, &amp;quot;选择数据目录&amp;quot;, path)
            if not path:
                return
        
        if path:
            source_input.setText(path)
    
    def remove_data_field(self, layout):
        &amp;quot;&amp;quot;&amp;quot;删除数据文件输入行&amp;quot;&amp;quot;&amp;quot;
        # 从布局中移除所有部件
        while layout.count():
            item = layout.takeAt(0)
            widget = item.widget()
            if widget:
                widget.deleteLater()
        
        # 从列表中移除
        for i, (_, _, l) in enumerate(self.data_inputs):
            if l == layout:
                self.data_inputs.pop(i)
                break
        
        # 删除布局本身
        layout.deleteLater()
    
    def get_build_args(self):
        &amp;quot;&amp;quot;&amp;quot;获取打包参数&amp;quot;&amp;quot;&amp;quot;
        args = {
            &amp;quot;script_path&amp;quot;: self.script_input.text(),
            &amp;quot;app_name&amp;quot;: self.name_input.text(),
            &amp;quot;icon_path&amp;quot;: self.icon_input.text(),
            &amp;quot;onefile&amp;quot;: self.onefile_radio.isChecked(),
            &amp;quot;console&amp;quot;: self.console_radio.isChecked(),
            &amp;quot;output_dir&amp;quot;: self.output_input.text(),
            &amp;quot;add_data&amp;quot;: [],
            &amp;quot;hidden_imports&amp;quot;: [
                &#39;PIL&#39;, &#39;PIL._imaging&#39;, &#39;pkg_resources.py2_warn&#39;,
                &#39;numpy&#39;, &#39;pandas&#39;, &#39;scipy&#39;, &#39;sklearn&#39;, &#39;matplotlib&#39;
            ]
        }
        
        # 收集数据文件
        for source_input, target_input, _ in self.data_inputs:
            source = source_input.text().strip()
            target = target_input.text().strip()
            if source and target:
                args[&amp;quot;add_data&amp;quot;].append(f&amp;quot;{source}{os.pathsep}{target}&amp;quot;)
        
        return args
    
    def validate_inputs(self, args):
        &amp;quot;&amp;quot;&amp;quot;验证输入参数&amp;quot;&amp;quot;&amp;quot;
        if not args[&amp;quot;script_path&amp;quot;]:
            QMessageBox.warning(self, &amp;quot;输入错误&amp;quot;, &amp;quot;请选择要打包的Python脚本&amp;quot;)
            return False
        
        if not os.path.exists(args[&amp;quot;script_path&amp;quot;]):
            QMessageBox.warning(self, &amp;quot;输入错误&amp;quot;, &amp;quot;选择的Python脚本不存在&amp;quot;)
            return False
        
        if not args[&amp;quot;app_name&amp;quot;]:
            QMessageBox.warning(self, &amp;quot;输入错误&amp;quot;, &amp;quot;请输入程序名称&amp;quot;)
            return False
        
        if args[&amp;quot;icon_path&amp;quot;] and not os.path.exists(args[&amp;quot;icon_path&amp;quot;]):
            QMessageBox.warning(self, &amp;quot;输入错误&amp;quot;, &amp;quot;选择的图标文件不存在&amp;quot;)
            return False
        
        # 检查数据文件
        for data in args[&amp;quot;add_data&amp;quot;]:
            source, target = data.split(os.pathsep)
            if not os.path.exists(source):
                QMessageBox.warning(self, &amp;quot;输入错误&amp;quot;, f&amp;quot;数据文件不存在: {source}&amp;quot;)
                return False
        
        return True
    
    def start_build(self):
        &amp;quot;&amp;quot;&amp;quot;开始打包过程&amp;quot;&amp;quot;&amp;quot;
        # 获取参数
        args = self.get_build_args()
        
        # 验证输入
        if not self.validate_inputs(args):
            return
        
        # 禁用按钮
        self.build_button.setEnabled(False)
        self.log_output.clear()
        self.progress_bar.setValue(0)
        
        # 创建并启动打包线程
        self.build_thread = BuildThread(args)
        self.build_thread.update_signal.connect(self.update_log)
        self.build_thread.finished_signal.connect(self.build_finished)
        self.build_thread.progress_signal.connect(self.progress_bar.setValue)
        self.build_thread.start()
    
    def update_log(self, message):
        &amp;quot;&amp;quot;&amp;quot;更新日志输出&amp;quot;&amp;quot;&amp;quot;
        self.log_output.append(message)
        self.log_output.verticalScrollBar().setValue(
            self.log_output.verticalScrollBar().maximum()
        )
    
    def build_finished(self, success, message):
        &amp;quot;&amp;quot;&amp;quot;打包完成处理&amp;quot;&amp;quot;&amp;quot;
        self.build_button.setEnabled(True)
        
        if success:
            self.log_output.append(&amp;quot;\n&amp;quot; + message)
            QMessageBox.information(self, &amp;quot;打包成功&amp;quot;, message)
            
            # 打开输出目录
            output_path = os.path.join(self.output_input.text(), self.name_input.text())
            if self.onefile_radio.isChecked():
                output_path += &amp;quot;.exe&amp;quot;
                self.log_output.append(f&amp;quot;可执行文件位置: {output_path}&amp;quot;)
            else:
                self.log_output.append(f&amp;quot;程序目录位置: {output_path}&amp;quot;)
            
            # 显示打开文件夹按钮
            open_button = QPushButton(&amp;quot;打开输出目录&amp;quot;)
            open_button.clicked.connect(lambda: self.open_output_directory())
            self.log_output.setCornerWidget(open_button)
            
        else:
            self.log_output.append(&amp;quot;\n&amp;quot; + message)
            QMessageBox.critical(self, &amp;quot;打包失败&amp;quot;, message)
    
    def open_output_directory(self):
        &amp;quot;&amp;quot;&amp;quot;打开输出目录&amp;quot;&amp;quot;&amp;quot;
        output_dir = os.path.abspath(self.output_input.text())
        if os.path.exists(output_dir):
            if sys.platform == &amp;quot;win32&amp;quot;:
                os.startfile(output_dir)
            elif sys.platform == &amp;quot;darwin&amp;quot;:
                subprocess.Popen([&amp;quot;open&amp;quot;, output_dir])
            else:
                subprocess.Popen([&amp;quot;xdg-open&amp;quot;, output_dir])
    
    def closeEvent(self, event):
        &amp;quot;&amp;quot;&amp;quot;关闭窗口事件处理&amp;quot;&amp;quot;&amp;quot;
        if self.build_thread and self.build_thread.isRunning():
            reply = QMessageBox.question(
                self, &#39;确认退出&#39;,
                &#39;打包过程仍在运行，确定要退出吗？&#39;,
                QMessageBox.Yes | QMessageBox.No, QMessageBox.No
            )
            
            if reply == QMessageBox.Yes:
                self.build_thread.terminate()
                event.accept()
            else:
                event.ignore()
        else:
            event.accept()


if __name__ == &amp;quot;__main__&amp;quot;:
    app = QApplication(sys.argv)
    window = PackagerApp()
    window.show()
    sys.exit(app.exec_())
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;虚拟环境&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;python虚拟环境
在Python中，虚拟环境是一种隔离的Python环境，它允许你在一个项目中安装特定版本的包，而不会影响到系统中其他Python项目或全局Python环境。这对于管理项目依赖和避免不同项目之间的包版本冲突非常有用。下面是如何在Windows、macOS和Linux上创建和使用Python虚拟环境的步骤：

1. 使用venv模块（Python 3.3及以上版本）
安装虚拟环境
对于Python 3.3及以上版本，你可以使用内置的venv模块来创建虚拟环境。

步骤：

打开命令行界面（例如：终端、命令提示符或PowerShell）。

创建一个新的目录用于你的项目（如果还没有的话）。

mkdir myproject
cd myproject

使用venv模块创建一个虚拟环境。

python -m venv venv

这里venv是虚拟环境的目录名，你可以根据需要更改它。

激活虚拟环境
Windows:

.\venv\Scripts\activate
macOS/Linux:

source venv/bin/activate
激活后，你的命令行提示符会发生变化，表明你现在处于虚拟环境中。

退出虚拟环境
在命令行中输入以下命令来退出虚拟环境：

deactivate
2. 使用virtualenv（适用于所有Python版本）
如果你使用的是Python 2或者想使用一个更早的版本的Python，你可以使用virtualenv。首先，你需要安装virtualenv。

安装virtualenv:

pip install virtualenv
创建并激活虚拟环境:

# 创建虚拟环境
virtualenv venv
# 激活虚拟环境（方法同上）
# Windows: .\venv\Scripts\activate
# macOS/Linux: source venv/bin/activate
3. 使用conda（Anaconda/Miniconda）
如果你使用的是Anaconda或Miniconda，你可以使用conda来创建和管理虚拟环境。

创建虚拟环境:

conda create --name myenv python=3.8
这里myenv是虚拟环境的名称，python=3.8指定了Python的版本。

激活虚拟环境:

conda activate myenv
或者，在某些系统上，你可以使用：

source activate myenv  # macOS/Linux
activate myenv  # Windows (在某些情况下)
总结：
选择哪种方法取决于你的具体需求和偏好。venv是Python官方推荐的虚拟环境工具，适用于所有Python 3版本。virtualenv提供了跨平台支持并且可以与所有Python版本一起使用。而conda则更适合数据科学和机器学习项目，因为它提供了包管理和环境管理的额外功能。
&lt;/code&gt;&lt;/pre&gt;
">Python基本代码</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/h1knsguHBt/"" data-c="
          &lt;h2 id=&#34;单线程&#34;&gt;单线程&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-vb&#34;&gt;//创建对象
LogStart &amp;quot;D:\用户目录\Desktop\2K1.log&amp;quot;  
import &amp;quot;C:\obj.vbs&amp;quot;
Set dm = New dmsoft
Set dm2 = New dmsoft
ret = dm.Reg(&amp;quot;XXXXXX&amp;quot;, &amp;quot;XXXXXX&amp;quot;)
ret2 = dm2.Reg(&amp;quot;XXXXXX&amp;quot;,&amp;quot;XXXXXX&amp;quot;)
If ret = 1 AND ret2= 1 Then 
    TracePrint &amp;quot;大漠插件注册成功&amp;quot;
Else
    TracePrint &amp;quot;大漠插件注册失败,返回值1：&amp;quot;+ CStr(ret) + &amp;quot;    返回值2：&amp;quot;+ CStr(ret2)
End If
dm.setPath &amp;quot;.\pic&amp;quot;
dm2.setPath &amp;quot;.\pic&amp;quot;
// 喵提醒参数：进度喵码和电脑状态喵码
Global playCountMiaoCode
playCountMiaoCode = &amp;quot;tOy90iP&amp;quot;
Global msgMiaoCode
msgMiaoCode = &amp;quot;tT48aX9&amp;quot;
// 游戏路径
Dim gamePath
loginPath = &amp;quot;C:\WeGameLogin\WeGameLogin.exe&amp;quot;
// 电脑编码
UserVar pcCode=DropList{&amp;quot;A01&amp;quot;:&amp;quot;A01&amp;quot;|&amp;quot;B01&amp;quot;:&amp;quot;B01&amp;quot;}=0 &amp;quot;电脑编码&amp;quot;
If StrComp(pcCode, &amp;quot;A01&amp;quot;) = 0 Then 
    gamePath = &amp;quot;E:\Game\OL1\NBA2K Online\NBA2KOnline.exe&amp;quot;
Else 
    gamePath = &amp;quot;D:\Game\NBA2KOL\NBA2K Online\NBA2KOnline.exe&amp;quot;
End If
Global globalPcCode
// 绑定模式
displayMode = &amp;quot;gdi&amp;quot;
mouseMode = &amp;quot;dx.mouse.position.lock.api|dx.mouse.api|dx.mouse.cursor&amp;quot;
keypadMode = &amp;quot;dx.keypad.api&amp;quot;
publicMode = &amp;quot;dx.public.active.api|dx.public.hide.dll|dx.public.graphic.protect|dx.public.down.cpu&amp;quot;
mode = 101
// 线程公共参数
Dim playTheadID
Dim loginTheadID
// 是否自动登录WeGame
UserVar autoLogin=DropList{&amp;quot;是&amp;quot;:0|&amp;quot;否&amp;quot;:1}=1 &amp;quot;自动登录&amp;quot;
// 登陆方式
UserVar loginSelect=DropList{&amp;quot;账号密码&amp;quot;:0|&amp;quot;快捷登录&amp;quot;:1}=0 &amp;quot;登录方式&amp;quot;
// 登陆账号
UserVar accountNumber=DropList{&amp;quot;QQ账号&amp;quot;:&amp;quot;QQ账号&amp;quot;|&amp;quot;QQ账号2&amp;quot;:&amp;quot;QQ账号2&amp;quot;}=0 &amp;quot;登录账号&amp;quot;
accounPwd = &amp;quot;密码&amp;quot;
// 登录大区
UserVar areaX=DropList{&amp;quot;斯台普斯&amp;quot;:434|&amp;quot;玫瑰花园&amp;quot;:598|&amp;quot;联合中心&amp;quot;:274|&amp;quot;美航球馆&amp;quot;:111}= 0 &amp;quot;登录大区&amp;quot;
areaY = 246
// 挂机类型
UserVar playType = DropList{&amp;quot;街头赛（人机）&amp;quot;:0 |&amp;quot;NBA对抗赛&amp;quot;:1|&amp;quot;教练模式&amp;quot;:2|&amp;quot;王朝模式&amp;quot;:3|&amp;quot;街头赛（匹配）&amp;quot;:4|&amp;quot;巅峰季后赛（人机）&amp;quot;:5|&amp;quot;好友2v2&amp;quot;:6|&amp;quot;王朝模式（排位）&amp;quot;:7|&amp;quot;NBA对抗赛（排位）&amp;quot;:8|&amp;quot;街头赛（排位）&amp;quot;:9|&amp;quot;关键时刻&amp;quot;:10}=0 &amp;quot;选择模式&amp;quot;
Dim playTypeArray
playTypeArray = Array(&amp;quot;街头赛（人机）&amp;quot;, &amp;quot;NBA对抗赛&amp;quot;, &amp;quot;教练模式&amp;quot;, &amp;quot;王朝模式&amp;quot;, &amp;quot;街头赛（匹配）&amp;quot;, &amp;quot;巅峰季后赛（人机）&amp;quot;, &amp;quot;好友2v2&amp;quot;,&amp;quot;王朝模式（排位）&amp;quot;,&amp;quot;NBA对抗赛（排位）&amp;quot;,&amp;quot;街头赛（排位）&amp;quot;,&amp;quot;关键时刻&amp;quot;)
// 季后赛晋级几轮结束比赛
UserVar maxPromoteCount=DropList{&amp;quot;第一轮&amp;quot;:1|&amp;quot;第二轮&amp;quot;:2|&amp;quot;第三轮&amp;quot;:3}= 0 &amp;quot;季后赛晋级目标&amp;quot;
// 自定义场数
UserVar playCount=6 &amp;quot;自定义场数&amp;quot;
// 是否投降
UserVar isPlayFail=DropList{&amp;quot;是&amp;quot;:0|&amp;quot;否&amp;quot;:1}=1 &amp;quot;是否投降&amp;quot;
// 是否领取奖励
UserVar isGetPrize=DropList{&amp;quot;是&amp;quot;:0|&amp;quot;否&amp;quot;:1}=1 &amp;quot;是否领奖&amp;quot;
// 是否派遣表演赛
UserVar isGoPlay=DropList{&amp;quot;是&amp;quot;:0|&amp;quot;否&amp;quot;:1}=1 &amp;quot;自动表演赛&amp;quot;
// 是否关闭电脑
UserVar isExitOS=DropList{&amp;quot;是&amp;quot;:0|&amp;quot;否&amp;quot;:1}=1 &amp;quot;是否关机&amp;quot;
// ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓
// -------------------------------------游戏坐标位置，根据电脑不同分辨率修改------------------------------------------------
// 游戏窗口大小
gameX1 = 0
gameY1 = 0
gameX2 = 1024
gameY2 = 768
// 复位位置
resetX = 505
resetY = 97
// 黑色提示框
dialogX = 512
dialogY = 292
dialogCR = &amp;quot;181b1e&amp;quot;
// 点击确认关闭提示
closeDialogX = 510
closeDialogY = 458
// 点击取消关闭提示
cancelDialogX = 594
cancelDialogY = 459
// 安小西弹框点击确认
confirmX = 548
confirmY = 488
// 关闭投降、网络异常、提前退出的提示坐标
closeExceptionX = 477
closeExceptionY = 457
// 六个表演赛坐标
showLevelXArray = Array(277,494,713,659,427,175)
showLevelYArray = Array(209,281,298,512,408,375)
// 当前已派遣次数
goShowCount = 0
// 5个等级判断
levelImgArray = Array(&amp;quot;level-UR.bmp&amp;quot;, &amp;quot;level-SSR.bmp&amp;quot;, &amp;quot;level-SS.bmp&amp;quot;, &amp;quot;level-S.bmp&amp;quot;, &amp;quot;level-A.bmp&amp;quot;)
// 季后赛晋级次数
promoteCount = 0
//↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑
// 初始化
Sub paramsInit()
    globalPcCode = pcCode
    If Hour(time) &amp;gt;= 0 and Hour(time) &amp;lt; 3 Then 
        autoLogin = 0
        loginSelect = 0
        accountNumber = &amp;quot;QQ账号&amp;quot;
        areaX = 434
        playType = 2
        playCount = 6
        isPlayFail = 1
        isGetPrize = 0
        isGoPlay = 0
        isExitOS = 0
    ElseIf Hour(time) &amp;gt;= 3 and Hour(time) &amp;lt; 6 Then 
        autoLogin = 0
        loginSelect = 0
        accountNumber = &amp;quot;QQ账号&amp;quot;
        areaX = 598
        playType = 2
        playCount = 6
        isPlayFail = 1
        isGetPrize = 0
        isGoPlay = 0
        isExitOS = 0
    ElseIf Hour(time) &amp;gt;= 6 and Hour(time) &amp;lt; 8 Then 
        autoLogin = 0
        loginSelect = 0
        accountNumber = &amp;quot;QQ账号2&amp;quot;
        areaX = 434
        playType = 2
        playCount = 6
        isPlayFail = 1
        isGetPrize = 0
        isGoPlay = 0
        isExitOS = 0
    End If
    TracePrint &amp;quot;参数初始化完成&amp;quot;
End Sub
// 点击返回按钮返回大厅、判断是否在游戏大厅
Sub cancelIndex()
    Do While True
        Delay 1000
        dm_ret = dm.FindPic(0, gameY1, gameX2, gameY2,&amp;quot;play.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
            Delay 5000
            Exit do
        End If
        dm_ret = dm.FindPic(0, gameY1, gameX2, gameY2,&amp;quot;zhuye.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
            dm.MoveTo intX + 15, intY + 10
            Delay 1000
            dm.LeftClick
            Delay 3000
        End If
        dm_ret = dm.FindPic(gameX2/2, gameY1, gameX2, gameY2/2, &amp;quot;close.bmp&amp;quot;, &amp;quot;000000&amp;quot;, 0.8, 0, intX, intY)
        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
            dm.MoveTo intX + 15, intY + 15
            Delay 1000
            dm.LeftClick
            Delay 3000
        End If
    Loop
End Sub
// 定义倒计时进程
Sub playThead(t) 
    While t &amp;gt;= 0
        //Call Plugin.Msg.ShowScrTXT(0, 0, 1024, 100, &amp;quot;比赛倒计时  &amp;quot;&amp;amp;t, &amp;quot;0000FF&amp;quot;)   
        Delay 1000
        If t = 0 Then 
            StopThread playTheadID //停止倒计时线程
            If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
                text = &amp;quot;比赛长时间未结束，请手动确认游戏进度【&amp;quot; + globalPcCode + &amp;quot;】&amp;quot;
                Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
                objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
                objXML.send
                Delay 3000
            End If
            // 关闭WeGame
            //            WEGAME_APP = Plugin.Window.Find(&amp;quot;TWINCONTROL&amp;quot;, 0)
            //            Call Plugin.Window.CloseEx(WEGAME_APP)
            //            Delay 2000
            //            // 关闭上号器
            //            LoginHwnd = Plugin.Window.Find(&amp;quot;WTWindow&amp;quot;, 0)
            //            Call Plugin.Window.CloseEx(LoginHwnd)
            //            Delay 2000
            //            // 关闭游戏 快捷键 Alt+N
            //            KeyDown 18, 1
            //            KeyPress 78, 1
            //            KeyUp 18, 1
            //            Delay 1000
            //            // 重启脚本
            //            RestartScript
        End If
        t = t - 1
    Wend
End Sub
// 定义倒计时进程
Sub loginThead(t) 
    While t &amp;gt;= 0
        //Call Plugin.Msg.ShowScrTXT(0, 0, 1024, 100, &amp;quot;登录倒计时  &amp;quot; &amp;amp; t, &amp;quot;0000FF&amp;quot;)
        Delay 1000
        If t = 0 Then 
            StopThread loginTheadID //停止倒计时线程
            If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
                text = &amp;quot;未登录成功，将重新进行登录操作【&amp;quot; + globalPcCode + &amp;quot;】&amp;quot;
                Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
                objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
                objXML.send
                Delay 3000
            End If
            // 关闭WeGame
            WEGAME_APP = Plugin.Window.Find(&amp;quot;TWINCONTROL&amp;quot;, 0)
            Call Plugin.Window.CloseEx(WEGAME_APP)
            Delay 2000
            // 关闭上号器
            LoginHwnd = Plugin.Window.Find(&amp;quot;WTWindow&amp;quot;, 0)
            Call Plugin.Window.CloseEx(LoginHwnd)
            Delay 2000
            // 重启脚本
            RestartScript
        End If
        t = t - 1
    Wend
End Sub
// 登录结束绑定窗口
Sub bindNBAWindow
    // 修改窗口标题为默认值
    NBAHwnds = Split(Plugin.Window.SearchEx(0, &amp;quot;NBA2K Online&amp;quot;, 0), &amp;quot;|&amp;quot;)
    If UBound(NBAHwnds) &amp;gt;= 0 Then 
        i=0
        For UBound(NBAHwnds)
            dm_ret = dm.SetWindowText(NBAHwnds(i),&amp;quot;NBA2K Onlie 篮球在线&amp;quot;)
            i=i+1
        Next
    End If
    NBAHwnds = Split(Plugin.Window.SearchEx(0, &amp;quot;窗口-&amp;quot;, 0), &amp;quot;|&amp;quot;)
    If UBound(NBAHwnds) &amp;gt;= 0 Then 
        i=0
        For UBound(NBAHwnds)
            dm_ret = dm.SetWindowText(NBAHwnds(i),&amp;quot;NBA2K Onlie 篮球在线&amp;quot;)
            i=i+1
        Next
    End If
    Do While true
        Delay 3000
        NBA2KHwnd = dm.FindWindowEx(0,&amp;quot;NBA2KONLINE_EXCLUSIVE_WND_CLASS_NAME&amp;quot;,&amp;quot;&amp;quot;) 
        dm_ret = dm.SetWindowState(NBA2KHwnd,1) 
        // 获取窗体宽高
        MyArray = Split(Plugin.Window.GetClientRect(NBA2KHwnd), &amp;quot;|&amp;quot;)
        X1 = Clng(MyArray(0)): Y1 = Clng(MyArray(1))   
        X2 = Clng(MyArray(2)) : Y2 = Clng(MyArray(3))
        If X2 = -1 OR Y2 = -1 Then 
            If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
                text = &amp;quot;未找到游戏窗口，请确认游戏是否启动【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
                Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
                objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
                objXML.send
                Delay 3000
            End If
            StopThread loginTheadID //停止倒计时线程
            TracePrint &amp;quot;未找到游戏窗口，请确认游戏是否启动【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
            EndScript
        End If
        If X2 &amp;lt;&amp;gt; 1024 OR Y2 &amp;lt;&amp;gt; 768 Then 
            If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
                text = &amp;quot;请将游戏分辨率设置为1024*768、屏幕缩放设置为100%后再次运行【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
                Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
                objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
                objXML.send
                Delay 3000
            End If
            StopThread loginTheadID //停止倒计时线程
            TracePrint &amp;quot;请将游戏分辨率设置为1024*768、屏幕缩放设置为100%后再次运行【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
            EndScript
        End If
        dm_ret = dm.FindPic(0, 0, ScreenW, ScreenH,&amp;quot;play.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
        If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
            dm_ret = dm.SetWindowText(NBA2KHwnd, &amp;quot;窗口-1&amp;quot;)
            dm_ret = dm.BindWindowEx(NBA2KHwnd, displayMode, mouseMode, keypadMode, publicMode, mode)
            If dm_ret &amp;lt;&amp;gt; 0 Then 
                StopThread loginTheadID //停止倒计时线程
                TracePrint &amp;quot;窗口-1绑定成功&amp;quot;
            Else 
                TracePrint &amp;quot;窗口-1绑定失败，结束运行&amp;quot;
                EndScript
            End If
            Exit Do
        End If
    Loop
End Sub
// 自动登录WeGame
Sub loginWegame
    // 开启登录线程，10分钟未登录重启脚本
    loginTheadID = BeginThread(loginThead(600))
    //获得屏幕分辨率宽高  
    ScreenW = dm.GetScreenWidth()
    ScreenH = dm.GetScreenHeight()
    If autoLogin = 0 Then
        Delay 10000
        //最小化
        KeyDown &amp;quot;Win&amp;quot;, 1
        KeyPress &amp;quot;M&amp;quot;, 1
        KeyUp &amp;quot;Win&amp;quot;, 1
        Delay 2000
        // 关闭WeGame
        WEGAME_APP = Plugin.Window.Find(&amp;quot;TWINCONTROL&amp;quot;, 0)
        Call Plugin.Window.CloseEx(WEGAME_APP)
        Delay 8000
        //运行NBA2K Online
        RunApp gamePath
        Delay 10000
        // 是否打开WeGame
        Do While true
            Delay 2000	
            dm_ret = dm.FindPic(0, 0, ScreenW, ScreenH,&amp;quot;login_wegame.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
            If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
                Delay 2000
                WeGameHwnd = dm.FindWindowEx(0,&amp;quot;TWINCONTROL&amp;quot;,&amp;quot;WeGame&amp;quot;)
                Delay 2000
                dm.MoveWindow WeGameHwnd,0,0
                Delay 3000
                dm_ret = dm.BindWindowEx(WeGameHwnd, &amp;quot;normal&amp;quot;, &amp;quot;normal&amp;quot;, &amp;quot;normal&amp;quot;, &amp;quot;&amp;quot;, 0)
                If dm_ret &amp;lt;&amp;gt; 0 Then 
                    TracePrint &amp;quot;登陆界面绑定成功&amp;quot;
                End If 
                TracePrint &amp;quot;检测到WeGame界面&amp;quot;
                Delay 3000
                Exit Do
            End If
        Loop
        If loginSelect = 0 Then //账号密码登录
            //运行Wegame上号器
            RunApp loginPath
            Delay 10000
            LoginHwnd = dm.GetForegroundWindow()
            Delay 1000
            Call Plugin.Sys.SetCLB(accountNumber)
            dm.KeyDown 17
            dm.KeyPress 86
            dm.KeyUp 17
            Delay 1000
            Call Plugin.Sys.SetCLB(&amp;quot;----&amp;quot; + accounPwd)
            dm.KeyDown 17
            dm.KeyPress 86
            dm.KeyUp 17
            Delay 1500
            dm_ret = dm.SetWindowState(WeGameHwnd,1) 
            // 移动WeGame界面、找到输入框
            Do While true
                Delay 3000
                dm_ret = dm.FindPic(0, 0, ScreenW, ScreenH,&amp;quot;login.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
                If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
                    dm.MoveTo intX + 15, intY - 130
                    Delay 500
                    dm.LeftClick
                    Delay 1000
                    Exit Do
                End If
            Loop
            // 自动输入账号密码并登录
            dm.KeyDown 17
            dm.KeyPress 65
            dm.KeyUp 17
            Delay 500
            dm.KeyPress 8
            Delay 500
            dm.KeyPress 114
            Delay 10000
            // 验证码验证
            Do While true
                Delay 10000
                For i = 0 To 3
                    If i = 3 Then
                        TracePrint &amp;quot;验证满3次&amp;quot;
                        // 验证码3次之后还不成功重新输入账号登录
                        If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
                            text = &amp;quot;登录验证码验证失败，请关注后续是否登录成功【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
                            Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
                            objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
                            objXML.send
                            Delay 3000
                        End If
                        dm.MoveTo 589, 102
                        Delay 500
                        dm.LeftClick
                        Delay 5000
                        dm_ret = dm.FindPic(0, 0, ScreenW, ScreenH,&amp;quot;login.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
                        If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
                            dm.MoveTo intX + 15, intY - 130
                            Delay 500
                            dm.LeftClick
                            Delay 1000
                            dm.KeyDown 17
                            dm.KeyPress 65
                            dm.KeyUp 17
                            Delay 500
                            dm.KeyPress 8
                            Delay 500
                            dm.KeyPress 114
                            Delay 3000
                            Exit For
                        End If
                    End If
                    If dm.GetColor(560, 161) = &amp;quot;007aff&amp;quot; Then
                        TracePrint &amp;quot;验证码开始验证&amp;quot;
                        dm.MoveTo 426, 238
                        Delay 500
                        dm.LeftClick
                        Delay 1000
                        dm.MoveTo 543, 160
                        Delay 500
                        dm.LeftClick
                        Delay 5000	                    
                    ElseIf dm.GetColor(561, 161) &amp;lt;&amp;gt; &amp;quot;007aff&amp;quot; Then
                        dm_ret = dm.UnBindWindow()
                        // 关闭上号器
                        dm_ret = dm.SetWindowState(LoginHwnd,13) 
                        Delay 3000
                        Exit Do
                    End If 
                Next
            Loop
        ElseIf loginSelect = 1 Then // 快捷登录
            Do While true
                dm_ret = dm.FindPic(0, 0, ScreenW, ScreenH,&amp;quot;login_wegame.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
                If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
                    dm.MoveTo intX + 50, intY + 250
                    Delay 500
                    dm.LeftClick
                    Delay 1000
                    Exit Do
                End If
            Loop
        End If
        // 是否打开登录界面
        Do While true
            Delay 2000 
            dm_ret = dm.FindPic(0, 0, ScreenW, ScreenH,&amp;quot;start.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
            If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
                WeGameHwnd = dm.FindWindowEx(0, &amp;quot;TWINCONTROL&amp;quot;, &amp;quot;WeGame&amp;quot;)
                Delay 3000
                dm.MoveWindow WeGameHwnd,0,0
                Delay 3000
                dm_ret = dm.SetWindowSize(WeGameHwnd,1200,600)
                Delay 3000
                Exit Do
            End If
            dm_ret = dm.FindPic(0, 0, ScreenW, ScreenH,&amp;quot;weihu.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
            If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
                If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
                    text = &amp;quot;无法登录，服务器处于维护状态【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
                    Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
                    objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
                    objXML.send
                    Delay 3000
                End If
                StopThread loginTheadID //停止倒计时线程
                TracePrint &amp;quot;无法登录，服务器处于维护状态【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
                EndScript
            End If
            dm_ret = dm.FindPic(0, 0, ScreenW, ScreenH,&amp;quot;update.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
            If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
                dm.MoveTo intX + 100, intY + 20
                Delay 1000
                dm.LeftClick
                Delay 1000
                If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
                    text = &amp;quot;游戏正在更新，稍后将自动登录【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
                    Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
                    objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
                    objXML.send
                    Delay 3000
                End If
                TracePrint &amp;quot;游戏正在更新，稍后将自动登录【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
            End If
        Loop
        // 打开选择其他大区
        Do While true
            Delay 2000  
            dm_ret = dm.FindPic(0, 0, ScreenW, ScreenH,&amp;quot;start.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
            If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
                dm.MoveTo intX - 240,intY + 20
                Delay 1000
                dm.LeftClick
                Delay 1000
                Exit Do
            End If
        Loop
        MoveR 0, -50
        Delay 1000
        dm.LeftClick
        Delay 2000
        // 移动选择大区界面
        AreaHwnd = dm.GetForegroundWindow()
        Delay 2000
        dm.MoveWindow AreaHwnd,0,0
        Delay 2000
        // 选择大区并确认
        dm.MoveTo areaX,areaY
        Delay 1000
        dm.LeftClick
        Delay 2000
        dm.MoveTo 96,503
        Delay 1000
        dm.LeftClick
        Delay 2000
        // 启动游戏
        Delay 3000
        Do While true
            Delay 500 
            dm_ret = dm.FindPic(0, 0, ScreenW, ScreenH,&amp;quot;start.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
            If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
                dm.MoveTo intX + 100, intY + 20
                Delay 1000
                dm.LeftClick
                Delay 1000
                Exit Do
            End If
        Loop
        Delay 60000
        // 关闭WeGame
        WEGAME_APP = Plugin.Window.Find(&amp;quot;TWINCONTROL&amp;quot;, 0)
        Call Plugin.Window.CloseEx(WEGAME_APP) 
        Delay 8000
        Call bindNBAWindow()
    Else 
        Call bindNBAWindow()
    End If
End Sub
Sub startGameMsg(nowPlayNum, playCount)
    // 游戏开始提醒
    If playCountMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then
        Set objXML = CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
        url = &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + playCountMiaoCode + &amp;quot;&amp;amp;templ=pP8Wvn9,1,&amp;quot; + playTypeArray(playType) + &amp;quot;,&amp;quot; + pcCode + &amp;quot;,&amp;quot;+ CStr(nowPlayNum) +&amp;quot;,&amp;quot; + CStr(playCount - nowPlayNum) + &amp;quot;,&amp;quot; + Plugin.Sys.GetDateTime()
        objXML.Open &amp;quot;Get&amp;quot;, url, False
        objXML.send
        Delay 1000
    End If
End Sub
// 判断匹配成功并准备
Sub waitPlay
    //判断游戏是否匹配成功
    Do While true
        Delay 3000
        If dm.GetColor(dialogX,dialogY) = dialogCR Then // 出现提示框
            Exit do
        End If
    Loop
    //匹配成功
    Delay 3000
    //关闭匹配成功的提示
    dm.MoveTo closeDialogX, closeDialogY
    Delay 1000
    dm.LeftDoubleClick 
    If playType = 6 Then 
        Delay 2000
        dm2.MoveTo closeDialogX, closeDialogY
        Delay 1000
        dm2.LeftDoubleClick 
    End If
    Delay 15000
    // 关键时刻关闭随机球员提示
    If playType = 10 Then 
        Delay 8000
        dm.MoveTo 490, 560
        Delay 1000
        dm.LeftDoubleClick 
        Delay 1500
    End If
    //点击准备按钮
    dm.MoveTo 473, 660
    Delay 1000
    dm.LeftDoubleClick 
    If playType = 6 Then 
        Delay 2000
        dm2.MoveTo 473, 660
        Delay 1000
        dm2.LeftDoubleClick 
    End If
    Delay 20000
End Sub
//判断是否进入游戏
Sub isPlayNow
    Do While true
        Delay 3000
        If dm.GetColor(1003,21) = &amp;quot;ffffff&amp;quot; Then // 进入游戏退出循环
            Exit do
        End If
        dm_ret = dm.FindPic(0, gameY1, gameX2, gameY2,&amp;quot;play.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
            If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
                text = &amp;quot;游戏出现异常，已重新执行脚本【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
                Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
                objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
                objXML.send
                Delay 3000
            End If
            StopThread playTheadID //停止倒计时线程
            Call nbaService()
        End If
        dm_ret = dm.FindPic(0, gameY1, gameX2, gameY2,&amp;quot;exception.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY) //  发现异常点击确定直至返回大厅
        If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
            //点击确定
            dm.MoveTo closeExceptionX, closeExceptionY
            Delay 600
            dm.LeftDoubleClick
            Delay 600
        End If
        If dm.GetColor(dialogX,dialogY) = dialogCR Then // 出现提示框，有人强退或网络错误
            dm.MoveTo closeDialogX, closeDialogY
            dm.LeftDoubleClick
            Delay 600 
        End If
    Loop
End Sub
// 人物操作、判断是否可以结算、或者游戏异常
Sub movePlayerOrGameOver
    Do While true 
        If playType &amp;lt;&amp;gt; 2 AND playType &amp;lt;&amp;gt; 5 Then 
            If playType = 6 Then
                dm2.KeyDown 37
                Delay 3000
                dm2.KeyUp 37
                Delay 500
                dm2.KeyPress 65
                Delay 800
                dm2.KeyDown 68
                Delay 500
                dm2.KeyUp 68
                Delay 600
                dm2.KeyPress 83
                Delay 800
                dm2.KeyDown 68
                Delay 600
                dm2.KeyUp 68
                Delay 500
            End If
            dm.KeyDown 37
            Delay 3000
            dm.KeyUp 37
            Delay 500
            dm.KeyPress 65
            Delay 800
            dm.KeyDown 68
            Delay 500
            dm.KeyUp 68
            Delay 600
            dm.KeyPress 83
            Delay 800
            dm.KeyDown 68
            Delay 600
            dm.KeyUp 68
            Delay 500
            Delay 8000
        End If
        // 需要投降
        If isPlayFail = 0 Then 
            // 按键操作发起投降
            Delay 2000
            dm.KeyPress 27
            Delay 1000
            dm.MoveTo 433, 471
            dm.LeftClick
            Delay 1000
            //确认投降
            dm.MoveTo 432, 464
            dm.LeftClick
            Delay 5000
            // 图片识别是否投降
            //            If playType = 2 Then 
            //                dm_ret = dm.FindPic(0, gameY1, gameX2, gameY2,&amp;quot;3rdup.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.6,0,intX,intY)
            //                If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
            //                    //发起投降
            //                    dm.KeyPress 27
            //                    Delay 1000
            //                    dm.MoveTo 433, 471
            //                    dm.LeftClick
            //                    Delay 1000
            //                    //确认投降
            //                    dm.MoveTo 432, 464
            //                    dm.LeftClick
            //                    Delay 5000
            //                End If
            //            ElseIf playType &amp;lt;&amp;gt; 2 Then 
            //                dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;3rd.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.6,0,intX,intY)
            //                If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
            //                    //发起投降
            //                    dm.KeyPress 27
            //                    Delay 1000
            //                    dm.MoveTo 433, 471
            //                    dm.LeftClick
            //                    Delay 1000
            //                    //确认投降
            //                    dm.MoveTo 432, 464
            //                    dm.LeftClick
            //                    Delay 5000
            //                End If
            //            End If
        End If
        If playType = 5 Then // 巅峰季后赛
            text = &amp;quot;&amp;quot;
            // 比赛晋级
            dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;success.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
            If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                promoteCount = promoteCount + 1
                text = &amp;quot;巅峰季后赛晋级第&amp;quot;+ CStr(promoteCount) + &amp;quot;轮【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
                dm.MoveTo confirmX, confirmY
                Delay 600
                dm.LeftDoubleClick
                Delay 600
                If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; And promoteCount = maxPromoteCount Then
                    nowPlayNum = 0
                    playCount = 2
                    text = &amp;quot;巅峰季后赛晋级第&amp;quot; + Cstr(maxPromoteCount) +&amp;quot;轮【&amp;quot; + pcCode + &amp;quot;】，2局后自动结束脚本&amp;quot;
                    Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
                    objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
                    objXML.send
                    Delay 3000
                End If
            End If
            // 比赛淘汰
            dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;fail.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
            If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                promoteCount = 0
                nowPlayNum = 0
                text = &amp;quot;巅峰季后赛被淘汰【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
                dm.MoveTo confirmX, confirmY
                Delay 600
                dm.LeftDoubleClick
                Delay 600
            End If
            // 夺得冠军
            dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;success_top.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
            If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                promoteCount = 0
                nowPlayNum = playCount
                text = &amp;quot;巅峰季后赛夺冠军【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
                dm.MoveTo confirmX, confirmY
                Delay 600
                dm.LeftDoubleClick
                Delay 600
            End If
            If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; And text &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
                Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
                objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
                objXML.send
                Delay 3000
            End If
        End If
        //判断游戏是否结束
        If dm.GetColor(128,544) = &amp;quot;bb281e&amp;quot; Then
            // 点击返回或随机选择
            dm.MoveTo 468, 677
            dm.LeftDoubleClick
            Delay 5000
            // 判断是否可以随机选择奖品
            If dm.GetColor(468,677) &amp;lt;&amp;gt; &amp;quot;292a2c&amp;quot; Then
                // 点击返回或随机选择
                dm.MoveTo 468, 677
                dm.LeftDoubleClick
                Delay 5000
            End If
        End If
        // 判断是否可以点击返回大厅
        dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;zonglan.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
        If intX&amp;gt;0 and intY&amp;gt;0 Then  
            // 点击返回大厅
            dm.MoveTo 468, 677
            dm.LeftDoubleClick
            Delay 5000
        End If 
        // 判断游戏是否强制结束
        dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;exception.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
        If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
            //点击确定
            dm.MoveTo closeExceptionX, closeExceptionY
            Delay 600
            dm.LeftDoubleClick
            Delay 5000  
        End If
        // 出现提示框
        If dm.GetColor(dialogX,dialogY) = dialogCR Then
            Delay 1500
            dm.MoveTo closeDialogX, closeDialogY
            dm.LeftDoubleClick 
        End If
        //误点处理
        dm_ret = dm.FindPic(gameX2/2, gameY1, gameX2, gameY2/2, &amp;quot;close.bmp&amp;quot;, &amp;quot;000000&amp;quot;, 0.8, 0, intX, intY)
        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
            dm.MoveTo 819, 72
            Delay 1000
            dm.LeftClick
            Delay 5000 
        End If
        dm_ret = dm.FindPic(gameX1, gameY2/2, gameX2, gameY2,&amp;quot;close2.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
            dm.MoveTo intX + 5, intY + 5
            Delay 1000
            dm.LeftClick
            Delay 5000 
        End If
        // 是否在大厅
        dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2, &amp;quot;play.bmp&amp;quot;, &amp;quot;000000&amp;quot;, 0.8, 0, intX, intY)
        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
            Exit do
        End If
    Loop
    //已经返回大厅
    dm.MoveTo resetX, resetY
    Delay 1000
End Sub
Sub nbaService
    Call cancelIndex()
    //已经进入游戏大厅，执行挂机脚本
    Delay 5000
    dm.MoveTo resetX, resetY
    Delay 1000
    If playType = 0 Then
        // 当前场数
        nowPlayNum = 1
        Do While true
            //点击play
            Do While true
                dm.MoveTo 514, 470
                Delay 500
                dm.LeftClick
                Delay 2000
                If dm.GetColor(128, 368) = &amp;quot;25162e&amp;quot; Then 
                    Exit Do
                End If
            Loop
            Do While true
                If dm.GetColor(128,368) = &amp;quot;25162e&amp;quot; Then
                    //点击人机对战
                    dm.MoveTo 85, 210
                    Delay 500
                    dm.LeftClick
                    Delay 1000
                    //点击街头赛
                    dm.MoveTo 198, 173
                    Delay 500
                    dm.LeftClick
                    Delay 1000
                    //进入比赛
                    dm.MoveTo 910, 361
                    Delay 1000
                    dm.LeftClick 
                    Delay 3000
                Else
                    Exit Do
                End If                
            Loop
            //判断是否进入游戏
            playTheadID = BeginThread(playThead(1200)) //开启倒计时线程
            Call isPlayNow
            Call startGameMsg(nowPlayNum, playCount)       
            Call movePlayerOrGameOver
            StopThread playTheadID //停止倒计时线程
            If nowPlayNum&amp;gt;=playCount Then
                //当循环条件成立的时候，离开循环体
                Call getPrize()
                Exit do  
            End if  
            nowPlayNum=nowPlayNum+1  
        Loop
    ElseIf playType = 4 Then
        // 当前场数
        nowPlayNum = 1
        Do While true
            //点击play
            Do While true
                dm.MoveTo 514, 470
                Delay 500
                dm.LeftClick
                Delay 2000
                If dm.GetColor(128, 368) = &amp;quot;25162e&amp;quot; Then 
                    Exit Do
                End If
            Loop
            Do While true
                If dm.GetColor(128,368) = &amp;quot;25162e&amp;quot; Then
                    //点击经典对战
                    dm.MoveTo 85, 172
                    Delay 500
                    dm.LeftClick
                    Delay 1000
                    //点击街头赛
                    dm.MoveTo 198, 173
                    Delay 500
                    dm.LeftClick
                    Delay 1000
                    //单人匹配
                    dm.MoveTo 769, 361
                    Delay 1000
                    dm.LeftClick
                    Delay 3000
                    // 出现提示框，玩家被禁赛
                    If dm.GetColor(dialogX,dialogY) = dialogCR Then 
                        dm.MoveTo closeDialogX, closeDialogY
                        dm.LeftDoubleClick
                        Delay 600 
                    End If
                Else
                    Exit Do
                End If                
            Loop
            //判断游戏是否匹配成功
            Call waitPlay
            //判断是否进入游戏
            playTheadID = BeginThread(playThead(1200)) //开启倒计时线程
            Call isPlayNow
            Call startGameMsg(nowPlayNum, playCount)       
            Call movePlayerOrGameOver
            StopThread playTheadID //停止倒计时线程
            If nowPlayNum&amp;gt;=playCount Then
                //当循环条件成立的时候，离开循环体
                Call getPrize()
                Exit do  
            End if  
            nowPlayNum=nowPlayNum+1  
        Loop
    ElseIf playType = 5 Then
        // 当前场数
        nowPlayNum = 1
        // 不投降
        isPlayFail = 1
        Do While true
            //点击play
            Do While true
                dm.MoveTo 514, 470
                Delay 500
                dm.LeftClick
                Delay 2000
                If dm.GetColor(128, 368) = &amp;quot;25162e&amp;quot; Then 
                    Exit Do
                End If
            Loop
            Do While true
                If dm.GetColor(128, 368) = &amp;quot;25162e&amp;quot; Then 
                    // 点击人机对战
                    dm.MoveTo 85, 210
                    Delay 500
                    dm.LeftClick
                    Delay 1000
                    // 点击人机巅峰赛
                    dm.MoveTo 203, 209
                    Delay 500
                    dm.LeftClick
                    Delay 1000
                    // 进入比赛
                    dm.MoveTo 910, 361
                    Delay 1000
                    dm.LeftClick 
                    Delay 3000
                    // 失败点击重开赛季
                    dm.MoveTo 904, 645
                    Delay 1000
                    dm.LeftClick 
                    Delay 2000
                    // 首次点击选择球队
                    dm.MoveTo 904, 645
                    Delay 1000
                    dm.LeftClick 
                    Delay 2000
                    // 打开选择球队的页面，选择热火队
                    dm.MoveTo 767, 537
                    Delay 1000
                    dm.LeftClick 
                    Delay 2000
                    dm.MoveTo 379, 627
                    Delay 1000
                    dm.LeftClick 
                    Delay 2000
                    // 选择教练模式进入比赛
                    dm.MoveTo 904, 645
                    Delay 1000
                    dm.LeftClick 
                    Delay 5000
                    // 如果找到了关闭标志点击关闭
                    dm_ret = dm.FindPic(gameX2/2, gameY1, gameX2, gameY2/2, &amp;quot;close.bmp&amp;quot;, &amp;quot;000000&amp;quot;, 0.8, 0, intX, intY)
                    If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                        dm.MoveTo intX + 15, intY + 15
                        Delay 1000
                        dm.LeftClick
                        Delay 1000
                    End If
                Else
                    Exit Do
                End If                
            Loop
            //判断是否进入游戏
            playTheadID = BeginThread(playThead(1500)) //开启倒计时线程
            Call isPlayNow
            Call startGameMsg(nowPlayNum, playCount)       
            Call movePlayerOrGameOver
            StopThread playTheadID //停止倒计时线程
            If nowPlayNum&amp;gt;=playCount Then
                //当循环条件成立的时候，离开循环体
                Call getPrize()
                Exit do  
            End if  
            nowPlayNum=nowPlayNum+1  
        Loop
    ElseIf playType = 6 Then
        // 绑定第2个窗口
        NBA2KHwnd = dm2.FindWindowEx(0,&amp;quot;NBA2KONLINE_EXCLUSIVE_WND_CLASS_NAME&amp;quot;,&amp;quot;NBA2K Onlie 篮球在线&amp;quot;) 
        dm_ret = dm2.SetWindowState(NBA2KHwnd, 1)
        Delay 2000
        dm_ret = dm2.SetWindowText(NBA2KHwnd, &amp;quot;窗口-2&amp;quot;)
        Delay 2000
        dm_ret = dm2.BindWindowEx(NBA2KHwnd, displayMode, mouseMode, keypadMode, publicMode, mode)
        If dm_ret &amp;lt;&amp;gt; 0 Then
            TracePrint &amp;quot;窗口-2绑定成功	&amp;quot;
        Else 
            TracePrint &amp;quot;窗口-2绑定失败，结束运行&amp;quot;
            EndScript
        End If
        // 当前场数
        nowPlayNum = 1
        Do While true
            Do While true
                Delay 1000
                dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2, &amp;quot;play.bmp&amp;quot;, &amp;quot;000000&amp;quot;, 0.8, 0, intX, intY)
                dm_ret2 = dm2.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;play.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX2,intY2)
                If intX &amp;gt; 0 And intY &amp;gt; 0 And intX2 &amp;gt; 0 And intY2 &amp;gt; 0 Then 
                    Exit Do
                ElseIf intX = - 1  OR intY = - 1  Then
                    dm.MoveTo 468, 677
                    dm.LeftDoubleClick
                    Delay 5000
                ElseIf intX2 = - 1  OR intY2 = - 1  Then
                    dm2.MoveTo 468, 677
                    dm2.LeftDoubleClick
                    Delay 5000
                End If
                Delay 1000
            Loop
            //开始匹配
            dm.MoveTo 910, 361
            Delay 1000
            dm.LeftDoubleClick 
            Delay 3000
            //开始匹配
            dm2.MoveTo 910, 361
            Delay 1000
            dm2.LeftDoubleClick 
            Delay 3000
            //判断游戏是否匹配成功
            Call waitPlay
            //判断是否进入游戏
            playTheadID = BeginThread(playThead(1200)) //开启倒计时线程
            Call isPlayNow
            Call startGameMsg(nowPlayNum, playCount)       
            Call movePlayerOrGameOver
            StopThread playTheadID //停止倒计时线程
            If nowPlayNum&amp;gt;=playCount Then
                //当循环条件成立的时候，离开循环体
                Call getPrize()
                Exit do  
            End if  
            nowPlayNum=nowPlayNum+1  
        Loop   
    Else
        // 当前场数
        nowPlayNum = 1
        Do While true
            //点击play
            Do While true
                dm.MoveTo 514, 470
                Delay 500
                dm.LeftClick
                Delay 2000
                If dm.GetColor(128, 368) = &amp;quot;25162e&amp;quot; Then 
                    Exit Do
                End If
            Loop
            Do While true
                If dm.GetColor(128, 368) = &amp;quot;25162e&amp;quot; Then 
                    //点击经典对战
                    dm.MoveTo 85, 172
                    Delay 500
                    dm.LeftClick
                    Delay 1000
                    If playType = 1 Then  //点击NBA对抗赛
                        dm.MoveTo 198, 241
                        Delay 500
                        dm.LeftClick
                        Delay 1000
                    ElseIf playType = 2 Then  //点击教练模式
                        dm.MoveTo 198, 316
                        Delay 500
                        dm.LeftClick
                        Delay 1000
                    ElseIf playType = 3 Then  //点击王朝模式
                        dm.MoveTo 198, 208
                        Delay 500
                        dm.LeftClick
                        Delay 1000
                    ElseIf playType = 10 Then  //点击关键时刻
                        dm.MoveTo 198, 352
                        Delay 500
                        dm.LeftClick
                        Delay 1000
                    Else
                        dm.MoveTo 85, 250  //点击排位赛
                        Delay 500
                        dm.LeftClick
                        Delay 1000
                        If playType = 7 Then  
                            dm.MoveTo 198, 208  // 选择王朝模式
                            Delay 500
                            dm.LeftClick
                            Delay 1000
                        ElseIf playType = 8 Then  
                            dm.MoveTo 198, 241  // 选择NBA对抗赛模式
                            Delay 500
                            dm.LeftClick
                            Delay 1000
                        ElseIf playType = 9 Then  
                            dm.MoveTo 198, 173 //点击街头赛
                            Delay 500
                            dm.LeftClick
                            Delay 1000
                        End If
                    End If
                    If playType &amp;lt;&amp;gt; 9 Then 
                        // 全场开始匹配
                        dm.MoveTo 910, 361
                        Delay 1000
                        dm.LeftClick
                        Delay 3000
                    Else 
                        // 街头赛单人匹配
                        dm.MoveTo 769, 361
                        Delay 500
                        dm.LeftClick
                        Delay 1000
                    End If
                    // 出现提示框，玩家被禁赛
                    If dm.GetColor(dialogX,dialogY) = dialogCR Then 
                        dm.MoveTo closeDialogX, closeDialogY
                        dm.LeftDoubleClick
                        Delay 600 
                    End If
                Else
                    Exit Do
                End If                
            Loop
            //判断游戏是否匹配成功
            Call waitPlay
            //判断是否进入游戏
            playTheadID = BeginThread(playThead(1800)) //开启倒计时线程
            Call isPlayNow
            Call startGameMsg(nowPlayNum, playCount)       
            Call movePlayerOrGameOver
            StopThread playTheadID //停止倒计时线程
            If nowPlayNum&amp;gt;=playCount Then
                //当循环条件成立的时候，离开循环体
                Call getPrize()
                Exit do  
            End if
            nowPlayNum=nowPlayNum+1  
        Loop
    End If
End Sub
// 表演赛业务
Sub getShowService()
    // 领取上次派遣奖励
    For j = 0 To 5
        dm.MoveTo showLevelXArray(j), showLevelYArray(j)
        Delay 500
        dm.LeftDoubleClick
        Delay 1500
        // 点击派遣出发或领取奖励
        dm.MoveTo 812, 674
        Delay 1000
        dm.LeftDown 
        Delay 300
        dm.LeftUp 
        Delay 2000
        // 如果打开派遣界面关闭
        dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;chufa_grey.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
            dm.KeyPress 27
            Delay 1000
        End If
        Delay 1500
    Next
    // 派遣
    For i=0 To 4   
        For j = 0 To 5
            dm.MoveTo showLevelXArray(j), showLevelYArray(j)
            Delay 500
            dm.LeftDoubleClick
            Delay 1500
            dm_ret = dm.FindPic(0, 400, 465, 706, levelImgArray(i), &amp;quot;000000&amp;quot;, 1, 0, intX, intY)
            If intX &amp;gt; 0 And intY &amp;gt; 0 Then
                dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;chufa_hover.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
                If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                    // 点击派遣出发
                    dm.MoveTo 812, 674
                    Delay 1000
                    dm.LeftDoubleClick
                    Delay 1000
                    // 判断是否打开派遣界面
                    Do While true
                        Delay 3000
                        dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;chufa_grey.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
                        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                            Exit do  
                        End If
                    Loop
                    // 选择球员
                    dm.MoveTo 819, 207
                    Delay 1000
                    dm.LeftClick
                    Delay 2500
                    // 判断派遣结果
                    dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2, &amp;quot;chufa_grey.bmp&amp;quot;, &amp;quot;000000&amp;quot;, 0.8, 0, intX, intY)
                    If intX &amp;gt; 0 And intY &amp;gt; 0 Then // 无法派遣
                        dm.KeyPress 27
                        Delay 2500
                    End If
                    dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;chufa_hover2.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
                    If intX &amp;gt; 0 And intY &amp;gt; 0 Then // 点击派遣出发
                        dm.MoveTo intX + 45, intY + 20
                        Delay 1000
                        dm.LeftDoubleClick
                        Delay 3000
                        If dm.GetColor(dialogX,dialogY) = dialogCR Then // 出现提示框，派遣达到上限
                            dm.MoveTo closeDialogX, closeDialogY
                            Delay 1000
                            dm.LeftDoubleClick
                            Delay 1500
                            goShowCount = 3
                            Exit For
                        Else // 派遣成功，次数+1，到3退出循环
                            goShowCount = goShowCount + 1
                            If goShowCount = 3 Then 
                                Exit For
                            End If
                            TracePrint &amp;quot;派遣成功，当前派遣次数&amp;quot;&amp;amp;goShowCount
                        End If
                    End If
                End If
            End If
        Next
        If goShowCount = 3 Then 
            Exit For
        End If
    Next
End Sub
// 执行表演赛
Sub startPlay()
    If isGoPlay = 0 Then 
        TracePrint &amp;quot;开始表演赛&amp;quot;
        Call cancelIndex()
        If dm.GetColor(128, 368) = &amp;quot;25162e&amp;quot; Then 
            dm.MoveTo 514, 470
            Delay 500
            dm.LeftClick
            Delay 2000
        End If
        // 复位
        dm.MoveTo resetX, resetY
        Delay 1000
        // 点击表演赛
        dm.MoveTo 714, 473
        Delay 1000
        dm.LeftClick
        Delay 1000
        // 判断是否打开表演赛界面
        Do While true
            Delay 3000
            dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;bys.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
            If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                Exit do
            End If
        Loop
        TracePrint &amp;quot;打开表演赛界面&amp;quot;
        Call getShowService()
        If goShowCount &amp;lt; 3 Then 
            dm.MoveTo 926, 136
            Delay 1000
            dm.LeftClick
            Delay 2500
            If dm.GetColor(dialogX,dialogY) = dialogCR Then // 出现提示框，不使用球员精华刷新
                dm.MoveTo cancelDialogX, cancelDialogY
                Delay 1000
                dm.LeftDoubleClick
                Delay 1000
            Else 
                Call getShowService()
            End If
            // 返回大厅
            Call cancelIndex()
        Else 
            // 返回大厅
            Call cancelIndex()
        End If
    End If
End Sub
// 奖励领取
Sub getPrize()
    If isGetPrize = 0 Then 
        Call cancelIndex()
        // 领取活跃度奖励
        Do While true
            Delay 3000
            dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;hyd_hover.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.6,0,intX,intY)
            If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                dm.MoveTo intX + 25, intY + 20
                Delay 1000
                dm.LeftClick
                Delay 5000
                Do While true
                    Delay 3000
                    dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;get.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.5,0,intX,intY)
                    If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                        dm.MoveTo intX + 10, intY + 5
                        Delay 1000
                        dm.LeftClick
                        Delay 3000
                        dm.MoveTo confirmX, confirmY
                        Delay 600
                        dm.LeftDoubleClick
                        Delay 3000
                        dm.MoveTo resetX, resetY
                        Delay 600
                    Else 
                        // 如果找到了关闭标志点击关闭
                        dm_ret = dm.FindPic(gameX2/2, gameY1, gameX2, gameY2/2, &amp;quot;close.bmp&amp;quot;, &amp;quot;000000&amp;quot;, 0.8, 0, intX, intY)
                        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                            dm.MoveTo intX + 15, intY + 15
                            Delay 1000
                            dm.LeftClick
                            Delay 1000
                        End If
                        Delay 3000
                        dm.MoveTo resetX, resetY
                        Delay 600
                        Exit do
                    End If
                Loop
                TracePrint &amp;quot;活跃度奖励领取完毕&amp;quot;
                Exit do
            Else 
                TracePrint &amp;quot;暂无活跃度可领取&amp;quot;
                Exit do
            End If
        Loop          
        Call cancelIndex()
        // 领取礼包奖励
        Do While true
            Delay 3000
            dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;libao.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
            If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                dm.MoveTo intX + 15, intY + 15
                Delay 1000
                dm.LeftClick
                Delay 5000
                Do While true
                    Delay 3000
                    // 如果找到了关闭标志点击全部领取
                    dm_ret = dm.FindPic(gameX2/2, gameY1, gameX2, gameY2/2, &amp;quot;close.bmp&amp;quot;, &amp;quot;000000&amp;quot;, 0.8, 0, intX, intY)
                    If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                        dm.MoveTo 524, 627
                        Delay 1000
                        dm.LeftClick
                        Delay 5000
                    End If
                    // 领取成功的提示
                    If dm.GetColor(dialogX,dialogY) = dialogCR Then
                        dm.MoveTo closeDialogX, closeDialogY
                        Delay 1000
                        dm.LeftDoubleClick 
                        Delay 3500
                    End If
                    // 确认返回了大厅
                    dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;play.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
                    If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                        Delay 5000
                        dm.MoveTo resetX, resetY
                        Delay 600
                        Exit do
                    End If
                Loop
                TracePrint &amp;quot;左上角礼包领取完毕&amp;quot;
                Exit do
            Else 
                TracePrint &amp;quot;左上角礼包无奖励可领取&amp;quot;
                Exit do
            End If
        Loop          
        Call cancelIndex()
        // 领取VIP奖励
        Do While true
            Delay 3000
            dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;vip.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
            If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                dm.MoveTo intX + 15, intY + 15
                Delay 1000
                dm.LeftClick
                Delay 5000
                Do While true
                    Delay 3000
                    dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;get2.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
                    If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                        dm.MoveTo intX + 10, intY + 5
                        Delay 1000
                        dm.LeftClick
                        Delay 3000
                    Else 
                        // 如果找到了关闭标志点击关闭
                        dm_ret = dm.FindPic(gameX2/2, gameY1, gameX2, gameY2/2, &amp;quot;close.bmp&amp;quot;, &amp;quot;000000&amp;quot;, 0.8, 0, intX, intY)
                        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                            dm.MoveTo intX + 15, intY + 15
                            Delay 1000
                            dm.LeftClick
                            Delay 1000
                        End If
                        Delay 3000
                        dm.MoveTo resetX, resetY
                        Delay 600
                        Exit do
                    End If
                Loop
                TracePrint &amp;quot;VIP奖励领取完毕&amp;quot;
                Exit do
            Else 
                TracePrint &amp;quot;非VIP用户&amp;quot;
                Exit do
            End If
        Loop          
        Call cancelIndex()
        // 任务、活动奖励领取
        For i=1 To 2
            Delay 3000
            dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2, &amp;quot;jiang.bmp&amp;quot;, &amp;quot;000000&amp;quot;, 0.7, 0, intX, intY)
            dm_ret2 = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;xin.bmp&amp;quot;,&amp;quot;000000&amp;quot;, 0.7, 0, intX2, intY2)
            If intX &amp;gt; 0 And intY &amp;gt; 0 OR intX2 &amp;gt; 0 And intY2 &amp;gt; 0 Then 
                If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                	endX = 960
                    endY = 703
                    dm.MoveTo intX, intY
                    Delay 1000
                ElseIf intX2 &amp;gt; 0 And intY2 &amp;gt; 0 Then
                    endX = 962
                    endY = 681
                    dm.MoveTo intX2, intY2
                    Delay 1000
                End If
                dm.LeftClick
                Delay 5000
                // 开始领奖
                Do While true
                    Delay 3000
                    dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;get2.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.5,0,intX,intY)
                    If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                        dm.MoveTo intX + 10, intY + 5
                        Delay 1000
                        dm.LeftClick
                        Delay 2000
                    Else 
                        dm.WheelDown
                        Delay 1000
                    End If
                    If dm.GetColor(endX,endY) = &amp;quot;666666&amp;quot; Then //下拉框到底了
                        Exit Do
                    End If
                Loop
                // 到底了再执行最后一次领取奖励的操作
                Do While true
                    Delay 3000
                    dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;get2.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.5,0,intX,intY)
                    If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                        dm.MoveTo intX + 10, intY + 5
                        Delay 1000
                        dm.LeftClick
                        Delay 3000
                    Else 
                        // 如果找到了关闭标志点击关闭
                        dm_ret = dm.FindPic(gameX2/2, gameY1, gameX2, gameY2/2, &amp;quot;close.bmp&amp;quot;, &amp;quot;000000&amp;quot;, 0.8, 0, intX, intY)
                        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                            dm.MoveTo intX + 15, intY + 15
                            Delay 1000
                            dm.LeftClick
                            Delay 1000
                        End If
                        Delay 3000
                        dm.MoveTo resetX, resetY
                        Delay 600
                        Exit do
                    End If
                Loop
                Call cancelIndex()
                TracePrint &amp;quot;活动或任务奖励领取完毕&amp;quot;
            Else 
                TracePrint &amp;quot;暂无活动或任务奖励可以领取&amp;quot;
            End If        
        Next 
        Call cancelIndex()
    Else 
        Call cancelIndex()
    End If
End Sub
// 推送脚本状态方法
Sub endGameMsg()
    If isExitOS=0 Then   //挂机完之后需要退出游戏
        //打开退出游戏
        dm.KeyDown 18
        dm.KeyPress 115
        dm.KeyUp 18
        Delay 1000
        //点击确认退出
        dm.MoveTo 883, 655
        Delay 1000
        dm.LeftDoubleClick
        Delay 8000
        // 发送电脑状态提醒
        If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
            text = &amp;quot;执行完毕，电脑已关机【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
            Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
            objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
            objXML.send
            Delay 3000
        End If
        //模式:0=(注销),1=(关机),2=(重启)
        Call Plugin.Sys.ExitOS(1) 
    Else //不需要退出游戏，结束代码
        If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
            text = &amp;quot;执行完毕，您的电脑仍在运行中【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
            Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
            objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
            objXML.send
            Delay 3000
        End If
        EndScript
    End If
    dm_ret = dm.UnBindWindow()
    dm_ret2 = dm2.UnBindWindow() 
End Sub
Call paramsInit()
Call loginWegame()
Call nbaService()
Call getPrize()
Call startPlay()
Call endGameMsg()
LogStop

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;多线程&#34;&gt;多线程&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-vb&#34;&gt;LogStart &amp;quot;D:\用户目录\Desktop\2K1.log&amp;quot;
// 最小化
KeyDown &amp;quot;Win&amp;quot;, 1
KeyPress &amp;quot;M&amp;quot;, 1
KeyUp &amp;quot;Win&amp;quot;, 1
Delay 2000
// 挂机类型
//UserVar playType = DropList{&amp;quot;街头赛（人机）&amp;quot;:0 |&amp;quot;NBA对抗赛&amp;quot;:1|&amp;quot;教练模式&amp;quot;:2|&amp;quot;王朝模式&amp;quot;:3|&amp;quot;街头赛（匹配）&amp;quot;:4|&amp;quot;巅峰季后赛（人机）&amp;quot;:5|&amp;quot;好友2v2&amp;quot;:6|&amp;quot;王朝模式（排位）&amp;quot;:7|&amp;quot;NBA对抗赛（排位）&amp;quot;:8}=0 &amp;quot;选择模式&amp;quot;
//Dim playTypeArray
//playTypeArray = Array(&amp;quot;街头赛（人机）&amp;quot;, &amp;quot;NBA对抗赛&amp;quot;, &amp;quot;教练模式&amp;quot;, &amp;quot;王朝模式&amp;quot;, &amp;quot;街头赛（匹配）&amp;quot;, &amp;quot;巅峰季后赛（人机）&amp;quot;, &amp;quot;好友2v2&amp;quot;,&amp;quot;王朝模式（排位）&amp;quot;,&amp;quot;NBA对抗赛（排位）&amp;quot;)
//UserVar playCount=6 &amp;quot;自定义场数&amp;quot;  // 自定义场数
//UserVar isPlayFail=DropList{&amp;quot;是&amp;quot;:0|&amp;quot;否&amp;quot;:1}=1 &amp;quot;是否投降&amp;quot;  // 是否投降
//UserVar isGetPrize=DropList{&amp;quot;是&amp;quot;:0|&amp;quot;否&amp;quot;:1}=1 &amp;quot;是否领奖&amp;quot;  // 是否领取奖励
//UserVar isGoPlay=DropList{&amp;quot;是&amp;quot;:0|&amp;quot;否&amp;quot;:1}=1 &amp;quot;是否派遣&amp;quot;  // 是否派遣表演赛
//UserVar isExitOS=DropList{&amp;quot;是&amp;quot;:0|&amp;quot;否&amp;quot;:1}=1 &amp;quot;是否关机&amp;quot;  // 是否关闭电脑
// 登录方式
//UserVar loginSelect=DropList{&amp;quot;账号密码&amp;quot;:0|&amp;quot;快捷登录&amp;quot;:1}=0 &amp;quot;登录方式&amp;quot;
// 挂机类型  写死了.................................
Global playType
playType = 0
Global playCount
playCount = 10
Global isPlayFail
isPlayFail = 1
Global isGetPrize
isGetPrize = 0
Global isGoPlay
isGoPlay = 0
Global isExitOS
isExitOS = 1
Global loginSelect
loginSelect = 0
Global imgCode // 验证码验证方式：0 图灵验证  1 手动验证
imgCode = 1
Global maxPromoteCount // 季后赛晋级几轮结束比赛
maxPromoteCount = 3
// 最大窗口数量
Global maxTheadNum
maxTheadNum = 3
Global nowTheadNum
nowTheadNum = 1
// 喵提醒参数：进度喵码和电脑状态喵码
Global msgMiaoCode
msgMiaoCode = &amp;quot;tT48aX9&amp;quot;
// 游戏路径
Global gamePath
gamePath = &amp;quot;D:\Game\NBA2KOL\NBA2K Online\NBA2KOnline.exe&amp;quot;
// 上号器软件路径
Global loginPath
loginPath = &amp;quot;C:\WeGameLogin\WeGameLogin.exe&amp;quot;
// 电脑编码
Global pcCode
pcCode = &amp;quot;B01&amp;quot;
// ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓
// 登录账号
Global accountNumber
accountNumber = &amp;quot;&amp;quot;
// 登录密码
Global accountPwd
accountPwd = &amp;quot;&amp;quot;
// 游戏窗口大小
Global gameX1
gameX1 = 0
Global gameY1
gameY1 = 0
Global gameX2
gameX2 = 1024
Global gameY2
gameY2 = 768
// 复位位置
Global resetX
resetX = 505
Global resetY
resetY = 97
// 黑色提示框
Global dialogX
dialogX = 512
Global dialogY
dialogY = 292
Global dialogCR
dialogCR = &amp;quot;181b1e&amp;quot;
// 点击确认关闭提示
Global closeDialogX
closeDialogX = 510
Global closeDialogY
closeDialogY = 458
// 点击取消关闭提示
Global cancelDialogX
cancelDialogX = 594
Global cancelDialogY
cancelDialogY = 459
// 安小西弹框点击确认
Global confirmX
confirmX = 548
Global confirmY
confirmY = 488
// 关闭投降、网络异常、提前退出的提示坐标
Global closeExceptionX
closeExceptionX = 477
Global closeExceptionY
closeExceptionY = 457
//↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑
// 绑定模式
Global displayMode
displayMode = &amp;quot;gdi&amp;quot;
Global mouseMode
mouseMode = &amp;quot;dx.mouse.position.lock.api|dx.mouse.api|dx.mouse.cursor&amp;quot;
Global keypadMode
keypadMode = &amp;quot;dx.keypad.api&amp;quot;
Global publicMode
publicMode = &amp;quot;dx.public.active.api|dx.public.hide.dll|dx.public.graphic.protect|dx.public.down.cpu&amp;quot;
Global mode
mode = 101
// 创建大漠对象
import &amp;quot;C:\obj.vbs&amp;quot;
Set dm = New dmsoft
ret = dm.Reg(&amp;quot;XXXXXX&amp;quot;, &amp;quot;XXXXXX&amp;quot;)
dm.setPath &amp;quot;.\pic&amp;quot;
dm.SetAero 0
TracePrint dm.Ver()
// 这里做主线程的事情
nowWindow = nowTheadNum
Call paramsInit(nowTheadNum)
Call loginWegame(nowTheadNum)
Call nbaService(nowWindow)
Call getPrize(nowWindow)
Call startPlay(nowWindow)
Sub 线程函数()
    LogStart &amp;quot;D:\用户目录\Desktop\2K1.log&amp;quot;
    // 创建大漠对象
    import &amp;quot;C:\obj.vbs&amp;quot;
    Set dm = New dmsoft
    ret = dm.Reg(&amp;quot;XXXXXX&amp;quot;, &amp;quot;XXXXXX&amp;quot;)
    dm.setPath &amp;quot;.\pic&amp;quot;
    Call Plugin.Msg.Tips(&amp;quot;绑定下一个窗口&amp;quot;) 
    Delay 10000
    // 这里做线程里需要做的事情
    nowWindow = nowTheadNum
    Call paramsInit(nowTheadNum)
    Call loginWegame(nowTheadNum)
    Call nbaService(nowWindow)
    Call getPrize(nowWindow)
    Call startPlay(nowWindow)
    Call endGameMsg(nowWindow)
End Sub
// 初始化
Sub paramsInit(nowWindow)
    If Hour(time) &amp;gt;= 0 and Hour(time) &amp;lt; 8 Then 
        autoLogin = 0
        loginSelect = 0
        playType = 0
        playCount = 10
        isPlayFail = 1
        isGetPrize = 0
        isGoPlay = 0
        isExitOS = 1
    End If
    TracePrint &amp;quot;参数初始化完成&amp;quot;
End Sub
// 登录结束绑定窗口
Sub bindNBAWindow(nowWindow)
    TracePrint &amp;quot;开始绑定窗口&amp;quot;
    TracePrint  nowWindow
    Do While true
        Delay 3000
        NBA2KHwnd =Plugin.Window.Foreground()
        Call Plugin.Window.Active(NBA2KHwnd)
        TracePrint NBA2KHwnd
        TracePrint &amp;quot;窗口-&amp;quot;+ CStr(nowWindow)
        // 获取窗体宽高
        MyArray = Split(Plugin.Window.GetClientRect(NBA2KHwnd), &amp;quot;|&amp;quot;)
        W1 = Clng(MyArray(0)): H1 = Clng(MyArray(1))   
        W2 = Clng(MyArray(2)) : H2 = Clng(MyArray(3))
        If W2 = -1 OR H2 = -1 Then 
            If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
                text = &amp;quot;未找到游戏窗口，请确认游戏是否启动【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
                Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
                objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
                objXML.send
                Delay 3000
            End If
            TracePrint &amp;quot;未找到游戏窗口，请确认游戏是否启动【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
            EndScript
        End If
        If W2 &amp;lt;&amp;gt; 1024 OR H2 &amp;lt;&amp;gt; 768 Then 
            If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
                text = &amp;quot;请将游戏分辨率设置为1024*768、屏幕缩放设置为100%后再次运行【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
                Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
                objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
                objXML.send
                Delay 3000
            End If
            TracePrint &amp;quot;请将游戏分辨率设置为1024*768、屏幕缩放设置为100%后再次运行【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
            EndScript
        End If
        dm_ret = dm.FindPic(0, 0, ScreenW, ScreenH,&amp;quot;play.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
        If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
            Call Plugin.Window.SetText(NBA2KHwnd,&amp;quot;窗口-&amp;quot;+ CStr(nowWindow))
            dm_ret = dm.BindWindowEx(NBA2KHwnd, displayMode, mouseMode, keypadMode, publicMode, mode)
            If dm_ret &amp;lt;&amp;gt; 0 Then 
                Call Plugin.Window.Move(NBA2KHwnd, nowWindow * 10, nowWindow * 10)
                TracePrint &amp;quot;窗口-&amp;quot; + CStr(nowWindow) + &amp;quot;绑定成功&amp;quot;
                If nowTheadNum &amp;lt; maxTheadNum Then 
                    nowTheadNum = nowTheadNum + 1
                    BeginThread 线程函数()
                Else 
                    If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
                        text = &amp;quot;达到目标窗口数，不再绑定【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
                        Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
                        objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
                        objXML.send
                        Delay 3000
                    End If
                    TracePrint &amp;quot;达到目标窗口数，不再绑定&amp;quot;
                End If
            Else 
                TracePrint &amp;quot;窗口-&amp;quot;+ CStr(nowWindow) + &amp;quot;绑定失败，结束运行&amp;quot;
                EndScript
            End If
            Exit Do
        End If
    Loop
End Sub
// 自动登录WeGame
Sub loginWegame(nowWindow)
    // 登录大区
    areaX = 0
    areaY = 246
    Dim areaXList
    areaXList = Array(434,598,274,111)
    //获得屏幕分辨率宽高  
    ScreenW = Plugin.GetSysInfo.GetScreenResolutionX()
    ScreenH = Plugin.GetSysInfo.GetScreenResolutionY()
    Delay 10000
    // 关闭WeGame
    WEGAME_APP = Plugin.Window.Find(&amp;quot;TWINCONTROL&amp;quot;, 0)
    Call Plugin.Window.CloseEx(WEGAME_APP)
    Delay 8000
    //运行NBA2K Online
    RunApp gamePath
    Delay 10000
    // 是否打开WeGame
    Do While true
        Delay 2000	
        dm_ret = dm.FindPic(0, 0, ScreenW, ScreenH,&amp;quot;login_wegame.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
        If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
            Delay 2000
            WeGameHwnd = Plugin.Window.Find(&amp;quot;TWINCONTROL&amp;quot;, &amp;quot;WeGame&amp;quot;)
            Delay 2000
            Call Plugin.Window.Move(WeGameHwnd, 0, 0)
            Delay 3000
            dm_ret = dm.BindWindowEx(WeGameHwnd, &amp;quot;normal&amp;quot;, &amp;quot;normal&amp;quot;, &amp;quot;normal&amp;quot;, &amp;quot;&amp;quot;, 0)
            If dm_ret &amp;lt;&amp;gt; 0 Then 
                TracePrint &amp;quot;登陆界面绑定成功&amp;quot;
            End If 
            TracePrint &amp;quot;检测到WeGame界面&amp;quot;
            Exit Do
        End If
    Loop
    If loginSelect = 0 Then //账号密码登录
        TracePrint &amp;quot;读取文本内容：&amp;quot; + Cstr(nowWindow)
        // 读取文本
        accountText = Plugin.File.ReadFileEx(&amp;quot;C:\2K1\ZH_&amp;quot; + Cstr(nowWindow) + &amp;quot;.txt&amp;quot;)
        dim MyArray
        MyArray = Split(accountText, &amp;quot;|&amp;quot;)   
        If UBound(MyArray)&amp;gt;=0 Then   
            accountInfo = Split(Cstr(MyArray(0)), &amp;quot;/&amp;quot;)   
            If UBound(accountInfo)&amp;gt;=0 Then   
                accountNumber = Cstr(accountInfo(0))
                accountPwd = Cstr(accountInfo(1))
                TracePrint &amp;quot;登录账号&amp;quot; + Cstr(accountInfo(0))
                TracePrint &amp;quot;登录大区编码：&amp;quot; + accountInfo(2)
                areaX = areaXList(accountInfo(2) - 1)
            End If
        End If
        //运行Wegame上号器
        RunApp loginPath
        Delay 10000
        LoginHwnd = Plugin.Window.Foreground()
        Delay 1000
        Call Plugin.Sys.SetCLB(accountNumber + &amp;quot;----&amp;quot; + accountPwd)
        dm.KeyDown 17
        dm.KeyPress 86
        dm.KeyUp 17
        Delay 1500
        // 移动WeGame界面、找到输入框
        Do While true
            dm_ret = dm.FindPic(0, 0, ScreenW, ScreenH,&amp;quot;login.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
            If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
                dm.MoveTo intX + 15, intY - 130
                Delay 500
                dm.LeftClick
                Delay 1000
                Exit Do
            End If
        Loop
        // 自动输入账号密码并登录
        dm.KeyDown 17
        dm.KeyPress 65
        dm.KeyUp 17
        Delay 500
        dm.KeyPress 8
        Delay 500
        dm.KeyPress 114
        Delay 10000
        // 验证码验证
        Do While true
            Delay 10000
            For i = 0 To 2
                If i = 2 Then
                    TracePrint &amp;quot;验证满3次&amp;quot;
                    // 验证码3次之后还不成功重新输入账号登录
                    dm.MoveTo 589, 102
                    Delay 500
                    dm.LeftClick
                    Delay 5000
                    dm_ret = dm.FindPic(0, 0, ScreenW, ScreenH,&amp;quot;login.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
                    If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
                        dm.MoveTo intX + 15, intY - 130
                        Delay 500
                        dm.LeftClick
                        Delay 1000
                        dm.KeyDown 17
                        dm.KeyPress 65
                        dm.KeyUp 17
                        Delay 500
                        dm.KeyPress 8
                        Delay 500
                        dm.KeyPress 114
                        Delay 3000
                        Exit For
                    End If
                End If
                If dm.GetColor(560, 161) = &amp;quot;007aff&amp;quot; Then
                    TracePrint &amp;quot;验证码开始验证&amp;quot;
                    If imgCode = 0 Then 
                        username=&amp;quot;viaoh-&amp;quot;
                        password=&amp;quot;liuQQ账号&amp;quot;
                        ID = &amp;quot;42077360&amp;quot;
                        developer = username
                        dm_ret = dm.CaptureJpg(282, 152, 566, 375, &amp;quot;C:\2K1\imgcode.jpg&amp;quot;, 80)
                        img_path = &amp;quot;C:\2K1\imgcode.jpg&amp;quot;
                        version=&amp;quot;3.1.1&amp;quot;
                        X=Chr(34)
                        b64 = Plugin.SMWH.Base64_File(img_path)
                        Param=&amp;quot;{&amp;quot;&amp;amp;X&amp;amp;&amp;quot;username&amp;quot;&amp;amp;X&amp;amp;&amp;quot;:&amp;quot;&amp;amp;X&amp;amp;username&amp;amp;X&amp;amp;&amp;quot;,&amp;quot;&amp;amp;X&amp;amp;&amp;quot;password&amp;quot;&amp;amp;X&amp;amp;&amp;quot;:&amp;quot;&amp;amp;X&amp;amp;password&amp;amp;X&amp;amp;&amp;quot;,&amp;quot;&amp;amp;X&amp;amp;&amp;quot;ID&amp;quot;&amp;amp;X&amp;amp;&amp;quot;:&amp;quot;&amp;amp;X&amp;amp;ID&amp;amp;X&amp;amp;&amp;quot;,&amp;quot;&amp;amp;X&amp;amp;&amp;quot;b64&amp;quot;&amp;amp;X&amp;amp;&amp;quot;:&amp;quot;&amp;amp;X&amp;amp;b64&amp;amp;X&amp;amp;&amp;quot;,&amp;quot;&amp;amp;X&amp;amp;&amp;quot;version&amp;quot;&amp;amp;X&amp;amp;&amp;quot;:&amp;quot;&amp;amp;X&amp;amp;version&amp;amp;X&amp;amp;&amp;quot;,&amp;quot;&amp;amp;X&amp;amp;&amp;quot;developer&amp;quot;&amp;amp;X&amp;amp;&amp;quot;:&amp;quot;&amp;amp;X&amp;amp;developer&amp;amp;X&amp;amp;&amp;quot;}&amp;quot;
                        json =  Plugin.SMWH.WinHttp(&amp;quot;http://www.fdyscloud.com.cn/tuling/predict&amp;quot;, 1, param ,&amp;quot;&amp;quot; ,&amp;quot;&amp;quot; ,&amp;quot;&amp;quot;,&amp;quot;Content-Type: application/json; charset=UTF-8&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;UTF-8&amp;quot;)
                        TracePrint json
                        result = Plugin.SMWH.GetJSON(json, &amp;quot;data.result&amp;quot;)
                        TracePrint result
                        If CInt(Plugin.SMWH.GetJSON(json, &amp;quot;code&amp;quot;)) = 1 Then 
                            TracePrint &amp;quot;验证码坐标位置识别成功&amp;quot;
                            X = Plugin.SMWH.GetJSON(json, &amp;quot;data.顺序1.X坐标值&amp;quot;)
                            TracePrint X
                            Y = Plugin.SMWH.GetJSON(json, &amp;quot;data.顺序1.Y坐标值&amp;quot;)
                            TracePrint Y
                            MsgBox &amp;quot;准备移动到&amp;quot; + Cstr(282 + CInt(X)) + &amp;quot;         &amp;quot; + Cstr(152 + CInt(Y))
                            //{ &amp;quot;code&amp;quot;: 1, &amp;quot;message&amp;quot;: &amp;quot;&amp;quot;, &amp;quot;data&amp;quot;: { &amp;quot;顺序1&amp;quot;: { &amp;quot;X坐标值&amp;quot;: 67, &amp;quot;Y坐标值&amp;quot;: 199 }, &amp;quot;顺序2&amp;quot;: { &amp;quot;X坐标值&amp;quot;: 256, &amp;quot;Y坐标值&amp;quot;: 199 } } }
                            dm.MoveTo 282 + CInt(X), 152 + CInt(Y)
                            Delay 500
                            dm.LeftClick
                            Delay 1000
                            dm.MoveTo 543, 160
                            Delay 500
                            dm.LeftClick
                            Delay 5000
                        Else 
                            TracePrint &amp;quot;验证码坐标位置识别失败&amp;quot;
                            Delay 5000
                        End If
                    Else 
                        dm.MoveTo 426, 238
                        Delay 500
                        dm.LeftClick
                        Delay 1000
                        dm.MoveTo 543, 160
                        Delay 500
                        dm.LeftClick
                        Delay 5000	
                    End If                    
                ElseIf dm.GetColor(561, 161) &amp;lt;&amp;gt; &amp;quot;007aff&amp;quot; Then
                    dm_ret = dm.UnBindWindow()
                    // 关闭上号器
                    Call Plugin.Window.Close(LoginHwnd)
                    Delay 3000
                    Exit Do
                End If 
            Next
        Loop
    ElseIf loginSelect = 1 Then // 快捷登录
        Do While true
            dm_ret = dm.FindPic(0, 0, ScreenW, ScreenH,&amp;quot;login_wegame.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
            If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
                dm.MoveTo intX + 50, intY + 250
                Delay 500
                dm.LeftClick
                Delay 1000
                Exit Do
            End If
        Loop
    End If
    // 是否打开登录界面
    Do While true
        Delay 2000 
        dm_ret = dm.FindPic(0, 0, ScreenW, ScreenH,&amp;quot;start.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
        If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
            WeGameHwnd = Plugin.Window.Find(&amp;quot;TWINCONTROL&amp;quot;, &amp;quot;WeGame&amp;quot;)
            Delay 1000
            Call Plugin.Window.Move(WeGameHwnd, 0, 0)
            Delay 1000
            Call Plugin.Window.Size(WeGameHwnd, 1200, 600)
            Delay 3000
            Exit Do
        End If
        dm_ret = dm.FindPic(0, 0, ScreenW, ScreenH,&amp;quot;weihu.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
        If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
            If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
                text = &amp;quot;无法登录，服务器处于维护状态【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
                Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
                objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
                objXML.send
                Delay 3000
            End If
            TracePrint &amp;quot;无法登录，服务器处于维护状态【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
            EndScript
        End If
        dm_ret = dm.FindPic(0, 0, ScreenW, ScreenH,&amp;quot;update.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
        If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
            dm.MoveTo intX + 100, intY + 20
            Delay 1000
            dm.LeftClick
            Delay 1000
            If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
                text = &amp;quot;游戏正在更新，稍后将自动登录【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
                Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
                objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
                objXML.send
                Delay 3000
            End If
            TracePrint &amp;quot;游戏正在更新，稍后将自动登录【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
        End If
    Loop
    // 打开选择其他大区
    Do While true
        Delay 2000  
        dm_ret = dm.FindPic(0, 0, ScreenW, ScreenH,&amp;quot;start.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
        If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
            dm.MoveTo intX - 240,intY + 20
            Delay 1000
            dm.LeftClick
            Delay 1000
            Exit Do
        End If
    Loop
    MoveR 0, -50
    Delay 1000
    dm.LeftClick
    Delay 2000
    // 移动选择大区界面
    AreaHwnd = Plugin.Window.Foreground()
    Call Plugin.Window.Move(AreaHwnd, 0, 0)
    Delay 1000
    // 选择大区并确认
    dm.MoveTo areaX,areaY
    Delay 1000
    dm.LeftClick
    Delay 2000
    dm.MoveTo 96,503
    Delay 1000
    dm.LeftClick
    Delay 2000
    // 启动游戏
    Delay 3000
    // 打开选择其他大区
    Do While true
        Delay 500 
        dm_ret = dm.FindPic(0, 0, ScreenW, ScreenH,&amp;quot;start.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
        If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
            dm.MoveTo intX + 100, intY + 20
            Delay 1000
            dm.LeftClick
            Delay 1000
            Exit Do
        End If
    Loop
    Delay 60000
    // 关闭WeGame
    WEGAME_APP = Plugin.Window.Find(&amp;quot;TWINCONTROL&amp;quot;, 0)
    Call Plugin.Window.CloseEx(WEGAME_APP)
    Delay 8000
    Call bindNBAWindow(nowWindow)
End Sub
// 点击返回按钮返回大厅、判断是否在游戏大厅
Sub cancelIndex(nowWindow)
    Do While True
        Delay 1000
        dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;play.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
            Delay 5000
            Exit do
        End If
        dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;zhuye.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
            dm.MoveTo intX + 15, intY + 10
            Delay 1000
            dm.LeftClick
            Delay 3000
        End If
        dm_ret = dm.FindPic(gameX2/2, gameY1, gameX2, gameY2/2, &amp;quot;close.bmp&amp;quot;, &amp;quot;000000&amp;quot;, 0.8, 0, intX, intY)
        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
            dm.MoveTo intX + 15, intY + 15
            Delay 1000
            dm.LeftClick
            Delay 3000
        End If
    Loop
End Sub
// 表演赛业务
Sub getShowService(nowWindow)
    // 六个表演赛坐标
    Dim showLevelXArray
    showLevelXArray = Array(277,494,713,659,427,175)
    Dim showLevelYArray
    showLevelYArray = Array(209,281,298,512,408,375)
    // 当前已派遣次数
    goShowCount = 0
    // 5个等级判断
    Dim levelImgArray
    levelImgArray = Array(&amp;quot;level-UR.bmp&amp;quot;, &amp;quot;level-SSR.bmp&amp;quot;, &amp;quot;level-SS.bmp&amp;quot;, &amp;quot;level-S.bmp&amp;quot;, &amp;quot;level-A.bmp&amp;quot;)
    // 领取上次派遣奖励
    For j = 0 To 5
        dm.MoveTo showLevelXArray(j), showLevelYArray(j)
        Delay 500
        dm.LeftDoubleClick
        Delay 1500
        // 点击派遣出发或领取奖励
        dm.MoveTo 812, 674
        Delay 1000
        dm.LeftDown 
        Delay 300
        dm.LeftUp 
        Delay 2000
        // 如果打开派遣界面关闭
        dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;chufa_grey.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
            dm.KeyPress 27
            Delay 1000
        End If
        Delay 1500
    Next
    // 派遣
    For i=0 To 4   
        For j = 0 To 5
            dm.MoveTo showLevelXArray(j), showLevelYArray(j)
            Delay 500
            dm.LeftDoubleClick
            Delay 1500
            dm_ret = dm.FindPic(0, 400, 465, 706, levelImgArray(i), &amp;quot;000000&amp;quot;, 1, 0, intX, intY)
            If intX &amp;gt; 0 And intY &amp;gt; 0 Then
                dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;chufa_hover.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
                If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                    // 点击派遣出发
                    dm.MoveTo 812, 674
                    Delay 1000
                    dm.LeftDoubleClick
                    Delay 1000
                    // 判断是否打开派遣界面
                    Do While true
                        Delay 3000
                        dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;chufa_grey.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
                        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                            Exit do  
                        End If
                    Loop
                    // 选择球员
                    dm.MoveTo 819, 207
                    Delay 1000
                    dm.LeftClick
                    Delay 2500
                    // 判断派遣结果
                    dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2, &amp;quot;chufa_grey.bmp&amp;quot;, &amp;quot;000000&amp;quot;, 0.8, 0, intX, intY)
                    If intX &amp;gt; 0 And intY &amp;gt; 0 Then // 无法派遣
                        dm.KeyPress 27
                        Delay 2500
                    End If
                    dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;chufa_hover2.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
                    If intX &amp;gt; 0 And intY &amp;gt; 0 Then // 点击派遣出发
                        dm.MoveTo intX + 45, intY + 20
                        Delay 1000
                        dm.LeftDoubleClick
                        Delay 3000
                        If dm.GetColor(dialogX,dialogY) = dialogCR Then // 出现提示框，派遣达到上限
                            dm.MoveTo closeDialogX, closeDialogY
                            Delay 1000
                            dm.LeftDoubleClick
                            Delay 1500
                            goShowCount = 3
                            Exit For
                        Else // 派遣成功，次数+1，到3退出循环
                            goShowCount = goShowCount + 1
                            If goShowCount = 3 Then 
                                Exit For
                            End If
                            TracePrint &amp;quot;派遣成功，当前派遣次数&amp;quot;&amp;amp;goShowCount
                        End If
                    End If
                End If
            End If
        Next
        If goShowCount = 3 Then 
            Exit For
        End If
    Next
End Sub
// 执行表演赛
Sub startPlay(nowWindow)
    If isGoPlay = 0 Then 
        TracePrint &amp;quot;开始表演赛&amp;quot;
        Call cancelIndex(nowWindow)
        If dm.GetColor(128, 368) = &amp;quot;25162e&amp;quot; Then 
            dm.MoveTo 514, 470
            Delay 500
            dm.LeftClick
            Delay 2000
        End If
        // 复位
        dm.MoveTo resetX, resetY
        Delay 1000
        // 点击表演赛
        dm.MoveTo 714, 473
        Delay 1000
        dm.LeftClick
        Delay 1000
        // 判断是否打开表演赛界面
        Do While true
            Delay 3000
            dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;bys.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
            If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                Exit do
            End If
        Loop
        TracePrint &amp;quot;打开表演赛界面&amp;quot;
        Call getShowService(nowWindow)
        If goShowCount &amp;lt; 3 Then 
            dm.MoveTo 926, 136
            Delay 1000
            dm.LeftClick
            Delay 2500
            If dm.GetColor(dialogX,dialogY) = dialogCR Then // 出现提示框，不使用球员精华刷新
                dm.MoveTo cancelDialogX, cancelDialogY
                Delay 1000
                dm.LeftDoubleClick
                Delay 1000
            Else 
                Call getShowService(nowWindow)
            End If
            // 返回大厅
            Call cancelIndex(nowWindow)
        Else 
            // 返回大厅
            Call cancelIndex(nowWindow)
        End If
    End If
End Sub
// 奖励领取
Sub getPrize(nowWindow)
    If isGetPrize = 0 Then 
        Call cancelIndex(nowWindow)
        // 领取活跃度奖励
        Do While true
            Delay 3000
            dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;hyd_hover.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.6,0,intX,intY)
            If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                dm.MoveTo intX + 25, intY + 20
                Delay 1000
                dm.LeftClick
                Delay 5000
                Do While true
                    Delay 3000
                    dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;get.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.5,0,intX,intY)
                    If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                        dm.MoveTo intX + 10, intY + 5
                        Delay 1000
                        dm.LeftClick
                        Delay 3000
                        dm.MoveTo confirmX, confirmY
                        Delay 600
                        dm.LeftDoubleClick
                        Delay 3000
                        dm.MoveTo resetX, resetY
                        Delay 600
                    Else 
                        // 如果找到了关闭标志点击关闭
                        dm_ret = dm.FindPic(gameX2/2, gameY1, gameX2, gameY2/2, &amp;quot;close.bmp&amp;quot;, &amp;quot;000000&amp;quot;, 0.8, 0, intX, intY)
                        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                            dm.MoveTo intX + 15, intY + 15
                            Delay 1000
                            dm.LeftClick
                            Delay 1000
                        End If
                        Delay 3000
                        dm.MoveTo resetX, resetY
                        Delay 600
                        Exit do
                    End If
                Loop
                TracePrint &amp;quot;活跃度奖励领取完毕&amp;quot;
                Exit do
            Else 
                TracePrint &amp;quot;暂无活跃度可领取&amp;quot;
                Exit do
            End If
        Loop          
        Call cancelIndex(nowWindow)
        // 任务、活动奖励领取
        Do While true
            Delay 3000
            endX = 960
            endY = 701
            dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2, &amp;quot;jiang.bmp&amp;quot;, &amp;quot;000000&amp;quot;, 0.7, 0, intX, intY)
            dm_ret2 = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;xin.bmp&amp;quot;,&amp;quot;000000&amp;quot;, 0.7, 0, intX2, intY2)
            If intX &amp;gt; 0 And intY &amp;gt; 0 OR intX2 &amp;gt; 0 And intY2 &amp;gt; 0 Then 
                If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                    endY = 680
                    dm.MoveTo intX, intY
                    Delay 1000
                ElseIf intX2 &amp;gt; 0 And intY2 &amp;gt; 0 Then
                    endY = 701
                    dm.MoveTo intX2, intY2
                    Delay 1000
                End If
                dm.LeftClick
                Delay 5000
                // 开始领奖
                Do While true
                    Delay 3000
                    dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;get2.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.5,0,intX,intY)
                    If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                        dm.MoveTo intX + 10, intY + 5
                        Delay 1000
                        dm.LeftClick
                        Delay 2000
                    Else 
                        dm.WheelDown
                        Delay 1000
                    End If
                    If dm.GetColor(endX,endY) = &amp;quot;666666&amp;quot; Then //下拉框到底了
                        Exit Do
                    End If
                Loop
                // 到底了再执行最后一次领取奖励的操作
                Do While true
                    Delay 3000
                    dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;get2.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.5,0,intX,intY)
                    If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                        dm.MoveTo intX + 10, intY + 5
                        Delay 1000
                        dm.LeftClick
                        Delay 3000
                    Else 
                        // 如果找到了关闭标志点击关闭
                        dm_ret = dm.FindPic(gameX2/2, gameY1, gameX2, gameY2/2, &amp;quot;close.bmp&amp;quot;, &amp;quot;000000&amp;quot;, 0.8, 0, intX, intY)
                        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                            dm.MoveTo intX + 15, intY + 15
                            Delay 1000
                            dm.LeftClick
                            Delay 1000
                        End If
                        Delay 3000
                        dm.MoveTo resetX, resetY
                        Delay 600
                        Exit do
                    End If
                Loop
                Call cancelIndex(nowWindow)
                TracePrint &amp;quot;活动或任务奖励领取完毕&amp;quot;
            Else 
                TracePrint &amp;quot;暂无活动或任务奖励可以领取&amp;quot;
                Exit do
            End If        
        Loop 
        Call cancelIndex(nowWindow)
        // 领取礼包奖励
        Do While true
            Delay 3000
            dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;libao.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
            If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                dm.MoveTo intX + 15, intY + 15
                Delay 1000
                dm.LeftClick
                Delay 5000
                Do While true
                    Delay 3000
                    // 如果找到了关闭标志点击全部领取
                    dm_ret = dm.FindPic(gameX2/2, gameY1, gameX2, gameY2/2, &amp;quot;close.bmp&amp;quot;, &amp;quot;000000&amp;quot;, 0.8, 0, intX, intY)
                    If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                        dm.MoveTo 524, 627
                        Delay 1000
                        dm.LeftClick
                        Delay 5000
                    End If
                    // 领取成功的提示
                    If dm.GetColor(dialogX,dialogY) = dialogCR Then
                        dm.MoveTo closeDialogX, closeDialogY
                        Delay 1000
                        dm.LeftDoubleClick 
                        Delay 3500
                    End If
                    // 确认返回了大厅
                    dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;play.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
                    If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                        Delay 5000
                        dm.MoveTo resetX, resetY
                        Delay 600
                        Exit do
                    End If
                Loop
                TracePrint &amp;quot;左上角礼包领取完毕&amp;quot;
                Exit do
            Else 
                TracePrint &amp;quot;左上角礼包无奖励可领取&amp;quot;
                Exit do
            End If
        Loop          
        Call cancelIndex(nowWindow)
        // 领取VIP奖励
        Do While true
            Delay 3000
            dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;vip.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
            If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                dm.MoveTo intX + 15, intY + 15
                Delay 1000
                dm.LeftClick
                Delay 5000
                Do While true
                    Delay 3000
                    dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;get2.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.7,0,intX,intY)
                    If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                        dm.MoveTo intX + 10, intY + 5
                        Delay 1000
                        dm.LeftClick
                        Delay 3000
                    Else 
                        // 如果找到了关闭标志点击关闭
                        dm_ret = dm.FindPic(gameX2/2, gameY1, gameX2, gameY2/2, &amp;quot;close.bmp&amp;quot;, &amp;quot;000000&amp;quot;, 0.8, 0, intX, intY)
                        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                            dm.MoveTo intX + 15, intY + 15
                            Delay 1000
                            dm.LeftClick
                            Delay 1000
                        End If
                        Delay 3000
                        dm.MoveTo resetX, resetY
                        Delay 600
                        Exit do
                    End If
                Loop
                TracePrint &amp;quot;VIP奖励领取完毕&amp;quot;
                Exit do
            Else 
                TracePrint &amp;quot;非VIP用户&amp;quot;
                Exit do
            End If
        Loop          
        Call cancelIndex(nowWindow)
    Else 
        Call cancelIndex(nowWindow)
    End If
End Sub
Sub OnScriptExit() // 这句只会在主线程结束时被调用到
    If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
        text = &amp;quot;执行完毕，您的电脑仍在运行中【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
        Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
        objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
        objXML.send
        Delay 3000
    End If
    dm_ret = dm.UnBindWindow()
End Sub
Sub startGameMsg(nowPlayNum, playCount, nowWindow)
    // 游戏开始提醒
    TracePrint &amp;quot;比赛进度通知：窗口&amp;quot; + Cstr(nowWindow) + &amp;quot;正在进行第&amp;quot; + CStr(nowPlayNum) + &amp;quot;场比赛&amp;quot;
End Sub
// 推送脚本状态方法
Sub endGameMsg(nowWindow)
    If isExitOS=0 Then   //挂机完之后需要退出游戏
        //打开退出游戏
        dm.KeyDown 18
        dm.KeyPress 115
        dm.KeyUp 18
        Delay 1000
        //点击确认退出
        dm.MoveTo 883, 655
        Delay 1000
        dm.LeftDoubleClick
        Delay 8000
        // 发送电脑状态提醒
        If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
            text = &amp;quot;执行完毕，电脑已关机【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
            Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
            objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
            objXML.send
            Delay 3000
        End If
        //模式:0=(注销),1=(关机),2=(重启)
        Call Plugin.Sys.ExitOS(1) 
    Else //不需要退出游戏，结束代码
        If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
            text = &amp;quot;执行完毕，您的电脑仍在运行中【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
            Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
            objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
            objXML.send
            Delay 3000
        End If
        EndScript
    End If
End Sub
// 判断匹配成功并准备
Sub waitPlay(nowWindow)
    //判断游戏是否匹配成功
    Do While true
        Delay 3000
        If dm.GetColor(dialogX,dialogY) = dialogCR Then // 出现提示框
            Exit do
        End If
    Loop
    //匹配成功
    Delay 3000
    //关闭匹配成功的提示
    dm.MoveTo closeDialogX, closeDialogY
    dm.LeftDoubleClick 
    Delay 15000
    // 关键时刻关闭随机球员提示
    If playType = 10 Then 
        Delay 8000
        dm.MoveTo 490, 560
        Delay 1000
        dm.LeftDoubleClick 
        Delay 1500
    End If
    //点击准备按钮
    dm.MoveTo 473, 660 
    dm.LeftDoubleClick 
    Delay 20000
End Sub
//判断是否进入游戏
Sub isPlayNow(nowWindow)
    Do While true
        Delay 3000
        If dm.GetColor(1003,21) = &amp;quot;ffffff&amp;quot; Then // 进入游戏退出循环
            Exit do
        End If
        dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;play.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
            If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
                text = &amp;quot;游戏出现异常，已重新执行脚本【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
                Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
                objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
                objXML.send
                Delay 3000
            End If
            Call nbaService(nowWindow)
        End If
        dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;exception.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY) //  发现异常点击确定直至返回大厅
        If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
            //点击确定
            dm.MoveTo closeExceptionX, closeExceptionY
            Delay 600
            dm.LeftDoubleClick
            Delay 600
        End If
        If dm.GetColor(dialogX,dialogY) = dialogCR Then // 出现提示框，有人强退或网络错误
            dm.MoveTo closeDialogX, closeDialogY
            dm.LeftDoubleClick
            Delay 600 
        End If
    Loop
End Sub
// 人物操作、判断是否可以结算、或者游戏异常
Sub movePlayerOrGameOver(nowWindow)
    // 季后赛晋级次数
    promoteCount = 0
    Do While true 
        If playType &amp;lt;&amp;gt; 2 AND playType &amp;lt;&amp;gt; 5 Then 
            dm.MoveTo resetX, resetY
            dm.LeftClick
            Delay 500
            dm.KeyDown 37
            Delay 3000
            dm.KeyUp 37
            Delay 500
            dm.KeyPress 65
            Delay 800
            dm.KeyDown 68
            Delay 500
            dm.KeyUp 68
            Delay 600
            dm.KeyPress 83
            Delay 800
            dm.KeyDown 68
            Delay 600
            dm.KeyUp 68
            Delay 500
            Delay 8000
        End If
        // 需要投降
        If isPlayFail = 0 Then 
            // 按键操作发起投降
            Delay 2000
            dm.KeyPress 27
            Delay 1000
            dm.MoveTo 433, 471
            dm.LeftClick
            Delay 1000
            //确认投降
            dm.MoveTo 432, 464
            dm.LeftClick
            Delay 5000
            // 图片识别是否投降
            //            If playType = 2 Then 
            //                dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;3rdup.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.6,0,intX,intY)
            //                If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
            //                    //发起投降
            //                    dm.KeyPress 27
            //                    Delay 1000
            //                    dm.MoveTo 433, 471
            //                    dm.LeftClick
            //                    Delay 1000
            //                    //确认投降
            //                    dm.MoveTo 432, 464
            //                    dm.LeftClick
            //                    Delay 5000
            //                End If
            //            ElseIf playType &amp;lt;&amp;gt; 2 Then 
            //                dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;3rd.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.6,0,intX,intY)
            //                If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
            //                    //发起投降
            //                    dm.KeyPress 27
            //                    Delay 1000
            //                    dm.MoveTo 433, 471
            //                    dm.LeftClick
            //                    Delay 1000
            //                    //确认投降
            //                    dm.MoveTo 432, 464
            //                    dm.LeftClick
            //                    Delay 5000
            //                End If
            //            End If
        End If
        If playType = 5 Then // 巅峰季后赛
            text = &amp;quot;&amp;quot;
            // 比赛晋级
            dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;success.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
            If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                promoteCount = promoteCount + 1
                text = &amp;quot;巅峰季后赛晋级第&amp;quot;+ CStr(promoteCount) + &amp;quot;轮【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
                dm.MoveTo confirmX, confirmY
                Delay 600
                dm.LeftDoubleClick
                Delay 600
                If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; And promoteCount = maxPromoteCount Then
                    nowPlayNum = 0
                    playCount = 2
                    text = &amp;quot;巅峰季后赛晋级第&amp;quot; + Cstr(maxPromoteCount) +&amp;quot;轮【&amp;quot; + pcCode + &amp;quot;】，2局后自动结束脚本&amp;quot;
                    Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
                    objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
                    objXML.send
                    Delay 3000
                End If
            End If
            // 比赛淘汰
            dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;fail.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
            If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                promoteCount = 0
                nowPlayNum = 0
                text = &amp;quot;巅峰季后赛被淘汰【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
                dm.MoveTo confirmX, confirmY
                Delay 600
                dm.LeftDoubleClick
                Delay 600
            End If
            // 夺得冠军
            dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;success_top.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
            If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                promoteCount = 0
                nowPlayNum = playCount
                text = &amp;quot;巅峰季后赛夺冠军【&amp;quot; + pcCode +&amp;quot;】&amp;quot;
                dm.MoveTo confirmX, confirmY
                Delay 600
                dm.LeftDoubleClick
                Delay 600
            End If
            If msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; And text &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
                Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
                objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
                objXML.send
                Delay 3000
            End If
        End If
        //判断游戏是否结束
        If dm.GetColor(128,544) = &amp;quot;bb281e&amp;quot; Then
            // 点击返回或随机选择
            dm.MoveTo 468, 677
            dm.LeftDoubleClick
            Delay 5000
            // 判断是否可以随机选择奖品
            If dm.GetColor(468,677) &amp;lt;&amp;gt; &amp;quot;292a2c&amp;quot; Then
                // 点击返回或随机选择
                dm.MoveTo cancelX, cancelY
                dm.LeftDoubleClick
                Delay 5000
            End If
        End If
        // 判断是否可以点击返回大厅
        dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;zonglan.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
        If intX&amp;gt;0 and intY&amp;gt;0 Then  
            // 点击返回大厅
            dm.MoveTo 468, 677
            dm.LeftDoubleClick
            Delay 5000
        End If 
        // 判断游戏是否强制结束
        dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;exception.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
        If intX &amp;gt; 0 and intY &amp;gt; 0 Then 
            //点击确定
            dm.MoveTo closeExceptionX, closeExceptionY
            Delay 600
            dm.LeftDoubleClick
            Delay 5000  
        End If
        // 出现提示框
        If dm.GetColor(dialogX,dialogY) = dialogCR Then
            Delay 1500
            dm.MoveTo closeDialogX, closeDialogY
            dm.LeftDoubleClick 
        End If
        //误点处理
        dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;close.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
            dm.MoveTo 819, 72
            Delay 1000
            dm.LeftClick
            Delay 5000 
        End If
        dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2,&amp;quot;close2.bmp&amp;quot;,&amp;quot;000000&amp;quot;,0.8,0,intX,intY)
        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
            dm.MoveTo intX + 5, intY + 5
            Delay 1000
            dm.LeftDoubleClick
            Delay 5000 
        End If
        // 是否在大厅
        dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2, &amp;quot;play.bmp&amp;quot;, &amp;quot;000000&amp;quot;, 0.8, 0, intX, intY)
        If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
            Exit do
        End If
    Loop
    //已经返回大厅
    dm.MoveTo resetX,resetY
    dm.LeftDoubleClick
    Delay 1000
End Sub
Sub nbaService(nowWindow)
    Call cancelIndex(nowWindow)
    //已经进入游戏大厅，执行挂机脚本
    Delay 5000
    dm.MoveTo resetX, resetY
    Delay 1000
    dm.LeftDoubleClick
    Delay 1000
    If playType = 0 Then
        // 当前场数
        nowPlayNum = 1
        Do While true
            //点击play
            Do While true
                dm.MoveTo 514, 470
                Delay 500
                dm.LeftClick
                Delay 2000
                If dm.GetColor(128, 368) = &amp;quot;25162e&amp;quot; Then 
                    Exit Do
                End If
            Loop
            Do While true
                If dm.GetColor(128,368) = &amp;quot;25162e&amp;quot; Then
                    //点击人机对战
                    dm.MoveTo 85, 210
                    Delay 500
                    dm.LeftClick
                    Delay 1000
                    //点击街头赛
                    dm.MoveTo 197, 173
                    Delay 500
                    dm.LeftClick
                    Delay 1000
                    //进入比赛
                    dm.MoveTo 910, 361
                    Delay 1000
                    dm.LeftClick 
                    Delay 3000
                Else
                    Exit Do
                End If                
            Loop
            //判断是否进入游戏
            Call isPlayNow(nowWindow)
            Call startGameMsg(nowPlayNum, playCount, nowWindow)       
            Call movePlayerOrGameOver(nowWindow)
            If nowPlayNum&amp;gt;=playCount Then
                //当循环条件成立的时候，离开循环体
                Call getPrize(nowWindow)
                Exit do  
            End if  
            nowPlayNum=nowPlayNum+1  
        Loop
    ElseIf playType = 4 Then
        // 当前场数
        nowPlayNum = 1
        Do While true
            //点击play
            Do While true
                dm.MoveTo 514, 470
                Delay 500
                dm.LeftClick
                Delay 2000
                If dm.GetColor(128, 368) = &amp;quot;25162e&amp;quot; Then 
                    Exit Do
                End If
            Loop
            Do While true
                If dm.GetColor(128,368) = &amp;quot;25162e&amp;quot; Then
                    //点击经典对战
                    dm.MoveTo 85, 172
                    Delay 500
                    dm.LeftClick
                    Delay 1000
                    //点击街头赛
                    dm.MoveTo 197, 173
                    Delay 500
                    dm.LeftClick
                    Delay 1000
                    //单人匹配
                    dm.MoveTo 769, 361
                    Delay 1000
                    dm.LeftClick
                    Delay 3000
                    // 出现提示框，玩家被禁赛
                    If dm.GetColor(dialogX,dialogY) = dialogCR Then 
                        dm.MoveTo closeDialogX, closeDialogY
                        dm.LeftDoubleClick
                        Delay 600 
                    End If
                Else
                    Exit Do
                End If                
            Loop
            //判断游戏是否匹配成功
            Call waitPlay(nowWindow)
            //判断是否进入游戏
            Call isPlayNow(nowWindow)
            Call startGameMsg(nowPlayNum, playCount, nowWindow)       
            Call movePlayerOrGameOver(nowWindow)
            If nowPlayNum&amp;gt;=playCount Then
                //当循环条件成立的时候，离开循环体
                Call getPrize(nowWindow)
                Exit do  
            End if  
            nowPlayNum=nowPlayNum+1  
        Loop
    ElseIf playType = 5 Then
        // 当前场数
        nowPlayNum = 1
        // 不投降
        isPlayFail = 1
        Do While true
            //点击play
            Do While true
                dm.MoveTo 514, 470
                Delay 500
                dm.LeftClick
                Delay 2000
                If dm.GetColor(128, 368) = &amp;quot;25162e&amp;quot; Then 
                    Exit Do
                End If
            Loop
            Do While true
                If dm.GetColor(128, 368) = &amp;quot;25162e&amp;quot; Then 
                    // 点击人机对战
                    dm.MoveTo 85, 210
                    Delay 500
                    dm.LeftClick
                    Delay 1000
                    // 点击人机巅峰赛
                    dm.MoveTo 203, 209
                    Delay 500
                    dm.LeftClick
                    Delay 1000
                    // 进入比赛
                    dm.MoveTo 910, 361
                    Delay 1000
                    dm.LeftClick 
                    Delay 3000
                    // 失败点击重开赛季
                    dm.MoveTo 904, 645
                    Delay 1000
                    dm.LeftClick 
                    Delay 2000
                    // 首次点击选择球队
                    dm.MoveTo 904, 645
                    Delay 1000
                    dm.LeftClick 
                    Delay 2000
                    // 打开选择球队的页面，选择热火队
                    dm.MoveTo 767, 537
                    Delay 1000
                    dm.LeftClick 
                    Delay 2000
                    dm.MoveTo 379, 627
                    Delay 1000
                    dm.LeftClick 
                    Delay 2000
                    // 选择教练模式进入比赛
                    dm.MoveTo 904, 645
                    Delay 1000
                    dm.LeftClick 
                    Delay 5000
                    // 如果找到了关闭标志点击关闭
                    dm_ret = dm.FindPic(gameX1, gameY1, gameX2, gameY2, &amp;quot;close.bmp&amp;quot;, &amp;quot;000000&amp;quot;, 0.9, 0, intX, intY)
                    If intX &amp;gt; 0 And intY &amp;gt; 0 Then 
                        dm.MoveTo intX + 15, intY + 15
                        Delay 1000
                        LeftClick 1
                        Delay 1000
                    End If
                Else
                    Exit Do
                End If                
            Loop
            //判断是否进入游戏
            Call isPlayNow(nowWindow)
            Call startGameMsg(nowPlayNum, playCount, nowWindow)       
            Call movePlayerOrGameOver(nowWindow)
            If nowPlayNum&amp;gt;=playCount Then
                //当循环条件成立的时候，离开循环体
                Call getPrize(nowWindow)
                Exit do  
            End if  
            nowPlayNum=nowPlayNum+1  
        Loop 
    Else
        // 当前场数
        nowPlayNum = 1
        Do While true
            //点击play
            Do While true
                dm.MoveTo 514, 470
                Delay 500
                dm.LeftClick
                Delay 2000
                If dm.GetColor(128, 368) = &amp;quot;25162e&amp;quot; Then 
                    Exit Do
                End If
            Loop
            Do While true
                If dm.GetColor(128, 368) = &amp;quot;25162e&amp;quot; Then 
                    //点击经典对战
                    dm.MoveTo 85, 172
                    Delay 500
                    dm.LeftClick
                    Delay 1000
                    If playType = 1 Then  //点击NBA对抗赛
                        dm.MoveTo 198, 241
                        Delay 500
                        dm.LeftClick
                        Delay 1000
                    ElseIf playType = 2 Then  //点击教练模式
                        dm.MoveTo 198, 316
                        Delay 500
                        dm.LeftClick
                        Delay 1000
                    ElseIf playType = 3 Then  //点击王朝模式
                        dm.MoveTo 198, 208
                        Delay 500
                        dm.LeftClick
                        Delay 1000
                    ElseIf playType = 10 Then  //点击关键时刻
                        dm.MoveTo 198, 352
                        Delay 500
                        dm.LeftClick
                        Delay 1000
                    Else // 排位赛模式
                        dm.MoveTo 85, 250  //点击排位赛
                        Delay 500
                        dm.LeftClick
                        Delay 1000
                        If playType = 7 Then  
                            dm.MoveTo 198, 208  // 选择王朝模式
                            Delay 500
                            dm.LeftClick
                            Delay 1000
                        ElseIf playType = 8 Then  
                            // 选择NBA对抗赛
                            dm.MoveTo 198, 239  // 选择NBA对抗赛模式
                            Delay 500
                            dm.LeftClick
                            Delay 1000
                        ElseIf playType = 9 Then  
                            dm.MoveTo 198, 173 //点击街头赛
                            Delay 500
                            dm.LeftClick
                            Delay 1000
                        End If
                    End If
                    //开始匹配
                    dm.MoveTo 910, 361
                    Delay 1000
                    dm.LeftClick
                    Delay 3000
                    // 出现提示框，玩家被禁赛
                    If dm.GetColor(dialogX,dialogY) = dialogCR Then 
                        dm.MoveTo closeDialogX, closeDialogY
                        dm.LeftDoubleClick
                        Delay 600 
                    End If
                Else
                    Exit Do
                End If                
            Loop
            //判断游戏是否匹配成功
            Call waitPlay(nowWindow)
            //判断是否进入游戏
            Call isPlayNow(nowWindow)
            Call startGameMsg(nowPlayNum, playCount, nowWindow)       
            Call movePlayerOrGameOver(nowWindow)
            If nowPlayNum&amp;gt;=playCount Then
                //当循环条件成立的时候，离开循环体
                Call getPrize(nowWindow)
                Exit do  
            End if
            nowPlayNum=nowPlayNum+1  
        Loop
    End If
End Sub

&lt;/code&gt;&lt;/pre&gt;
">NBA2KOL辅助</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/f_ULKBziao/"" data-c="
          &lt;p&gt;&lt;strong&gt;窗体句柄&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vb&#34;&gt;//得到当前最前面的窗口句柄   
Hwnd = Plugin.Window.Foreground()
Rect = Plugin.Window.GetWindowRect(Hwnd)
MyArray = Split(Rect, &amp;quot;|&amp;quot;)
x = Clng(MyArray(0))
y = Clng(MyArray(1))//这里的(x,y)是窗口包含边框的左上角坐标，可用后台操作
MsgBox x
MsgBox y
Rect = Plugin.Window.GetClientRect(Hwnd)
MyArray = Split(Rect, &amp;quot;|&amp;quot;)
x = Clng(MyArray(0))
y = Clng(MyArray(1))//这里的(x,y)是窗口不含边框(称为客户区)的左上角坐标
MsgBox x
MsgBox y
//移动窗口到(X1, Y1)位置
Call Plugin.Window.Move(Hwnd, x, y)
//得到当前最前面的窗口句柄   
Hwnd = Plugin.Window.Foreground()
MsgBox &amp;quot;得到当前最前面的窗口句柄为：&amp;quot; &amp;amp; Hwnd
//得到窗口句柄的标题   
sText = Plugin.Window.GetTextEx(Hwnd, 0)
//得到窗口句柄的类名   
Class1 = Plugin.Window.GetClass(Hwnd)
MsgBox &amp;quot;得到窗口句柄的信息内容为：&amp;quot; &amp;amp; sText
MsgBox &amp;quot;得到窗口句柄的信息内容为：&amp;quot; &amp;amp; Class1
//移动窗口到(X1, Y1)位置   
Call Plugin.Window.Move(Hwnd, 800, 400)   
MsgBox &amp;quot;当前移动窗口到(800, 400)位置&amp;quot;
// 窗口句柄  根据类名和标题获取句柄
Hwnd = Plugin.Window.Find(Class1, sText)
MsgBox &amp;quot;得到当前最前面的窗口句柄为：&amp;quot;&amp;amp; Hwnd
//得到窗口句柄的边框大小(包括标题栏)   
sRect = Plugin.Window.GetWindowRect(Hwnd)   
MsgBox &amp;quot;得到窗口句柄的边框大小(包括标题栏)为：&amp;quot;&amp;amp; sRect   
//分割字符串,将横坐标和纵坐标分成两个字符串   
dim MyArray   
MyArray = Split(sRect, &amp;quot;|&amp;quot;)
//下面这句将字符串转换成数值   
W1 = Clng(MyArray(0)): H1 = Clng(MyArray(1))   
W2 = Clng(MyArray(2)): H2 = Clng(MyArray(3))   
MsgBox &amp;quot;边框大小：       &amp;quot;  &amp;amp;  W2-W1 &amp;amp; &amp;quot;             &amp;quot; &amp;amp; H2-H1  
//移动窗口到(X1, Y1)位置
Call Plugin.Window.Move(Hwnd, 200, 200)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;定时器&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vb&#34;&gt;While True
    CountdownID = BeginThread(Countdown(30)) //开启30秒倒计时线程
    //下面写你要执行的功能代码，这里我随便写一个,代码执行完后重新倒计时
    For i = 1 To 200
        TracePrint(&amp;quot;i的数值-------------------------------&amp;quot; &amp;amp; i &amp;amp; &amp;quot;&amp;quot;)
        Delay 500
    Next
    StopThread CountdownID //停止倒计时线程
Wend
Sub Countdown(t) //定义倒计时进程
    // 喵提醒参数
    playCountMiaoCode = &amp;quot;tOy90iP&amp;quot;
    msgMiaoCode = &amp;quot;tT48aX9&amp;quot;
    While t &amp;gt;= 0
        TracePrint(&amp;quot;剩下!!!!!!!!&amp;quot; &amp;amp; t &amp;amp; &amp;quot;秒&amp;quot;)
        Delay 1000
        If t = 0 AND msgMiaoCode &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then 
            TracePrint(&amp;quot;发通知了&amp;quot; )
            text = &amp;quot;比赛长时间未结束，请手动查看运行状态&amp;quot;
            Set objXML=CreateObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;)
            objXML.Open &amp;quot;Get&amp;quot;, &amp;quot;http://miaotixing.com/trigger?id=&amp;quot; + msgMiaoCode + &amp;quot;&amp;amp;text=&amp;quot; + text, False
            objXML.send
            Delay 3000
        End If
        t = t - 1
    Wend
End Sub
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;判断周几&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vb&#34;&gt;// 判断是否是周一、周二、周五
nowWeek = Weekday(now) - 1
If nowWeek &amp;gt; 0 and nowWeek &amp;lt; 3 or nowWeek = 5 Then
    MsgBox &amp;quot;周一、二、五&amp;quot;
Else 
    MsgBox &amp;quot;不是&amp;quot;
End If
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;批量修改窗口标题&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vb&#34;&gt;MyArray = Split(Plugin.Window.SearchEx(0, &amp;quot;NBA2K Online&amp;quot;, 0), &amp;quot;|&amp;quot;)
If UBound(MyArray)&amp;gt;=0 Then
    i=0
    For UBound(MyArray)
        Call Plugin.Window.SetText(MyArray(i),&amp;quot;NBA2K Onlie 篮球在线&amp;quot;)
        i=i+1
    Next
End If
MyArray = Split(Plugin.Window.SearchEx(0, &amp;quot;窗口-&amp;quot;, 0), &amp;quot;|&amp;quot;)
If UBound(MyArray)&amp;gt;=0 Then
    i=0
    For UBound(MyArray)
        Call Plugin.Window.SetText(MyArray(i),&amp;quot;NBA2K Onlie 篮球在线&amp;quot;)
        i=i+1
    Next
End If
//NBA2KHwnd = Plugin.Window.Find(&amp;quot;NBA2KONLINE_EXCLUSIVE_WND_CLASS_NAME&amp;quot;, 0)
//nbaWinText = Plugin.Window.GetText(NBA2KHwnd)
//TracePrint nbaWinText
//下面这句是按查找方式(模糊)，遍历符合窗口类名(0)且标题(&amp;quot;记事本&amp;quot;)的句柄，保存到数组(HwndEx)里
HwndEx = Plugin.Window.SearchEx(0,&amp;quot;窗口&amp;quot;,0) 
MsgBox &amp;quot;查找到符合的窗口句柄为：&amp;quot;&amp;amp; HwndEx
//下面这句用于分割字符串,将获得的句柄组分割
dim MyArray
MyArray = Split(HwndEx, &amp;quot;|&amp;quot;)
If UBound(MyArray)&amp;gt;=0 Then
    i=0
    For UBound(MyArray)
        Call Plugin.Window.SetText(MyArray(i),&amp;quot;NBA2K Onlie 篮球在线&amp;quot;)
        i=i+1
    Next
End If
//Call Plugin.Window.SetText(NBA2KHwnd,&amp;quot;窗口-1&amp;quot;)
//dm_ret = dm.BindWindowEx(NBA2KHwnd, displayMode, mouseMode, keypadMode, publicMode, 0)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;生成随机四位数&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vb&#34;&gt;Randomize
A = Array(0,1,2,3,4,5,6,7,8,9)
Num=a(Int(10*Rnd ))&amp;amp;a(Int(10*Rnd ))&amp;amp;a(Int(10*Rnd ))&amp;amp;a(Int(10*Rnd ))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;时间判断&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vb&#34;&gt;If Hour(time) &amp;gt;= 0 and Hour(time)&amp;lt; 2
    MsgBox &amp;quot;挂大号&amp;quot;
Else
    MsgBox &amp;quot;挂小号&amp;quot;
End If

EndScript

// 系统时间 在10：10分到22：00分之间。运行脚本A,22点07分到凌晨两点之间，运行 脚本B
If Hour(time) &amp;gt;= 10 and Hour(time)&amp;lt;22
    If Hour(time) = 10 and Minute(time)&amp;gt;=10
        call a()
    ElseIf Hour(time) &amp;gt; 10 then
        call a()
    End If
ElseIf Hour(time)&amp;gt;=22
    If Hour(time)=22 and Minute(time)&amp;gt;=7
        call b()
    ElseIf Hour(time)&amp;gt;22
        call b()
    End If
End If
Sub a()
    MessageBox &amp;quot;运行A&amp;quot;
End Sub
Sub b()
    MessageBox &amp;quot;运行B&amp;quot;
End Sub
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;HTTP请求&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-vb&#34;&gt;Dim reqUrl，reqType，reqCode，resultData
reqUrl = &amp;quot;http://rap2api.taobao.org/app/mock/322147/nba2kol/customize&amp;quot;
reqType = &amp;quot;GET&amp;quot;
reqCode = &amp;quot;UTF-8&amp;quot;
reqResult = Plugin.SMWH.WinHttp(reqUrl, reqType, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, reqCode)
TracePrint reqResult
resultData0 = Plugin.SMWH.GetJSON(reqResult, &amp;quot;playType&amp;quot;)
resultData1 = Plugin.SMWH.GetJSON(reqResult, &amp;quot;playCount&amp;quot;)
resultData2 = Plugin.SMWH.GetJSON(reqResult, &amp;quot;isPlayFail&amp;quot;)
resultData3 = Plugin.SMWH.GetJSON(reqResult, &amp;quot;isGetPrize&amp;quot;)
resultData4 = Plugin.SMWH.GetJSON(reqResult, &amp;quot;isGoPlay&amp;quot;)
resultData5 = Plugin.SMWH.GetJSON(reqResult, &amp;quot;isExitOS&amp;quot;)
TracePrint resultData0
TracePrint resultData1
TracePrint resultData2
TracePrint resultData3
TracePrint resultData4
TracePrint resultData5

EndScript
// POST请求
Dim 网址2, 访问方式2, 提交信息2, 附加协议头2, 网页编码2, 返回值2
网址2 = &amp;quot;http://localhost:80/api8&amp;quot;
访问方式2 = &amp;quot;POST&amp;quot;
提交信息2 = jsonFormatter(&amp;quot;a=酷玩&amp;amp;b=蚊仔&amp;quot;)
附加协议头2 = &amp;quot;CONTENT-TYPE:application/json&amp;quot;
网页编码2 = &amp;quot;UTF-8&amp;quot;
返回值2 = SMWH.WinHttp(网址2, 访问方式2, 提交信息2, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, 附加协议头2, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, 网页编码2)
TracePrint 返回值2
&lt;/code&gt;&lt;/pre&gt;
">按键精灵方法合集</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/iGmJlvMSWw/"" data-c="
          &lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.example.demo;

import java.io.BufferedReader;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

@RunWith(SpringRunner.class)
@SpringBootTest
public class DemoApplicationTests {

	@Test
	public static void main(String[] args) {
        String inputFilePath = &amp;quot;D:\\题库.txt&amp;quot;;
        String outputFilePath = &amp;quot;D:\\题库.xlsx&amp;quot;;
        try {
            List&amp;lt;Question&amp;gt; questions = parseTxtFile(inputFilePath);
            createExcelFile(questions, outputFilePath);
            System.out.println(&amp;quot;转换成功！生成文件: &amp;quot; + outputFilePath);
        } catch (IOException e) {
            System.err.println(&amp;quot;处理文件时出错: &amp;quot; + e.getMessage());
        }
    }

    private static List&amp;lt;Question&amp;gt; parseTxtFile(String filePath) throws IOException {
        List&amp;lt;Question&amp;gt; questions = new ArrayList&amp;lt;&amp;gt;();
        
        InputStream inputStream=new FileInputStream(filePath);
        BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream,&amp;quot;UTF-8&amp;quot;));
        
        String line;
        Question currentQuestion = null;
        
        while ((line = reader.readLine()) != null) {
            line = line.trim();
            if (line.startsWith(&amp;quot;题干：&amp;quot;)) {
                // 新题目开始
                if (currentQuestion != null) {
                    questions.add(currentQuestion);
                }
                currentQuestion = new Question();
                currentQuestion.setQuestion(line.substring(3).trim());
            } else if (line.startsWith(&amp;quot;A：&amp;quot;)) {
                currentQuestion.setOptionA(line.substring(2).trim());
            } else if (line.startsWith(&amp;quot;B：&amp;quot;)) {
                currentQuestion.setOptionB(line.substring(2).trim());
            } else if (line.startsWith(&amp;quot;C：&amp;quot;)) {
                currentQuestion.setOptionC(line.substring(2).trim());
            } else if (line.startsWith(&amp;quot;D：&amp;quot;)) {
                currentQuestion.setOptionD(line.substring(2).trim());
            } else if (line.startsWith(&amp;quot;E：&amp;quot;)) {
                currentQuestion.setOptionE(line.substring(2).trim());
            } else if (line.startsWith(&amp;quot;F：&amp;quot;)) {
                currentQuestion.setOptionF(line.substring(2).trim());
            } else if (line.startsWith(&amp;quot;G：&amp;quot;)) {
                currentQuestion.setOptionG(line.substring(2).trim());
            } else if (line.startsWith(&amp;quot;答案：&amp;quot;)) {
                currentQuestion.setAnswer(line.substring(3).trim());
            } else if (line.startsWith(&amp;quot;题目解析：&amp;quot;)) {
                currentQuestion.setAnalysis(line.substring(5).trim());
            } else if (line.startsWith(&amp;quot;题目类型：&amp;quot;)) {
                currentQuestion.setQuestionType(line.substring(5).trim());
            }
        }
        
        // 添加最后一个问题
        if (currentQuestion != null) {
            questions.add(currentQuestion);
        }
        
        reader.close();
        return questions;
    }

    private static void createExcelFile(List&amp;lt;Question&amp;gt; questions, String filePath) throws IOException {
        Workbook workbook = new XSSFWorkbook();
        Sheet sheet = workbook.createSheet(&amp;quot;题库&amp;quot;);
        // 创建表头
        Row headerRow = sheet.createRow(0);
        String[] headers = {&amp;quot;题目&amp;quot;, &amp;quot;选项A&amp;quot;, &amp;quot;选项B&amp;quot;, &amp;quot;选项C&amp;quot;, &amp;quot;选项D&amp;quot;,&amp;quot;选项E&amp;quot;,&amp;quot;选项F&amp;quot;,&amp;quot;选项G&amp;quot;, &amp;quot;答案&amp;quot;, &amp;quot;题目解析&amp;quot;,&amp;quot;题目类型&amp;quot;};
        for (int i = 0; i &amp;lt; headers.length; i++) {
            Cell cell = headerRow.createCell(i);
            cell.setCellValue(headers[i]);
        }
        // 填充数据
        int rowNum = 1;
        for (Question q : questions) {
            Row row = sheet.createRow(rowNum++);
            row.createCell(0).setCellValue(q.getQuestion());
            row.createCell(1).setCellValue(q.getOptionA());
            row.createCell(2).setCellValue(q.getOptionB());
            row.createCell(3).setCellValue(q.getOptionC());
            row.createCell(4).setCellValue(q.getOptionD());
            row.createCell(5).setCellValue(q.getOptionE());
            row.createCell(6).setCellValue(q.getOptionF());
            row.createCell(7).setCellValue(q.getOptionG());
            row.createCell(8).setCellValue(q.getAnswer());
            row.createCell(9).setCellValue(q.getAnalysis());
            row.createCell(10).setCellValue(q.getQuestionType());
        }
        
        // 自动调整列宽
        for (int i = 0; i &amp;lt; headers.length; i++) {
            sheet.autoSizeColumn(i);
        }
        
        // 写入文件
        try (FileOutputStream outputStream = new FileOutputStream(filePath)) {
            workbook.write(outputStream);
        }
        workbook.close();
    }

    static class Question {
        private String question;
        private String optionA;
        private String optionB;
        private String optionC;
        private String optionD;
        private String optionE;
        private String optionF;
        private String optionG;
        private String answer;
        private String analysis;
        private String questionType;
        // 省略getter和setter方法
        public String getQuestion() { return question; }
        public void setQuestion(String question) { this.question = question; }
        public String getOptionA() { return optionA; }
        public void setOptionA(String optionA) { this.optionA = optionA; }
        public String getOptionB() { return optionB; }
        public void setOptionB(String optionB) { this.optionB = optionB; }
        public String getOptionC() { return optionC; }
        public void setOptionC(String optionC) { this.optionC = optionC; }
        public String getOptionD() { return optionD; }
        public void setOptionD(String optionD) { this.optionD = optionD; }
        public String getOptionE() { return optionE; }
        public void setOptionE(String optionE) { this.optionE = optionE; }
        public String getOptionF() { return optionF; }
        public void setOptionF(String optionF) { this.optionF = optionF; }
        public String getOptionG() { return optionG; }
        public void setOptionG(String optionG) { this.optionG = optionG; }
        public String getAnswer() { return answer; }
        public void setAnswer(String answer) { this.answer = answer; }
        public String getAnalysis() { return analysis; }
        public void setAnalysis(String analysis) { this.analysis = analysis; }
        public String getQuestionType() { return questionType; }
        public void setQuestionType(String questionType) { this.questionType = questionType; }
    }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package test;
/**
 * JSON转TXT文本：睿达一点通小程序
 */
import java.io.FileWriter;
import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.Map;

import com.alibaba.fastjson2.JSON;
import com.alibaba.fastjson2.JSONArray;
import com.alibaba.fastjson2.JSONObject;

public class JsonTest {

	public static void jsonLoop(Object object) {
		if (object instanceof JSONObject) {
			JSONObject jsonObject = (JSONObject) object;
			for (Map.Entry&amp;lt;String, Object&amp;gt; entry : jsonObject.entrySet()) {
				Object o = entry.getValue();
				String questionType = &amp;quot;&amp;quot;;
				String description = &amp;quot;&amp;quot;;
				String option = &amp;quot;&amp;quot;;
				String answer = &amp;quot;&amp;quot;;
				String analysis = &amp;quot;&amp;quot;;
					switch (entry.getKey().toString()) {
					case &amp;quot;type&amp;quot;:
						if (!entry.getValue().equals(&amp;quot;&amp;quot;)) {
							switch (Integer.parseInt(entry.getValue().toString())) {
							case 1:
								questionType = &amp;quot;题目类型：单选题&amp;quot; + &amp;quot;\n&amp;quot;;
								break;
							case 2:
								questionType = &amp;quot;题目类型：多选题&amp;quot; + &amp;quot;\n&amp;quot;;
								break;	
							case 3:
								questionType = &amp;quot;题目类型：判断题&amp;quot; + &amp;quot;\n&amp;quot;;
								break;
				            case 4:
				            	questionType = &amp;quot;题目类型：序号四&amp;quot; + &amp;quot;\n&amp;quot;;
								break;
				            case 5:
				            	questionType = &amp;quot;题目类型：序号五&amp;quot; + &amp;quot;\n&amp;quot;;
								break;
							}
						}
						break;
					case &amp;quot;description&amp;quot;:
						if (!entry.getValue().equals(&amp;quot;&amp;quot;)) {
							description += &amp;quot;题干：&amp;quot; + entry.getValue().toString() + &amp;quot;\n&amp;quot;;
						}
						break;
					case &amp;quot;option&amp;quot;:
						if (!entry.getValue().equals(&amp;quot;&amp;quot;)) {
							JSONObject jsonObject2 = JSONObject.parseObject(entry.getValue().toString());
					        for (Map.Entry&amp;lt;String, Object&amp;gt; entry2 : jsonObject2.entrySet()) {
					            switch (entry2.getKey().toString()) {
								case &amp;quot;a&amp;quot;:
									if (!entry2.getValue().equals(&amp;quot;&amp;quot;)) {
										option += &amp;quot;A：&amp;quot; + entry2.getValue().toString() + &amp;quot;\n&amp;quot;;
									}
									break;
								case &amp;quot;b&amp;quot;:
									if (!entry2.getValue().equals(&amp;quot;&amp;quot;)) {
										option += &amp;quot;B：&amp;quot; + entry2.getValue().toString() + &amp;quot;\n&amp;quot;;
									}
									break;	
								case &amp;quot;c&amp;quot;:
									if (!entry2.getValue().equals(&amp;quot;&amp;quot;)) {
										option += &amp;quot;C：&amp;quot; + entry2.getValue().toString() + &amp;quot;\n&amp;quot;;
									}
									break;
								
					            case &amp;quot;d&amp;quot;:
									if (!entry2.getValue().equals(&amp;quot;&amp;quot;)) {
										option += &amp;quot;D：&amp;quot; + entry2.getValue().toString() + &amp;quot;\n&amp;quot;;
									}
									break;
					            case &amp;quot;e&amp;quot;:
									if (!entry2.getValue().equals(&amp;quot;&amp;quot;)) {
										option += &amp;quot;E：&amp;quot; + entry2.getValue().toString() + &amp;quot;\n&amp;quot;;
									}
									break;
					            case &amp;quot;f&amp;quot;:
									if (!entry2.getValue().equals(&amp;quot;&amp;quot;)) {
										option += &amp;quot;F：&amp;quot; + entry2.getValue().toString() + &amp;quot;\n&amp;quot;;
									}
									break;
					            case &amp;quot;g&amp;quot;:
									if (!entry2.getValue().equals(&amp;quot;&amp;quot;)) {
										option += &amp;quot;G：&amp;quot; + entry2.getValue().toString() + &amp;quot;\n&amp;quot;;
									}
									break;
					            case &amp;quot;panduan&amp;quot;:
										option += &amp;quot;A：\n&amp;quot;;
										option += &amp;quot;B：\n&amp;quot;;
										option += &amp;quot;C：\n&amp;quot;;
										option += &amp;quot;D：\n&amp;quot;;
										option += &amp;quot;E：\n&amp;quot;;
										option += &amp;quot;F：\n&amp;quot;;
										option += &amp;quot;G：\n&amp;quot;;
									break;
								}
					            
					        }
						}
						break;	
					case &amp;quot;answer&amp;quot;:
						if (!entry.getValue().equals(&amp;quot;&amp;quot;)) {
							JSONObject jsonObject2 = JSONObject.parseObject(entry.getValue().toString());
					        for (Map.Entry&amp;lt;String, Object&amp;gt; entry2 : jsonObject2.entrySet()) {
					            switch (entry2.getKey().toString()) {
								case &amp;quot;answer&amp;quot;:
									if (!entry2.getValue().equals(&amp;quot;&amp;quot;)) {
										answer += &amp;quot;答案：&amp;quot; + entry2.getValue().toString().replaceAll(&amp;quot;[^a-zA-Z]&amp;quot;, &amp;quot;&amp;quot;).toUpperCase() + &amp;quot;\n&amp;quot;;
									}
									break;
								case &amp;quot;analysis&amp;quot;:
									if (!entry2.getValue().equals(&amp;quot;&amp;quot;)) {
										analysis += &amp;quot;题目解析：&amp;quot; + entry2.getValue().toString() + &amp;quot;\n&amp;quot;;
									}
									break;	
								}
					        }
						}
						break;
					}
					try {
						// 创建FileWriter对象，指定文件路径和是否追加内容
						FileWriter writer = new FileWriter(&amp;quot;D:\\题库.txt&amp;quot;, true); // 第二个参数为true表示追加内容
						writer.write(questionType + description + option + answer + analysis); // 写入数据ExcelTool.java
						writer.close(); // 关闭流
					} catch (IOException e) {
						e.printStackTrace();
					}
				if (o instanceof String) {
						
					
				} else {
					jsonLoop(o);
				}
			}
		}
		if (object instanceof JSONArray){
			JSONArray jsonArray = (JSONArray) object;
			for (int i = 0; i &amp;lt; jsonArray.size(); i++) {
				jsonLoop(jsonArray.get(i));
			}
		}
	}

	public static void main(String[] args) throws IOException {
		String jsonStr = new String(Files.readAllBytes(Paths.get(&amp;quot;D:\\题库.json&amp;quot;)), StandardCharsets.UTF_8);
		JSONObject jsonObject = JSON.parseObject(jsonStr);
		//JSONArray jsonArray = JSONArray.parseArray(jsonStr);
		jsonLoop(jsonObject);
		System.err.println(&amp;quot;读取完成&amp;quot;);
	}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package test;

/**
 * JSON转TXT文本：易知课堂网页端
 */
import java.io.FileWriter;
import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.Map;

import com.alibaba.fastjson2.JSON;
import com.alibaba.fastjson2.JSONArray;
import com.alibaba.fastjson2.JSONObject;

public class JsonTest2 {

	public static void jsonLoop(Object object) {
		if (object instanceof JSONObject) {
			JSONObject jsonObject = (JSONObject) object;
			for (Map.Entry&amp;lt;String, Object&amp;gt; entry : jsonObject.entrySet()) {
				Object o = entry.getValue();
				//System.err.println(entry.getKey());
				String questionType = &amp;quot;&amp;quot;;
				String description = &amp;quot;&amp;quot;;
				String option = &amp;quot;&amp;quot;;
				String answer = &amp;quot;&amp;quot;;
				String analysis = &amp;quot;&amp;quot;;
					switch (entry.getKey().toString()) {
					case &amp;quot;question_type&amp;quot;:
						if (!entry.getValue().equals(&amp;quot;&amp;quot;)) {
							switch (Integer.parseInt(entry.getValue().toString())) {
							case 1:
								questionType = &amp;quot;题目类型:单选题&amp;quot; + &amp;quot;\n&amp;quot;;
								break;
							case 2:
								questionType = &amp;quot;题目类型:多选题&amp;quot; + &amp;quot;\n&amp;quot;;
								break;	
							case 3:
								questionType = &amp;quot;题目类型:判断题&amp;quot; + &amp;quot;\n&amp;quot;;
								break;
				            case 4:
				            	questionType = &amp;quot;题目类型:序号四&amp;quot; + &amp;quot;\n&amp;quot;;
								break;
				            case 5:
				            	questionType = &amp;quot;题目类型:序号五&amp;quot; + &amp;quot;\n&amp;quot;;
								break;
							}
						}
						break;
					case &amp;quot;question&amp;quot;:
						if (!entry.getValue().equals(&amp;quot;&amp;quot;)) {
							System.err.println(entry.getValue().toString());
							description += &amp;quot;题干:&amp;quot; + entry.getValue().toString() + &amp;quot;\n&amp;quot;;
						}
						break;
					case &amp;quot;options&amp;quot;:
						if (!entry.getValue().equals(&amp;quot;&amp;quot;)) {
							JSONArray jsonArray = JSONArray.parseArray(entry.getValue().toString());
								for (int i = 0; i &amp;lt; jsonArray.size(); i++) {
						            switch (i) {
						            
									case 0:
										if (!jsonArray.get(i).equals(&amp;quot;&amp;quot;)) {
											JSONObject optionObject = JSONObject.parseObject(jsonArray.get(i).toString());
											String optionTxt = optionObject.get(&amp;quot;option&amp;quot;).toString();
											option += &amp;quot;A.&amp;quot; + optionTxt.toString() + &amp;quot;\n&amp;quot;;
											Integer isRight = (Integer) optionObject.get(&amp;quot;is_right&amp;quot;);
											if (isRight == 1) {
												answer += &amp;quot;正确答案:A&amp;quot;+ &amp;quot;\n&amp;quot;;
											}
										}
										break;
									case 1:
										if (!jsonArray.get(i).equals(&amp;quot;&amp;quot;)) {
											JSONObject optionObject = JSONObject.parseObject(jsonArray.get(i).toString());
											String optionTxt = optionObject.get(&amp;quot;option&amp;quot;).toString();
											option += &amp;quot;B.&amp;quot; + optionTxt.toString() + &amp;quot;\n&amp;quot;;
											Integer isRight = (Integer) optionObject.get(&amp;quot;is_right&amp;quot;);
											if (isRight == 1) {
												answer += &amp;quot;正确答案:B&amp;quot;+ &amp;quot;\n&amp;quot;;
											}
										}
										break;	
									case 2:
										if (!jsonArray.get(i).equals(&amp;quot;&amp;quot;)) {
											JSONObject optionObject = JSONObject.parseObject(jsonArray.get(i).toString());
											String optionTxt = optionObject.get(&amp;quot;option&amp;quot;).toString();
											option += &amp;quot;C.&amp;quot; + optionTxt.toString() + &amp;quot;\n&amp;quot;;
											Integer isRight = (Integer) optionObject.get(&amp;quot;is_right&amp;quot;);
											if (isRight == 1) {
												answer += &amp;quot;正确答案:C&amp;quot;+ &amp;quot;\n&amp;quot;;
											}
										}
										break;
									case 3:
										if (!jsonArray.get(i).equals(&amp;quot;&amp;quot;)) {
											JSONObject optionObject = JSONObject.parseObject(jsonArray.get(i).toString());
											String optionTxt = optionObject.get(&amp;quot;option&amp;quot;).toString();
											option += &amp;quot;D.&amp;quot; + optionTxt.toString() + &amp;quot;\n&amp;quot;;
											Integer isRight = (Integer) optionObject.get(&amp;quot;is_right&amp;quot;);
											if (isRight == 1) {
												answer += &amp;quot;正确答案:D&amp;quot;+ &amp;quot;\n&amp;quot;;
											}
										}
										break;
									case 4:
										if (!jsonArray.get(i).equals(&amp;quot;&amp;quot;)) {
											JSONObject optionObject = JSONObject.parseObject(jsonArray.get(i).toString());
											String optionTxt = optionObject.get(&amp;quot;option&amp;quot;).toString();
											option += &amp;quot;E.&amp;quot; + optionTxt.toString() + &amp;quot;\n&amp;quot;;
											Integer isRight = (Integer) optionObject.get(&amp;quot;is_right&amp;quot;);
											if (isRight == 1) {
												answer += &amp;quot;正确答案:E&amp;quot;+ &amp;quot;\n&amp;quot;;
											}
										}
										break;
									case 5:
										if (!jsonArray.get(i).equals(&amp;quot;&amp;quot;)) {
											JSONObject optionObject = JSONObject.parseObject(jsonArray.get(i).toString());
											String optionTxt = optionObject.get(&amp;quot;option&amp;quot;).toString();
											option += &amp;quot;F.&amp;quot; + optionTxt.toString() + &amp;quot;\n&amp;quot;;
											Integer isRight = (Integer) optionObject.get(&amp;quot;is_right&amp;quot;);
											if (isRight == 1) {
												answer += &amp;quot;正确答案:F&amp;quot;+ &amp;quot;\n&amp;quot;;
											}
										}
										break;
								}
								}
						}
						break;	
					case &amp;quot;office_explain&amp;quot;:
						if (!entry.getValue().equals(&amp;quot;&amp;quot;)) {
							analysis += &amp;quot;解题思路:&amp;quot; + entry.getValue().toString() + &amp;quot;\n&amp;quot;;
						}
						break;
					}
					try {
						// 创建FileWriter对象，指定文件路径和是否追加内容
						FileWriter writer = new FileWriter(&amp;quot;D:\\题库.txt&amp;quot;, true); // 第二个参数为true表示追加内容
						writer.write(description + option + answer + analysis + questionType); // 写入数据ExcelTool.java
						writer.close(); // 关闭流
					} catch (IOException e) {
						e.printStackTrace();
					}
				if (o instanceof String) {
						
					
				} else {
					jsonLoop(o);
				}
			}
		}
		if (object instanceof JSONArray){
			JSONArray jsonArray = (JSONArray) object;
			for (int i = 0; i &amp;lt; jsonArray.size(); i++) {
				jsonLoop(jsonArray.get(i));
			}
		}
	}

	public static void main(String[] args) throws IOException {
		String jsonStr = new String(Files.readAllBytes(Paths.get(&amp;quot;D:\\题库.json&amp;quot;)), StandardCharsets.UTF_8);
		JSONObject jsonObject = JSON.parseObject(jsonStr);
		//JSONArray jsonArray = JSONArray.parseArray(jsonStr);
		jsonLoop(jsonObject);
		System.err.println(&amp;quot;读取完成&amp;quot;);
	}
}
&lt;/code&gt;&lt;/pre&gt;
">JSON数据解析</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/6GTKKzFzwX/"" data-c="
          &lt;p&gt;常用的抓包工具有fiddler、wireshark、httpwatch、 firebug、F12/等。抓包抓的是协议，fiddler抓的是HTTP、HTTPS协议，wireshark抓的是其他协议。fiddler、wireshark可以修改接口的参数和返回值，常用的F12调试工具只可以查看接口的参数和响应值。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;fiddler最适合，在APP测试的时候抓包；&lt;/li&gt;
&lt;li&gt;wireshare适合对整个流量进行抓取；&lt;/li&gt;
&lt;li&gt;burpsuite最大的特点是抓包改包&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;0x01 Fiddler原理&lt;/p&gt;
&lt;p&gt;Fiddler是以代理WEB服务器的形式工作的,浏览器与服务器之间通过建立TCP连接以HTTP协议进行通信，浏览器默认通过自己发送HTTP请求到服务器，它使用代理地址:127.0.0.1, 端口:8888. 当Fiddler开启会自动设置代理， 退出的时候它会自动注销代理，这样就不会影响别的程序。不过如果Fiddler非正常退出，这时候因为Fiddler没有自动注销，会造成网页无法访问。解决的办法是重新启动下Fiddler.&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://pic4.zhimg.com/v2-29d858f306b6578800a52f13220d91df.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;0X02 安装应用&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1.下载最新版Fiddler,强烈建议在官网下载：&lt;/strong&gt; &lt;a href=&#34;https://www.telerik.com/download/fiddler&#34;&gt;https://www.telerik.com/download/fiddler&lt;/a&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://pica.zhimg.com/v2-818c2e99407df6dee549c6a6ccd89fe5.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;2. 正常傻瓜式安装，&lt;/strong&gt;&lt;br&gt;
下一步，下一步，安装完毕后，先不用急于打开软件。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3.下载并安装Fiddler证书生成器：&lt;/strong&gt;&lt;br&gt;
&lt;a href=&#34;http://www.telerik.com/docs/default-source/fiddler/addons/fiddlercertmaker.exe?sfvrsn=2&#34;&gt;http://www.telerik.com/docs/default-source/fiddler/addons/fiddlercertmaker.exe?sfvrsn=2&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4.打开Fiddler进行设置&lt;/strong&gt;&lt;br&gt;
点击工具栏中的Tools—&amp;gt;Options&lt;br&gt;
&lt;img src=&#34;https://pica.zhimg.com/v2-944cfb36644f2f8bcb610864932d60f9.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;5、点击HTTPS&lt;/strong&gt;，勾选Decrypt HTTPS traffic和Ignore server certificate(unsafe)&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://pica.zhimg.com/v2-47e48cf1e3ad4d65c64aaad687761281.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;6、点击Actions&lt;/strong&gt;，点击Export Root Certificate to Desktop&lt;br&gt;
&lt;img src=&#34;https://picx.zhimg.com/v2-138c9b211fa3f2d0c6f5558075de60e5.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;【注】此时电脑上会生成 一个证书&lt;br&gt;
&lt;img src=&#34;https://picx.zhimg.com/v2-161e1e27cf9e3bae927816a4619dfbf8.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;7、https设置及connections设置，勾选选择项&lt;/strong&gt;&lt;br&gt;
&lt;img src=&#34;https://pic4.zhimg.com/v2-37d7a7446fb79028b5aed8342631e540.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://pic4.zhimg.com/v2-47a617e194e998e3a53c678c35408457.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;8、安装雷电模拟器&lt;/strong&gt;&lt;br&gt;
&lt;strong&gt;&lt;a href=&#34;https://cloud.tencent.com/developer/tools/blog-entry?target=https%3A%2F%2Fwww.ldmnq.com%2F&amp;amp;objectId=2220183&amp;amp;objectType=1&amp;amp;isNewArticle=undefined&#34;&gt;https://www.ldmnq.com/&lt;/a&gt;&lt;/strong&gt;&lt;br&gt;
&lt;img src=&#34;https://pica.zhimg.com/v2-7f3df1de8ebb49c15fe5aac8edb2c72b.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;9、安装好后，桌面双击打开雷电模拟器，点击设置&lt;/strong&gt;&lt;br&gt;
&lt;img src=&#34;https://pic1.zhimg.com/v2-d9399fda5ed5bdd1f06b5724d6c0012f.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;10、安装好后，桌面双击打开雷电模拟器，点击设置&lt;/strong&gt;&lt;br&gt;
&lt;img src=&#34;https://pic2.zhimg.com/v2-01720ff7a5e9688e640dcf484527ec78.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;11、选择网络设置，勾选桥接模式，点击安装驱动，点击确定，点击保存设置&lt;/strong&gt;&lt;br&gt;
&lt;img src=&#34;https://picx.zhimg.com/v2-2619bf596e95737a83ec515bb17aa04d.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://picx.zhimg.com/v2-0eb44e88e233c3e908146492f242afff.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://pic2.zhimg.com/v2-aae8ba9e2156363c42a973c4301a8d69.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;12、打开模拟器，设置代理。找到系统应用，点击设置，点击无线网络WLAN—&amp;gt;左键常按点击已连接网络—&amp;gt;修改网络&lt;/strong&gt;&lt;br&gt;
&lt;img src=&#34;https://pic2.zhimg.com/v2-f137773a12e8aad39cd92e03171eb74b.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://picx.zhimg.com/v2-d102e0bd6cbf042f624e320fde332386.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://pic2.zhimg.com/v2-5dbd5bf7cc1c4428b4adb9088c113f27.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://pic4.zhimg.com/v2-4c3789c6e4c839ee62daa65425d9c0b1.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://pic2.zhimg.com/v2-a2fd6b69bf6dd9f34bad9f9d8bd232ca.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;11&#34;&gt;&lt;img src=&#34;https://pic2.zhimg.com/v2-6b3643e0c07ec6ce1a1d6416301cafda.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;12&#34;&gt;&lt;img src=&#34;https://pic3.zhimg.com/v2-0d15e57d61ee21a8adaac7704c502604.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;13&#34;&gt;&lt;img src=&#34;https://pic4.zhimg.com/v2-beebb48cbf01f356d5d3c782bc7b56c0.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;13、将步骤6导出的证书FiddlerRoot.cer文件导入至模拟器&lt;/strong&gt;&lt;br&gt;
&lt;img src=&#34;https://picx.zhimg.com/v2-7bafb2d0fd203e0ca182c47b01632b7d.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;14&#34;&gt;&lt;img src=&#34;https://pic1.zhimg.com/v2-535b8ade670dd3f3a23f8b30b3aae57b.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;15&#34;&gt;&lt;img src=&#34;https://pic4.zhimg.com/v2-0e973e558369b0b9291368db1a47e57c.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;16&#34;&gt;&lt;img src=&#34;https://pic2.zhimg.com/80/v2-66b542d2b73ecfda2b9cec91015d851d_720w.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;17&#34;&gt;&lt;img src=&#34;https://pic1.zhimg.com/v2-15af09b0c642d020a1df44d1a078be23.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;18&#34;&gt;&lt;img src=&#34;https://pic3.zhimg.com/v2-34ff90ae2e0223b72225d1f2276ce03b.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;点击完成导入&lt;/strong&gt;&lt;br&gt;
&lt;img src=&#34;https://pic4.zhimg.com/80/v2-813f0bddca2c3e800601a22648fa9779_720w.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;14、在模拟器中打开系统应用—&amp;gt;设置—&amp;gt;安全—&amp;gt;从SD卡安装。找到FiddlerRoot.cer文件，按提示导入即可，注意在此过程需要名称和解锁图案等，自行即可&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;设置-安全-为证书命名&lt;br&gt;
&lt;img src=&#34;https://pic2.zhimg.com/v2-0cdf732cae8b7af78b9cdf878b36b29b.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;19&#34;&gt;&lt;img src=&#34;https://pic1.zhimg.com/v2-44e0b0bea0d1d2b89209c9da74190d91.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;20&#34;&gt;&lt;img src=&#34;https://pic1.zhimg.com/v2-df0a4aff604bd4014e5ae55c51a2fa35.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;21&#34;&gt;&lt;img src=&#34;https://picx.zhimg.com/80/v2-9b11467ff0fe2a9c8de145af2b444f6f_720w.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;22&#34;&gt;&lt;img src=&#34;https://picx.zhimg.com/v2-c3e3a4c25196b1920ec4a12656eb7a0c.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;或者另一种方法安装证书：&lt;br&gt;
在雷电模拟器里打开浏览器，访问刚才设置的本机IP加端口，便可自动下载证书进行安装&lt;br&gt;
流程如下&lt;br&gt;
手机端(客户端)设置&lt;br&gt;
保证Fiddler和手机在同一局域网下，设置手机代理服务器地址为Fiddler服务器地址即可。&lt;br&gt;
&lt;img src=&#34;https://pic4.zhimg.com/80/v2-61bf7429b9e899dfe256c90757908205_720w.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;设置代理服务器&lt;br&gt;
当使用https协议时，需要下载证书(根据需要)&lt;br&gt;
在手机浏览器访问Fiddler服务器—下载证书—安装证书（设置→安全→凭据存储→从sd卡安装）&lt;br&gt;
&lt;img src=&#34;https://pic1.zhimg.com/v2-e3d89d7680122c38f9d3c29172192fb6.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;下载证书&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;15、打开fiddler，重启模拟器，输入设置的密码，按回车键，打开需要抓包的APP，就可以在电脑上进行APP抓包了&lt;/strong&gt;&lt;br&gt;
&lt;img src=&#34;https://picx.zhimg.com/v2-c407729b4dbbc40e6e2985ed5ac74977.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;常用图标含义&lt;/strong&gt;&lt;br&gt;
&lt;img src=&#34;https://picx.zhimg.com/v2-5482d5b836bf84a9f774efed3bdeaa2f.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
">Fiddler+雷电模拟器里的APP抓包</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/srrGNAscH8/"" data-c="
          &lt;p&gt;一、首先打开Charles，先进行Charles软件的相关设置&lt;/p&gt;
&lt;p&gt;1、首先需要打开windows代理，先找到代理设置：&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://pic4.zhimg.com/v2-485eee75837f87d6c6de4f254c219cdd_1440w.webp?consumer=ZHI_MENG&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;找到相关代理设置，打开弹窗&lt;/p&gt;
&lt;p&gt;设置代理端口为8888，并且勾选图中复选框，最后点击确认。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://pic4.zhimg.com/v2-ffb46ef148058b4e72348fcdd10e37ab_1440w.webp?consumer=ZHI_MENG&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;2、设置ssl代理设置，找到ssl代理设置。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://pic4.zhimg.com/v2-238999f54b5de7f7d6d6091969cf3d3b_1440w.webp?consumer=ZHI_MENG&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;勾选启用ssl代理&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://pica.zhimg.com/v2-0c9502edf5ba4c62b966bffa2509df54_1440w.webp?consumer=ZHI_MENG&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;点击添加，并且按照下图输入&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://pic2.zhimg.com/v2-1eb9ea1639ecf737334bcef62d87cd3b_1440w.webp?consumer=ZHI_MENG&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;检查无误后，点击确认&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://pic3.zhimg.com/v2-1bab827777860c9827e4e92bf4097dd8_1440w.webp?consumer=ZHI_MENG&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;3、安装证书&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://picx.zhimg.com/v2-0023587318ebbd7c6cf209958b92bb35_1440w.webp?consumer=ZHI_MENG&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://pic2.zhimg.com/v2-d91d20624ac7ab9d7f509cf42c474323_1440w.webp?consumer=ZHI_MENG&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://pica.zhimg.com/v2-0ea79ab470f8e67da9f9f6e9cc2e2f00_1440w.webp?consumer=ZHI_MENG&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://pic3.zhimg.com/v2-c98c6b3ac879cb11c013831bcc77749e_1440w.webp?consumer=ZHI_MENG&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;11&#34;&gt;&lt;img src=&#34;https://pica.zhimg.com/v2-51848163070f5afa8eaf6e46f3f9ed9a_1440w.webp?consumer=ZHI_MENG&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;12&#34;&gt;&lt;img src=&#34;https://picx.zhimg.com/v2-f5aefe7a45afc528c9fd93f4dade891f_1440w.webp?consumer=ZHI_MENG&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;13&#34;&gt;&lt;img src=&#34;https://picx.zhimg.com/v2-54907f1ea8244c76bded4381d0679f79_1440w.webp?consumer=ZHI_MENG&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;14&#34;&gt;&lt;img src=&#34;https://pic4.zhimg.com/v2-99c14f2680632de5323b826e1d4de207_1440w.webp?consumer=ZHI_MENG&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;看到如图所示明文，则证书安装成功。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;15&#34;&gt;&lt;img src=&#34;https://pic3.zhimg.com/v2-9bd7aa52f2dab186624b5aa2728d7756_1440w.webp?consumer=ZHI_MENG&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;二、抓包小程序&lt;/p&gt;
&lt;p&gt;注意：这里仅为抓取电脑微信小程序数据包，如要抓取手机微信小程序包，可参考另一篇文章&lt;/p&gt;
&lt;p&gt;1、打开小程序&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;16&#34;&gt;&lt;img src=&#34;https://pic1.zhimg.com/v2-3d2e591ce2b32f413f6408df5f7aa6c4_1440w.webp?consumer=ZHI_MENG&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;17&#34;&gt;&lt;img src=&#34;https://pic2.zhimg.com/v2-e104819fef8218388d54d12cfe06e2b7_1440w.webp?consumer=ZHI_MENG&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;18&#34;&gt;&lt;img src=&#34;https://picx.zhimg.com/v2-2add7dd72341e01e6f41e7229026a21d_1440w.webp?consumer=ZHI_MENG&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;查看Chrales抓取的数据包，显示如下，则代表抓取成功&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;19&#34;&gt;&lt;img src=&#34;https://pic4.zhimg.com/v2-517fbb54dfb810d935387839f4a337fb_1440w.webp?consumer=ZHI_MENG&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
">使用Charles抓包微信小程序</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/Uc71gzPD7F/"" data-c="
          &lt;p&gt;&lt;strong&gt;1、获取QQ头像：&lt;/strong&gt;&lt;br&gt;
http://q2.qlogo.cn/headimg_dl?dst_uin=QQ号码&amp;amp;spec=100&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2、获取QQ昵称：&lt;/strong&gt;&lt;br&gt;
http://users.qzone.qq.com/fcg-bin/cgi_get_portrait.fcg?uins=QQ号码&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3、获取QQ群头像：&lt;/strong&gt;&lt;br&gt;
http://p.qlogo.cn/gh/QQ群号码/QQ群号码/100/&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4、获取QQ秀接口：&lt;/strong&gt;&lt;br&gt;
http://qqshow-user.tencent.com/QQ号/10/00&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;5、百度文字转语音合成接口：&lt;/strong&gt;&lt;br&gt;
http://tts.baidu.com/text2audio?lan=zh&amp;amp;ie=UTF-8&amp;amp;spd=2&amp;amp;text=要转换的文字&lt;br&gt;
lan=zh：语言是中文，如果改为lan=en，则语言是英文。&lt;br&gt;
ie=UTF-8：文字格式。&lt;br&gt;
spd=2：语速，可以是1-9的数字，数字越大，语速越快。&lt;br&gt;
text=**：这个就是你要转换的文字。&lt;/p&gt;
">QQ接口</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/BOgj-ybOJ/"" data-c="
          &lt;h4 id=&#34;2025年下半年陕西事业单位&#34;&gt;2025年下半年陕西事业单位&lt;/h4&gt;
&lt;p&gt;进面分数线：209.5   最高分：？？？&lt;br&gt;
&lt;img src=&#34;https://pic1.imgdb.cn/item/69001b893203f7be00a801fe.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;2025年上半年事业单位联考&#34;&gt;2025年上半年事业单位联考&lt;/h4&gt;
&lt;p&gt;进面分数线：197.5   最高分：217.5&lt;br&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2025/06/05/8871186f4294c039.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;2025年河南省考&#34;&gt;2025年河南省考&lt;/h4&gt;
&lt;p&gt;进面分数线：62.8   最高分：64.6&lt;br&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2025/06/05/7ae8c24dd28d7726.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;2024年下半年陕西事业单位&#34;&gt;2024年下半年陕西事业单位&lt;/h4&gt;
&lt;p&gt;进面分数线：206.5   最高分：216&lt;br&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/11/05/a5db523f7c2d77c1.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/11/05/89206d63563830cd.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;2024年三门峡市陕州区事业单位&#34;&gt;2024年三门峡市陕州区事业单位&lt;/h4&gt;
&lt;p&gt;进面分数线：72.35   最高分：76.52&lt;br&gt;
&lt;img src=&#34;https://pic.imgdb.cn/item/66bc9021d9c307b7e9c03579.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;2024年四川省三支一扶&#34;&gt;2024年四川省三支一扶&lt;/h4&gt;
&lt;p&gt;进面分数线：66   最高分：72&lt;br&gt;
&lt;img src=&#34;https://pic.imgdb.cn/item/66bc928ed9c307b7e9c43bc5.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;2024年上半年事业单位联考&#34;&gt;2024年上半年事业单位联考&lt;/h4&gt;
&lt;p&gt;进面分数线：206.5   最高分：225.5&lt;br&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/05/10/dd0360ecf0c7c7ed.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;2024年陕西省考&#34;&gt;2024年陕西省考&lt;/h4&gt;
&lt;p&gt;进面分数线：201.5&lt;br&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/06/01/d77ec2c0ad392144.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;2024年国考&#34;&gt;2024年国考&lt;/h4&gt;
&lt;p&gt;进面分数线：135.7&lt;br&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/05/10/222e264a05090883.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;2023下半年陕西事业单位&#34;&gt;2023下半年陕西事业单位&lt;/h4&gt;
&lt;p&gt;进面分数线：210.1&lt;br&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/05/10/32f49a7278c50a50.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://pic.imgdb.cn/item/66bc8e63d9c307b7e9ba355b.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;2023上半年事业单位联考&#34;&gt;2023上半年事业单位联考&lt;/h4&gt;
&lt;p&gt;进面分数线：194.5   最高分：203.5&lt;br&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/05/10/4fb6b652f2fead34.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;2023年河南省考&#34;&gt;2023年河南省考&lt;/h4&gt;
&lt;p&gt;进面分数线：59.45   最高分：61.55&lt;br&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/05/10/16381ca87c17efc2.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
">成绩单</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/kb1qw4MBX/"" data-c="
          &lt;pre&gt;&lt;code&gt;1、段落标记 ^p
2、制表符 ^t
3、任意字符 ^?
4、任意数字 ^#
5、任意字母 ^$
6、脱字号 ^^
7、分节符 ^%
8、段落符号 ^v
9、分栏符 ^n
10、省略号 ^i
11、全角省略号 ^j
12、长划线 ^+
13、1/4长划线 ^q
14、短划线 ^=
15、无宽可选分隔符 ^x
16、无宽非分隔符 ^z
17、尾注标记 ^e
18、域 ^d
19、脚注标记 ^f
20、图形 ^g
21、手动换行符 ^1
22、手动分页符 ^m
23、不间断连字符 ^~
24、不间断空格 ^s
25、可选连字符 ^-
26、分节符 ^b
27、空白区域 ^w
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;WPS里的word怎么批量删除答案和解析一整段段落?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;参考答案：[A-D]*&amp;gt;
【解析】*^13
&amp;lt;[!^13]@2020*^13，删除含有2020所在自然段
&lt;/code&gt;&lt;/pre&gt;
">Word中的特殊格式符号</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/fjFmIKkI7/"" data-c="
          &lt;h4 id=&#34;导入表格样例&#34;&gt;导入表格样例&lt;/h4&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/05/31/40889df5ca9c3f88.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;pomxml&#34;&gt;pom.xml&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;!-- Excel导入 --&amp;gt;
&amp;lt;dependency&amp;gt;
	&amp;lt;groupId&amp;gt;cn.afterturn&amp;lt;/groupId&amp;gt;
	&amp;lt;artifactId&amp;gt;easypoi-spring-boot-starter&amp;lt;/artifactId&amp;gt;
	&amp;lt;version&amp;gt;4.4.0&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;exceltool工具类&#34;&gt;ExcelTool工具类&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import org.apache.poi.hssf.usermodel.*;

import javax.servlet.http.HttpServletResponse;
import java.io.IOException;
import java.util.List;

/**
 * Excel工具类
 */
public class ExcelTool {

    /**
     * Excel表格导出
     * @param response HttpServletResponse对象
     * @param excelData Excel表格的数据，封装为List&amp;lt;List&amp;lt;String&amp;gt;&amp;gt;
     * @param sheetName sheet的名字
     * @param fileName 导出Excel的文件名
     * @param columnWidth Excel表格的宽度，建议为15
     * @throws IOException 抛IO异常
     */
    public static void exportExcel(HttpServletResponse response,
                                   List&amp;lt;List&amp;lt;String&amp;gt;&amp;gt; excelData, 
                                   String sheetName, 
                                   String fileName, 
                                   int columnWidth) throws IOException {

        //声明一个工作簿
        HSSFWorkbook workbook = new HSSFWorkbook();

        //生成一个表格，设置表格名称
        HSSFSheet sheet = workbook.createSheet(sheetName);

        //设置表格列宽度
        sheet.setDefaultColumnWidth(columnWidth);

        //写入List&amp;lt;List&amp;lt;String&amp;gt;&amp;gt;中的数据
        int rowIndex = 0;
        for(List&amp;lt;String&amp;gt; data : excelData){
            //创建一个row行，然后自增1
            HSSFRow row = sheet.createRow(rowIndex++);

            //遍历添加本行数据
            for (int i = 0; i &amp;lt; data.size(); i++) {
                //创建一个单元格
                HSSFCell cell = row.createCell(i);

                //创建一个内容对象
                HSSFRichTextString text = new HSSFRichTextString(data.get(i));

                //将内容对象的文字内容写入到单元格中
                cell.setCellValue(text);
            }
        }

        //准备将Excel的输出流通过response输出到页面下载
        //八进制输出流
        response.setContentType(&amp;quot;application/octet-stream&amp;quot;);

        //设置导出Excel的名称
        response.setHeader(&amp;quot;Content-disposition&amp;quot;, &amp;quot;attachment;filename=&amp;quot; + fileName);

        //刷新缓冲
        response.flushBuffer();

        //workbook将Excel写入到response的输出流中，供页面下载该Excel文件
        workbook.write(response.getOutputStream());

        //关闭workbook
        workbook.close();
    }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;serviceimpl实现类&#34;&gt;serviceimpl实现类&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;	@Override
	public Map&amp;lt;String, Object&amp;gt; uploadExcelSubmit(MultipartFile file, HttpServletRequest request) {
		// 返回结果
		Map&amp;lt;String, Object&amp;gt; mapResult = new HashMap&amp;lt;&amp;gt;();
		int importSuccess = 0;
		int importFail = 0;
		// String contentType = file.getContentType();
		// 获取文件后缀名
		String fileName = file.getOriginalFilename();
		String suffix = fileName.substring(fileName.lastIndexOf(&amp;quot;.&amp;quot;));
		// 实体类集合
		List&amp;lt;Agentstudent&amp;gt; agentstudentList = new ArrayList&amp;lt;&amp;gt;();
		// 导入失败的集合
		List&amp;lt;Agentstudent&amp;gt; agentstudentFailList = new ArrayList&amp;lt;&amp;gt;();
		// 合作伙伴信息
		Integer agentId = Integer.parseInt(redis.opsForValue().get(request.getHeader(&amp;quot;sessionId&amp;quot;)));
		Agent agent = agentMapper.getAgentById(agentId);
		if (suffix.equals(&amp;quot;.xlsx&amp;quot;)) {
			try {
				XSSFWorkbook xwb = new XSSFWorkbook(file.getInputStream());
				XSSFSheet sheetXlsx = xwb.getSheetAt(0);
				XSSFRow row = null;
				XSSFRow rowOne = sheetXlsx.getRow(0);
				if (rowOne.getCell(0).getStringCellValue() == &amp;quot;姓名&amp;quot; &amp;amp;&amp;amp; rowOne.getCell(1).getStringCellValue() == &amp;quot;身份证号&amp;quot;
						&amp;amp;&amp;amp; rowOne.getCell(2).getStringCellValue() == &amp;quot;手机号&amp;quot;
						&amp;amp;&amp;amp; rowOne.getCell(3).getStringCellValue() == &amp;quot;报考院校&amp;quot;
						&amp;amp;&amp;amp; rowOne.getCell(4).getStringCellValue() == &amp;quot;报考专业&amp;quot;
						&amp;amp;&amp;amp; rowOne.getCell(5).getStringCellValue() == &amp;quot;学习形式&amp;quot;
						&amp;amp;&amp;amp; rowOne.getCell(6).getStringCellValue() == &amp;quot;报考层次&amp;quot;
						&amp;amp;&amp;amp; rowOne.getCell(7).getStringCellValue() == &amp;quot;报考日期&amp;quot;
						&amp;amp;&amp;amp; rowOne.getCell(8).getStringCellValue() == &amp;quot;考生户籍地&amp;quot;) {
					// 循环sesheet页中数据从第二行开始，第一行是标题
					for (int i = 1; i &amp;lt; sheetXlsx.getPhysicalNumberOfRows(); i++) {
						row = sheetXlsx.getRow(i);
						Agentstudent data = new Agentstudent();
						SimpleDateFormat df = new SimpleDateFormat(&amp;quot;yyyy/MM/dd&amp;quot;);
						data.setStudentName(row.getCell(0).getStringCellValue());
						row.getCell(1).setCellType(CellType.STRING);
						data.setStudentIdCard(row.getCell(1).getStringCellValue());
						row.getCell(2).setCellType(CellType.STRING);
						data.setStudentPhone(row.getCell(2).getStringCellValue());
						data.setStudentSchool(row.getCell(3).getStringCellValue());
						data.setStudentMajor(row.getCell(4).getStringCellValue());
						data.setStudentMajorType(row.getCell(5).getStringCellValue());
						row.getCell(6).setCellType(CellType.STRING);
						data.setStudentType(Integer.parseInt(row.getCell(6).getStringCellValue()));
						data.setStudentAddDate(
								df.parse(df.format(HSSFDateUtil.getJavaDate(row.getCell(7).getNumericCellValue()))));
						if (row.getCell(8) == null) {
							data.setStudentArea(&amp;quot;未填写&amp;quot;);
						} else {// 单元格有值时，getCell方法获获取到单元格。
							data.setStudentArea(row.getCell(8).getStringCellValue());
						}
						agentstudentList.add(data);
					}
					Integer addYear = addyearMapper.getNowAddyear().getAddYear();
					// 循环展示导入的数据，实际应用中应该校验并存入数据库
					for (Agentstudent student : agentstudentList) {
						if (agentStudentMapper.getStudentByIdCard(student.getStudentIdCard()) &amp;gt;= 1) {
							student.setStudentIdCard(student.getStudentIdCard() + &amp;quot; 身份证号重复录入&amp;quot;);
							agentstudentFailList.add(student);
							importFail++;
						} else if (!IdCardTool.isIDNumber(student.getStudentIdCard())) {
							student.setStudentIdCard(student.getStudentIdCard() + &amp;quot; 身份证号格式错误&amp;quot;);
							agentstudentFailList.add(student);
							importFail++;
						} else {
							student.setStudentAgentName(agent.getAgentName());
							student.setStudentAgentId(agent.getAgentId());
							student.setStudentYear(addYear);
							if (agentStudentMapper.addStudent(student) &amp;gt; 0) {
								importSuccess++;
							} else {
								student.setStudentIdCard(student.getStudentIdCard() + &amp;quot; 录入失败&amp;quot;);
								agentstudentFailList.add(student);
								importFail++;
							}
						}
					}
					mapResult.put(&amp;quot;msg&amp;quot;, &amp;quot;success&amp;quot;);
					mapResult.put(&amp;quot;importSuccess&amp;quot;, importSuccess);
					mapResult.put(&amp;quot;importFail&amp;quot;, importFail);
					mapResult.put(&amp;quot;importAll&amp;quot;, agentstudentList.size());
					mapResult.put(&amp;quot;agentstudentFailList&amp;quot;, agentstudentFailList);
				} else {
					mapResult.put(&amp;quot;msg&amp;quot;, &amp;quot;fileTypeError&amp;quot;);
				}
			} catch (Exception e) {
				mapResult.put(&amp;quot;msg&amp;quot;, &amp;quot;fail&amp;quot;);
				e.printStackTrace();
			}
		} else if (suffix.equals(&amp;quot;.xls&amp;quot;)) {
			try {
				HSSFWorkbook hwb = new HSSFWorkbook(file.getInputStream()); // 根据页面index
				HSSFSheet sheetXls = hwb.getSheetAt(0);
				HSSFRow row = null;
				HSSFRow rowOne = sheetXls.getRow(0);
				if (rowOne.getCell(0).getStringCellValue() == &amp;quot;姓名&amp;quot; &amp;amp;&amp;amp; rowOne.getCell(1).getStringCellValue() == &amp;quot;身份证号&amp;quot;
						&amp;amp;&amp;amp; rowOne.getCell(2).getStringCellValue() == &amp;quot;手机号&amp;quot;
						&amp;amp;&amp;amp; rowOne.getCell(3).getStringCellValue() == &amp;quot;报考院校&amp;quot;
						&amp;amp;&amp;amp; rowOne.getCell(4).getStringCellValue() == &amp;quot;报考专业&amp;quot;
						&amp;amp;&amp;amp; rowOne.getCell(5).getStringCellValue() == &amp;quot;学习形式&amp;quot;
						&amp;amp;&amp;amp; rowOne.getCell(6).getStringCellValue() == &amp;quot;报考层次&amp;quot;
						&amp;amp;&amp;amp; rowOne.getCell(7).getStringCellValue() == &amp;quot;报考日期&amp;quot;
						&amp;amp;&amp;amp; rowOne.getCell(8).getStringCellValue() == &amp;quot;考生户籍地&amp;quot;) {
					// 循环sesheet页中数据从第二行开始，第一行是标题
					for (int i = 1; i &amp;lt; sheetXls.getPhysicalNumberOfRows(); i++) {
						// 获取每一行数据
						row = sheetXls.getRow(i);
						Agentstudent data = new Agentstudent();
						SimpleDateFormat df = new SimpleDateFormat(&amp;quot;yyyy/MM/dd&amp;quot;);
						data.setStudentName(row.getCell(0).getStringCellValue());
						row.getCell(1).setCellType(CellType.STRING);
						data.setStudentIdCard(row.getCell(1).getStringCellValue());
						row.getCell(2).setCellType(CellType.STRING);
						data.setStudentPhone(row.getCell(2).getStringCellValue());
						data.setStudentSchool(row.getCell(3).getStringCellValue());
						data.setStudentMajor(row.getCell(4).getStringCellValue());
						data.setStudentMajorType(row.getCell(5).getStringCellValue());
						row.getCell(6).setCellType(CellType.STRING);
						data.setStudentType(Integer.parseInt(row.getCell(6).getStringCellValue()));
						data.setStudentAddDate(
								df.parse(df.format(HSSFDateUtil.getJavaDate(row.getCell(7).getNumericCellValue()))));
						if (row.getCell(8) == null) {
							data.setStudentArea(&amp;quot;未填写&amp;quot;);
						} else {// 单元格有值时，getCell方法获获取到单元格。
							data.setStudentArea(row.getCell(8).getStringCellValue());
						}
						agentstudentList.add(data);
					}
					Integer addYear = addyearMapper.getNowAddyear().getAddYear();
					// 循环展示导入的数据，实际应用中应该校验并存入数据库
					for (Agentstudent student : agentstudentList) {
						if (agentStudentMapper.getStudentByIdCard(student.getStudentIdCard()) &amp;gt;= 1) {
							student.setStudentIdCard(student.getStudentIdCard() + &amp;quot; 身份证号重复录入&amp;quot;);
							agentstudentFailList.add(student);
							importFail++;
						} else if (!IdCardTool.isIDNumber(student.getStudentIdCard())) {
							student.setStudentIdCard(student.getStudentIdCard() + &amp;quot; 身份证号格式错误&amp;quot;);
							agentstudentFailList.add(student);
							importFail++;
						} else if (student.getStudentType() &amp;lt;= 0 || student.getStudentType() &amp;gt; 3) {
							student.setStudentIdCard(student.getStudentIdCard() + &amp;quot; 录入报考层次无效&amp;quot;);
							agentstudentFailList.add(student);
							importFail++;
						} else {
							student.setStudentAgentName(agent.getAgentName());
							student.setStudentAgentId(agent.getAgentId());
							student.setStudentYear(addYear);
							if (agentStudentMapper.addStudent(student) &amp;gt; 0) {
								importSuccess++;
							} else {
								student.setStudentIdCard(student.getStudentIdCard() + &amp;quot; 录入失败&amp;quot;);
								agentstudentFailList.add(student);
								importFail++;
							}
						}
					}
					mapResult.put(&amp;quot;msg&amp;quot;, &amp;quot;success&amp;quot;);
					mapResult.put(&amp;quot;importSuccess&amp;quot;, importSuccess);
					mapResult.put(&amp;quot;importFail&amp;quot;, importFail);
					mapResult.put(&amp;quot;importAll&amp;quot;, agentstudentList.size());
					mapResult.put(&amp;quot;agentstudentFailList&amp;quot;, agentstudentFailList);
				} else {
					mapResult.put(&amp;quot;msg&amp;quot;, &amp;quot;fileTypeError&amp;quot;);
				}
			} catch (Exception e) {
				mapResult.put(&amp;quot;msg&amp;quot;, &amp;quot;fail&amp;quot;);
				e.printStackTrace();
			}
		} else {
			mapResult.put(&amp;quot;msg&amp;quot;, &amp;quot;fail&amp;quot;);
		}
		return mapResult;
	}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;前端请求&#34;&gt;前端请求&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;	// 判断上传Excel文件
    excelFileChange() {
      var _this = this;
      var fileObject = document.getElementById(&amp;quot;uploadExcelFile&amp;quot;);
      if (fileObject.value != &amp;quot;&amp;quot;) {
        var fileSrc = fileObject.value.split(&amp;quot;\\&amp;quot;);
        var fileName = fileSrc[fileSrc.length - 1];
        var fileExt = fileName.substr(fileName.lastIndexOf(&amp;quot;.&amp;quot;)).toLowerCase();
        var fileSize = Math.ceil(fileObject.files[0].size / 1024);
        var allowExt = &amp;quot;.xlsx|.xls|&amp;quot;;
        if (allowExt !== 0 &amp;amp;&amp;amp; allowExt.indexOf(fileExt + &amp;quot;|&amp;quot;) === -1) {
          fileObject.value = &amp;quot;&amp;quot;;
          _this.$alert(&amp;quot;alert alert-danger&amp;quot;, &amp;quot;上传文件格式不符合要求&amp;quot;);
          return false;
        } else if (fileSize &amp;gt; 2048) {
          fileObject.value = &amp;quot;&amp;quot;;
          _this.$alert(&amp;quot;alert alert-danger&amp;quot;, &amp;quot;上传的文件不能超过 2 M&amp;quot;);
          return false;
        }
      } else {
        fileObject.value = &amp;quot;&amp;quot;;
        _this.$alert(&amp;quot;alert alert-danger&amp;quot;, &amp;quot;文件取消上传&amp;quot;);
      }
    },
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;	// 上传excel提交
    uploadExcelSubmit() {
      var _this = this;
      var fileObject = document.getElementById(&amp;quot;uploadExcelFile&amp;quot;);
      if (fileObject.value === &amp;quot;&amp;quot; || fileObject.value == null) {
        _this.$alert(&amp;quot;alert alert-danger&amp;quot;, &amp;quot;请选择要上传的附件&amp;quot;);
        return false;
      } else {
        var formdata = new FormData();
        // 上传的文件
        formdata.append(&amp;quot;file&amp;quot;, fileObject.files[0]);
        _this.$loading(true, &amp;quot;数据导入中，请勿关闭此页面......&amp;quot;);
        _this
          .$http({
            headers: {
              &amp;quot;Content-Type&amp;quot;: &amp;quot;multipart/form-databoundary&amp;quot;,
            },
            method: &amp;quot;post&amp;quot;,
            url: &amp;quot;/api/partnet/agentstudent/uploadExcelSubmit&amp;quot;,
            data: formdata,
          })
          .then(
            (res) =&amp;gt; {
              if (res.status == 200) {
                if (res.data.msg == &amp;quot;success&amp;quot;) {
                  fileObject.value = &amp;quot;&amp;quot;;
                  _this.agentstudentFailList = res.data.agentstudentFailList;
                  _this.agentGetStudentList();
                  alert(
                    &amp;quot;导入总数据 &amp;quot; +
                      res.data.importAll +
                      &amp;quot; 条，成功 &amp;quot; +
                      res.data.importSuccess +
                      &amp;quot; 条，失败 &amp;quot; +
                      res.data.importFail +
                      &amp;quot; 条&amp;quot;
                  );
                } else if (res.data.msg == &amp;quot;fileTypeError&amp;quot;) {
                  fileObject.value = &amp;quot;&amp;quot;;
                  alert(&amp;quot;导入失败，请与模板文件保持一致&amp;quot;);
                } else {
                  _this.$alert(&amp;quot;alert alert-danger&amp;quot;, &amp;quot;文件导入失败&amp;quot;);
                }
              } else {
                _this.$alert(&amp;quot;alert alert-danger&amp;quot;, &amp;quot;服务器错误&amp;quot;);
              }
              _this.$loading(false);
            },
            (err) =&amp;gt; {
              if (err.status === 403) {
                var agentLoginInfo = {
                  agentIsLogin: false,
                  agentRole: 1,
                  agentName: &amp;quot;&amp;quot;,
                };
                _this.$store.commit(&amp;quot;changeAgentLoginInfo&amp;quot;, agentLoginInfo);
                _this.$router.push(&amp;quot;/login.html&amp;quot;);
                _this.$alert(&amp;quot;alert alert-danger&amp;quot;, &amp;quot;请重新登录&amp;quot;);
              } else {
                _this.$alert(&amp;quot;alert alert-danger&amp;quot;, &amp;quot;出错了，请稍后再试&amp;quot;);
              }
              _this.$loading(false);
            }
          );
      }
    },
&lt;/code&gt;&lt;/pre&gt;
">Excel导入数据示例</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/sqnsjjd4y/"" data-c="
          &lt;p&gt;edge浏览器安装扩展插件报错&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;1、将记事本以管理员身份运行

2、文件—&amp;gt;打开C:\Windows\System32\drivers\etc\hosts

3、在hosts文件里面最后面，添加（不需要添加井号）：

131.253.33.219 edge.microsoft.com

131.253.33.219 msedgeextensions.sf.tlu.dl.delivery.mp.microsoft.com
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;不清除数据卸载微信&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;adb devices  //检测adb连接状态

adb shell pm uninstall -k com.tencent.mm  //不清除数据卸载微信
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;快捷方式修复.bat&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;rem 关闭explorer.exe

taskkill /f /im explorer.exe

attrib -s -h -i %userprofile%\AppData\Local\IconCache.db

del %userprofile%\AppData\Local\IconCache.db /a

attrib +h +s %userprofile%\AppData\Local\IconCache.db

rem 打开explorer

start explorer
&lt;/code&gt;&lt;/pre&gt;
">解决方案</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/QiGBPxk_U/"" data-c="
          &lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;cmd /k &amp;quot;cd /d E:/dev/workspace/java/studentmanage&amp;amp;&amp;amp;mvn assembly:assembly&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
">指定路径执行指定命令</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/phrRmI429/"" data-c="
          &lt;h4 id=&#34;一-常用正则表达式&#34;&gt;一、常用正则表达式&lt;/h4&gt;
&lt;h6 id=&#34;1-校验数字的表达式&#34;&gt;1、校验数字的表达式&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;//数字：
^[0-9]*$
//n位的数字：
^\d{n}$
//至少n位的数字：
^\d{n,}$
//m-n位的数字：
^\d{m,n}$
//零和非零开头的数字：
^(0|[1-9][0-9]*)$
//非零开头的最多带两位小数的数字：
^([1-9][0-9]*)+(\.[0-9]{1,2})?$
//带1-2位小数的正数或负数：
^(\-)?\d+(\.\d{1,2})$
//正数、负数、和小数：
^(\-|\+)?\d+(\.\d+)?$
//有两位小数的正实数：
^[0-9]+(\.[0-9]{2})?$
//有1~3位小数的正实数：
^[0-9]+(\.[0-9]{1,3})?$
//非零的正整数：
^[1-9]\d*$ 或 ^([1-9][0-9]*){1,3}$ 或 ^\+?[1-9][0-9]*$
//非零的负整数：
^\-[1-9][]0-9&amp;quot;*$ 或 ^-[1-9]\d*$
//非负整数：
^\d+$ 或 ^[1-9]\d*|0$
//非正整数：
^-[1-9]\d*|0$ 或 ^((-\d+)|(0+))$
//非负浮点数：
^\d+(\.\d+)?$ 或 ^[1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0$
//非正浮点数：
^((-\d+(\.\d+)?)|(0+(\.0+)?))$ 或 ^(-([1-9]\d*\.\d*|0\.\d*[1-9]\d*))|0?\.0+|0$
//正浮点数：
^[1-9]\d*\.\d*|0\.\d*[1-9]\d*$ 或 ^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$
//负浮点数：
^-([1-9]\d*\.\d*|0\.\d*[1-9]\d*)$ 或 ^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$
//浮点数：
^(-?\d+)(\.\d+)?$ 或 ^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;2-校验字符的表达式&#34;&gt;2、校验字符的表达式&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;//汉字：
^[\u4e00-\u9fa5]{0,}$
//英文和数字：
^[A-Za-z0-9]+$ 或 ^[A-Za-z0-9]{4,40}$
//长度为3-20的所有字符：
^.{3,20}$
//由26个英文字母组成的字符串：
^[A-Za-z]+$
//由26个大写英文字母组成的字符串：
^[A-Z]+$
//由26个小写英文字母组成的字符串：
^[a-z]+$
//由数字和26个英文字母组成的字符串：
^[A-Za-z0-9]+$
//由数字、26个英文字母或者下划线组成的字符串：
^\w+$ 或 ^\w{3,20}$
//中文、英文、数字包括下划线：
^[\u4E00-\u9FA5A-Za-z0-9_]+$
//中文、英文、数字但不包括下划线等符号：
^[\u4E00-\u9FA5A-Za-z0-9]+$ 或 ^[\u4E00-\u9FA5A-Za-z0-9]{2,20}$
//可以输入含有^%&amp;amp;&#39;,;=?$\&amp;quot;等字符：
[^%&amp;amp;&#39;,;=?$\x22]+
//禁止输入含有~的字符：
[^~\x22]+
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;3-特殊需求表达式&#34;&gt;3、特殊需求表达式&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;//Email地址：
^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$
//域名：
[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+\.?
//InternetURL：
[a-zA-z]+://[^\s]* 或 ^http://([\w-]+\.)+[\w-]+(/[\w-./?%&amp;amp;=]*)?$
//手机号码：
^(13[0-9]|14[5|7]|15[0|1|2|3|4|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$
//电话号码(&amp;quot;XXX-XXXXXXX&amp;quot;、&amp;quot;XXXX-XXXXXXXX&amp;quot;、&amp;quot;XXX-XXXXXXX&amp;quot;、&amp;quot;XXX-XXXXXXXX&amp;quot;、&amp;quot;XXXXXXX&amp;quot;和&amp;quot;XXXXXXXX)：
^(\(\d{3,4}-)|\d{3.4}-)?\d{7,8}$
//国内电话号码(0511-4405222、021-87888822)：
\d{3}-\d{8}|\d{4}-\d{7}
//电话号码正则表达式（支持手机号码，3-4位区号，7-8位直播号码，1－4位分机号）: 
((\d{11})|^((\d{7,8})|(\d{4}|\d{3})-(\d{7,8})|(\d{4}|\d{3})-(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1}))$)
//身份证号(15位、18位数字)，最后一位是校验位，可能为数字或字符X：
(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)
//帐号是否合法(字母开头，允许5-16字节，允许字母数字下划线)：
^[a-zA-Z][a-zA-Z0-9_]{4,15}$
//密码(以字母开头，长度在6~18之间，只能包含字母、数字和下划线)：
^[a-zA-Z]\w{5,17}$
//强密码(必须包含大小写字母和数字的组合，不能使用特殊字符，长度在 8-10 之间)：
^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])[a-zA-Z0-9]{8,10}$
//强密码(必须包含大小写字母和数字的组合，可以使用特殊字符，长度在8-10之间)：
^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,10}$
//日期格式：
^\d{4}-\d{1,2}-\d{1,2}
//一年的12个月(01～09和1～12)：
^(0?[1-9]|1[0-2])$
//一个月的31天(01～09和1～31)：
^((0?[1-9])|((1|2)[0-9])|30|31)$
//钱的输入格式：
//有四种钱的表示形式我们可以接受:&amp;quot;10000.00&amp;quot; 和 &amp;quot;10,000.00&amp;quot;, 和没有 &amp;quot;分&amp;quot; 的 &amp;quot;10000&amp;quot; 和 &amp;quot;10,000&amp;quot;：
^[1-9][0-9]*$
//这表示任意一个不以0开头的数字,但是,这也意味着一个字符&amp;quot;0&amp;quot;不通过,所以我们采用下面的形式：
^(0|[1-9][0-9]*)$
//一个0或者一个不以0开头的数字.我们还可以允许开头有一个负号：
^(0|-?[1-9][0-9]*)$
//这表示一个0或者一个可能为负的开头不为0的数字.让用户以0开头好了.把负号的也去掉,因为钱总不能是负的吧。下面我们要加的是说明可能的小数部分：
^[0-9]+(.[0-9]+)?$
//必须说明的是,小数点后面至少应该有1位数,所以&amp;quot;10.&amp;quot;是不通过的,但是 &amp;quot;10&amp;quot; 和 &amp;quot;10.2&amp;quot; 是通过的：
^[0-9]+(.[0-9]{2})?$
//这样我们规定小数点后面必须有两位,如果你认为太苛刻了,可以这样：
^[0-9]+(.[0-9]{1,2})?$
//这样就允许用户只写一位小数.下面我们该考虑数字中的逗号了,我们可以这样：
^[0-9]{1,3}(,[0-9]{3})*(.[0-9]{1,2})?$
//1到3个数字,后面跟着任意个 逗号+3个数字,逗号成为可选,而不是必须：
^([0-9]+|[0-9]{1,3}(,[0-9]{3})*)(.[0-9]{1,2})?$
//备注：这就是最终结果了,别忘了&amp;quot;+&amp;quot;可以用&amp;quot;*&amp;quot;替代如果你觉得空字符串也可以接受的话(奇怪,为什么?)最后,别忘了在用函数时去掉去掉那个反斜杠,一般的错误都在这里
//xml文件：
^([a-zA-Z]+-?)+[a-zA-Z0-9]+\\.[x|X][m|M][l|L]$
//中文字符的正则表达式：
[\u4e00-\u9fa5]
//双字节字符：
[^\x00-\xff] (包括汉字在内，可以用来计算字符串的长度(一个双字节字符长度计2，ASCII字符计1))
//空白行的正则表达式：
\n\s*\r (可以用来删除空白行)
//HTML标记的正则表达式：
&amp;lt;(\S*?)[^&amp;gt;]*&amp;gt;.*?|&amp;lt;.*? /&amp;gt; ( 
//首尾空白字符的正则表达式，可以用来删除行首行尾的空白字符(包括空格、制表符、换页符等等)，非常有用的表达式
^\s*|\s*$或(^\s*)|(\s*$) 
//腾讯QQ号： (腾讯QQ号从10000开始)
[1-9][0-9]{4,}
//中国邮政编码：(中国邮政编码为6位数字)
[1-9]\d{5}(?!\d) 
//IPv4地址：
((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;二-js使用正则表达式&#34;&gt;二、JS使用正则表达式&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;var r = /^\+?[1-9][0-9]*$/;　　//正整数
var str = &amp;quot;123&amp;quot;;
var flag=r.test(str); //如果判断为正整数，则flag为true
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;三-java使用正则表达式&#34;&gt;三、java使用正则表达式&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;String content = &amp;quot;I am noob &amp;quot; +&amp;quot;from runoob.com.&amp;quot;;
String pattern = &amp;quot;.*runoob.*&amp;quot;;
boolean isMatch = Pattern.matches(pattern, content);
System.out.println(&amp;quot;字符串中是否包含了 &#39;runoob&#39; 子字符串? &amp;quot; + isMatch);
// 字符串中是否包含了 &#39;runoob&#39; 子字符串? true
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;四-正则表达式中需要转义的字符&#34;&gt;四、正则表达式中需要转义的字符&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;$
匹配输入字符串的结尾位置。如果设置了 RegExp 对象的 Multiline 属性，则 $ 也匹配 ‘\n&#39; 或 ‘\r&#39;。要匹配 $ 字符本身，请使用 \$。
 
( )
标记一个子表达式的开始和结束位置。子表达式可以获取供以后使用。要匹配这些字符，请使用 。
 
*
匹配前面的子表达式零次或多次。要匹配 * 字符，请使用 \*。
 
+
匹配前面的子表达式一次或多次。要匹配 + 字符，请使用 \+。
 
.
匹配除换行符 \n之外的任何单字符。要匹配 .，请使用 \。
 
[ ]
标记一个中括号表达式的开始。要匹配 [，请使用 \[。
 
?
匹配前面的子表达式零次或一次，或指明一个非贪婪限定符。要匹配 ? 字符，请使用 \?。
 
\
将下一个字符标记为或特殊字符、或原义字符、或向后引用、或八进制转义符。例如， ‘n&#39; 匹配字符 ‘n&#39;。&#39;\n&#39; 匹配换行符。序列 ‘\\&#39; 匹配 “\”，而 ‘\(&#39; 则匹配 “(”。
 
^
匹配输入字符串的开始位置，除非在方括号表达式中使用，此时它表示不接受该字符集合。要匹配 ^ 字符本身，请使用 \^。
 
{ }
标记限定符表达式的开始。要匹配 {，请使用 \{。
 
|
指明两项之间的一个选择。要匹配 |，请使用 \|。
&lt;/code&gt;&lt;/pre&gt;
">正则表达式</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/hXmfjxh2r/"" data-c="
          &lt;h4 id=&#34;一-java生成图形验证码&#34;&gt;一、java生成图形验证码&lt;/h4&gt;
&lt;h6 id=&#34;1-java生成图形验证码工具类&#34;&gt;1、java生成图形验证码工具类&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.awt.Color;
import java.awt.Font;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.RenderingHints;
import java.awt.geom.AffineTransform;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.OutputStream;
import java.util.*;
import javax.imageio.ImageIO;

public class VerifyCodeTool {
	// 使用到Algerian字体，系统里没有的话需要安装字体，字体只显示大写，去掉了1,0,i,o几个容易混淆的字符
	public static final String VERIFY_CODES = &amp;quot;23456789ABCDEFGHJKLMNPQRSTUVWXYZ&amp;quot;;
	private static Random random = new Random();

	/**
	 * 使用系统默认字符源生成验证码
	 * 
	 * @param verifySize
	 *            验证码长度
	 * @return
	 */
	public static String generateVerifyCode(int verifySize) {
		return generateVerifyCode(verifySize, VERIFY_CODES);
	}

	/**
	 * 使用指定源生成验证码
	 * 
	 * @param verifySize
	 *            验证码长度
	 * @param sources
	 *            验证码字符源
	 * @return
	 */
	public static String generateVerifyCode(int verifySize, String sources) {
		if (sources == null || sources.length() == 0) {
			sources = VERIFY_CODES;
		}
		int codesLen = sources.length();
		Random rand = new Random(System.currentTimeMillis());
		StringBuilder verifyCode = new StringBuilder(verifySize);
		for (int i = 0; i &amp;lt; verifySize; i++) {
			verifyCode.append(sources.charAt(rand.nextInt(codesLen - 1)));
		}
		return verifyCode.toString();
	}

	/**
	 * 生成随机验证码文件,并返回验证码值
	 * 
	 * @param w
	 * @param h
	 * @param outputFile
	 * @param verifySize
	 * @return
	 * @throws IOException
	 */
	public static String outputVerifyImage(int w, int h, File outputFile, int verifySize) throws IOException {
		String verifyCode = generateVerifyCode(verifySize);
		outputImage(w, h, outputFile, verifyCode);
		return verifyCode;
	}

	/**
	 * 输出随机验证码图片流,并返回验证码值
	 * 
	 * @param w
	 * @param h
	 * @param os
	 * @param verifySize
	 * @return
	 * @throws IOException
	 */
	public static String outputVerifyImage(int w, int h, OutputStream os, int verifySize) throws IOException {
		String verifyCode = generateVerifyCode(verifySize);
		outputImage(w, h, os, verifyCode);
		return verifyCode;
	}

	/**
	 * 生成指定验证码图像文件
	 * 
	 * @param w
	 * @param h
	 * @param outputFile
	 * @param code
	 * @throws IOException
	 */
	public static void outputImage(int w, int h, File outputFile, String code) throws IOException {
		if (outputFile == null) {
			return;
		}
		File dir = outputFile.getParentFile();
		if (!dir.exists()) {
			dir.mkdirs();
		}
		try {
			outputFile.createNewFile();
			FileOutputStream fos = new FileOutputStream(outputFile);
			outputImage(w, h, fos, code);
			fos.close();
		} catch (IOException e) {
			throw e;
		}
	}

	/**
	 * 输出指定验证码图片流
	 * 
	 * @param w
	 * @param h
	 * @param os
	 * @param code
	 * @throws IOException
	 */
	public static void outputImage(int w, int h, OutputStream os, String code) throws IOException {
		int verifySize = code.length();
		BufferedImage image = new BufferedImage(w, h, BufferedImage.TYPE_INT_RGB);
		Random rand = new Random();
		Graphics2D g2 = image.createGraphics();
		g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
		Color[] colors = new Color[5];
		Color[] colorSpaces = new Color[] { Color.WHITE, Color.CYAN, Color.GRAY, Color.LIGHT_GRAY, Color.MAGENTA,
				Color.ORANGE, Color.PINK, Color.YELLOW };
		float[] fractions = new float[colors.length];
		for (int i = 0; i &amp;lt; colors.length; i++) {
			colors[i] = colorSpaces[rand.nextInt(colorSpaces.length)];
			fractions[i] = rand.nextFloat();
		}
		Arrays.sort(fractions);
		g2.setColor(Color.GRAY);// 设置边框色
		g2.fillRect(0, 0, w, h);
		Color c = getRandColor(200, 250);
		g2.setColor(c);// 设置背景色
		g2.fillRect(0, 2, w, h - 4);
		// 绘制干扰线
		Random random = new Random();
		g2.setColor(getRandColor(160, 200));// 设置线条的颜色
		for (int i = 0; i &amp;lt; 20; i++) {
			int x = random.nextInt(w - 1);
			int y = random.nextInt(h - 1);
			int xl = random.nextInt(6) + 1;
			int yl = random.nextInt(12) + 1;
			g2.drawLine(x, y, x + xl + 40, y + yl + 20);
		}
		// 添加噪点
		float yawpRate = 0.05f;// 噪声率
		int area = (int) (yawpRate * w * h);
		for (int i = 0; i &amp;lt; area; i++) {
			int x = random.nextInt(w);
			int y = random.nextInt(h);
			int rgb = getRandomIntColor();
			image.setRGB(x, y, rgb);
		}
		shear(g2, w, h, c);// 使图片扭曲
		g2.setColor(getRandColor(100, 160));
		int fontSize = h - 4;
		Font font = new Font(&amp;quot;Algerian&amp;quot;, Font.ITALIC, fontSize);
		g2.setFont(font);
		char[] chars = code.toCharArray();
		for (int i = 0; i &amp;lt; verifySize; i++) {
			AffineTransform affine = new AffineTransform();
			affine.setToRotation(Math.PI / 4 * rand.nextDouble() * (rand.nextBoolean() ? 1 : -1),
					(w / verifySize) * i + fontSize / 2, h / 2);
			g2.setTransform(affine);
			g2.drawChars(chars, i, 1, ((w - 10) / verifySize) * i + 5, h / 2 + fontSize / 2 - 10);
		}
		g2.dispose();
		ImageIO.write(image, &amp;quot;jpg&amp;quot;, os);
	}

	/**
	 * 随机生成字符 或 者数字
	 * 
	 * @return
	 */
	private static String getRandom() {
		String value = &amp;quot;&amp;quot;;
		Random random = new Random();
		int gen = random.nextInt(2);
		String charOrNum = gen % 2 == 0 ? &amp;quot;char&amp;quot; : &amp;quot;num&amp;quot;;
		if (&amp;quot;char&amp;quot;.equals(charOrNum)) {
			// 字符
			int temp = random.nextInt(2) % 2 == 0 ? 65 : 97;
			int ascii = random.nextInt(26);
			value += (char) (ascii + temp);
		} else if (&amp;quot;num&amp;quot;.equals(charOrNum)) {
			// 是数字
			value += String.valueOf(random.nextInt(10));
		}
		return value;
	}

	/**
	 * 随机生成字符串（包含字符和数字）
	 * 
	 * @param length
	 *            指定长度
	 * @return 返回set
	 */
	private static Set&amp;lt;String&amp;gt; getStrAndNum(int length) {
		Set&amp;lt;String&amp;gt; set = new HashSet&amp;lt;&amp;gt;();
		for (int i = 0; i &amp;lt; length; i++) {
			String value = getRandom();
			set.add(value);
		}
		// 若生成的字符串没达到指定长度 继续生成
		if (set.size() &amp;lt; length) {
			String value = getRandom();
			set.add(value);
		}
		return set;
	}

	/**
	 * 存放在set中的字符组拼接成字符串
	 * 
	 * @param set
	 * @return
	 */
	private static String printSet(Set set) { // 打印set的方法
		Iterator iterator = set.iterator();
		String value = &amp;quot;&amp;quot;;
		while (iterator.hasNext()) {
			// String ele = (String) iterator.next();
			value += (String) iterator.next();
		}
		return value;
	}

	/**
	 * 返回生成的随机字符串
	 * 
	 * @param length
	 *            指定随机字符串长度
	 * @return 指定长度 大于零 返回指定长度随机字符，小于等于零 返回null
	 */
	public static String getRandonString(int length) {
		String value = &amp;quot;&amp;quot;;
		if (length &amp;gt; 0) {
			// 如果返回的字符串小于指定长度 重新生成
			if (value.length() &amp;lt; length) {
				Set&amp;lt;String&amp;gt; store = getStrAndNum(length);
				value = printSet(store);
			}
			return value;
		} else {
			return value;
		}
	}

	private static Color getRandColor(int fc, int bc) {
		if (fc &amp;gt; 255)
			fc = 255;
		if (bc &amp;gt; 255)
			bc = 255;
		int r = fc + random.nextInt(bc - fc);
		int g = fc + random.nextInt(bc - fc);
		int b = fc + random.nextInt(bc - fc);
		return new Color(r, g, b);
	}

	private static int getRandomIntColor() {
		int[] rgb = getRandomRgb();
		int color = 0;
		for (int c : rgb) {
			color = color &amp;lt;&amp;lt; 8;
			color = color | c;
		}
		return color;
	}

	private static int[] getRandomRgb() {
		int[] rgb = new int[3];
		for (int i = 0; i &amp;lt; 3; i++) {
			rgb[i] = random.nextInt(255);
		}
		return rgb;
	}

	private static void shear(Graphics g, int w1, int h1, Color color) {
		shearX(g, w1, h1, color);
		shearY(g, w1, h1, color);
	}

	private static void shearX(Graphics g, int w1, int h1, Color color) {
		int period = random.nextInt(2);
		boolean borderGap = true;
		int frames = 1;
		int phase = random.nextInt(2);
		for (int i = 0; i &amp;lt; h1; i++) {
			double d = (double) (period &amp;gt;&amp;gt; 1)
					* Math.sin((double) i / (double) period + (6.2831853071795862D * (double) phase) / (double) frames);
			g.copyArea(0, i, w1, 1, (int) d, 0);
			if (borderGap) {
				g.setColor(color);
				g.drawLine((int) d, i, 0, i);
				g.drawLine((int) d + w1, i, w1, i);
			}
		}
	}

	private static void shearY(Graphics g, int w1, int h1, Color color) {
		int period = random.nextInt(40) + 10; // 50;
		boolean borderGap = true;
		int frames = 20;
		int phase = 7;
		for (int i = 0; i &amp;lt; w1; i++) {
			double d = (double) (period &amp;gt;&amp;gt; 1)
					* Math.sin((double) i / (double) period + (6.2831853071795862D * (double) phase) / (double) frames);
			g.copyArea(i, 0, 1, h1, 0, (int) d);
			if (borderGap) {
				g.setColor(color);
				g.drawLine(i, (int) d, i, 0);
				g.drawLine(i, (int) d + h1, i, h1);
			}
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;2-生成图像验证码&#34;&gt;2、生成图像验证码&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
	 * 生成图形验证码
	 * 
	 * @param request
	 * @param response
	 * @throws IOException
	 */
	@RequestMapping(value = &amp;quot;/getVerifyCode&amp;quot;, method = RequestMethod.POST)
	public void getVerifyCode(HttpServletRequest request, HttpServletResponse response) throws IOException {
		response.setHeader(&amp;quot;Pragma&amp;quot;, &amp;quot;No-cache&amp;quot;);
		response.setHeader(&amp;quot;Cache-Control&amp;quot;, &amp;quot;no-cache&amp;quot;);
		response.setDateHeader(&amp;quot;Expires&amp;quot;, 0);
		response.setContentType(&amp;quot;image/jpeg&amp;quot;);
		// 生成随机大写字串
		String verifyCode = VerifyCodeTool.generateVerifyCode(4);
		// 存入会话session
		HttpSession session = request.getSession(true);
		// 删除以前的
		session.removeAttribute(&amp;quot;verifyCode&amp;quot;);
		session.removeAttribute(&amp;quot;verifyCodeDate&amp;quot;);
		// 设置新的验证码
		session.setAttribute(&amp;quot;verifyCode&amp;quot;, verifyCode.toLowerCase());
		session.setAttribute(&amp;quot;verifyCodeDate&amp;quot;, new Date());
		// 10分钟验证码过期
		session.setMaxInactiveInterval(60 * 10);
		// 生成图片
		int w = 100, h = 40;
		OutputStream out = response.getOutputStream();
		VerifyCodeTool.outputImage(w, h, out, verifyCode);
	}
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;3-判断验证码是否输入正确&#34;&gt;3、判断验证码是否输入正确&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
	 * 判断验证码是否输入正确
	 * 
	 * @param verifyCode
	 * @param request
	 * @return
	 */
	@RequestMapping(value = &amp;quot;/imgCodeVerify&amp;quot;, method = RequestMethod.POST)
	@ResponseBody
	public String imgCodeVerify(HttpServletRequest request) {
		HttpSession session = request.getSession(true);
		if (session.getAttribute(&amp;quot;verifyCode&amp;quot;) != null) {
			String sessionfVerifyCode = session.getAttribute(&amp;quot;verifyCode&amp;quot;).toString();
			if (sessionfVerifyCode.equals(mapParam.get(&amp;quot;verifyCode&amp;quot;).toLowerCase())) {
				// 输入正确
				return &amp;quot;success&amp;quot;;
			} else {
				// 输入错误
				return &amp;quot;fail&amp;quot;;
			}
		} else {
			// 过期
			return &amp;quot;expire&amp;quot;;
		}
	}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;二-vue前端图形验证码&#34;&gt;二、Vue前端图形验证码&lt;/h4&gt;
&lt;h6 id=&#34;1-验证页面调用验证码组件&#34;&gt;1、验证页面，调用验证码组件&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;&amp;lt;!--验证页面，调用验证码组件--&amp;gt;
&amp;lt;template&amp;gt;
  &amp;lt;div id=&amp;quot;img-code&amp;quot;&amp;gt;
    &amp;lt;div class=&amp;quot;img-code-style&amp;quot; @click=&amp;quot;refreshCode&amp;quot;&amp;gt;
      &amp;lt;!--验证码组件--&amp;gt;
      &amp;lt;s-identify :identifyCode=&amp;quot;identifyCode&amp;quot;&amp;gt;&amp;lt;/s-identify&amp;gt;
    &amp;lt;/div&amp;gt;
    &amp;lt;input v-model=&amp;quot;code&amp;quot; placeholder=&amp;quot;请输入验证码&amp;quot; /&amp;gt;
    &amp;lt;button type=&amp;quot;primary&amp;quot; @click=&amp;quot;submitForm&amp;quot; class=&amp;quot;login-submit&amp;quot;&amp;gt;
      登录
    &amp;lt;/button&amp;gt;
  &amp;lt;/div&amp;gt;
&amp;lt;/template&amp;gt;
&amp;lt;script&amp;gt;
import SIdentify from &amp;quot;../common/identify.vue&amp;quot;;
export default {
  name: &amp;quot;userLogin&amp;quot;,
  components: { SIdentify },
  data() {
    return {
      identifyCodes: &amp;quot;123456789&amp;quot;,
      identifyCode: &amp;quot;&amp;quot;,
      code: &amp;quot;&amp;quot;,
    };
  },
  methods: {
    randomNum(min, max) {
      return Math.floor(Math.random() * (max - min) + min);
    },
    refreshCode() {
      this.identifyCode = &amp;quot;&amp;quot;;
      this.makeCode(4);
    },
    makeCode(l) {
      for (let i = 0; i &amp;lt; l; i++) {
        this.identifyCode +=
          this.identifyCodes[this.randomNum(0, this.identifyCodes.length)];
      }
    },
    submitForm() {
      if (this.identifyCode === this.code) {
        alert(&amp;quot;验证码输入正确&amp;quot;);
      } else {
        alert(&amp;quot;错误&amp;quot;);
      }
    },
  },
  created() {
    this.refreshCode();
  },
};
&amp;lt;/script&amp;gt;

&amp;lt;style scoped&amp;gt;
.img-code-style {
  margin: 10px;
}
#img-code {
  text-align: center;
  margin-top: 10%;
}
&amp;lt;/style&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;2-子组件验证码组件代码&#34;&gt;2、子组件验证码组件代码&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-vue&#34;&gt;&amp;lt;!--子组件验证码组件代码--&amp;gt;
&amp;lt;template&amp;gt;
  &amp;lt;div class=&amp;quot;s-canvas&amp;quot;&amp;gt;
    &amp;lt;canvas
      id=&amp;quot;s-canvas&amp;quot;
      :width=&amp;quot;contentWidth&amp;quot;
      :height=&amp;quot;contentHeight&amp;quot;
    &amp;gt;&amp;lt;/canvas&amp;gt;
  &amp;lt;/div&amp;gt;
&amp;lt;/template&amp;gt;
&amp;lt;script&amp;gt;
export default {
  name: &amp;quot;identify&amp;quot;,
  props: {
    identifyCode: {
      type: String,
      default: &amp;quot;1234&amp;quot;,
    },
    fontSizeMin: {
      type: Number,
      default: 16,
    },
    fontSizeMax: {
      type: Number,
      default: 40,
    },
    backgroundColorMin: {
      type: Number,
      default: 180,
    },
    backgroundColorMax: {
      type: Number,
      default: 240,
    },
    colorMin: {
      type: Number,
      default: 50,
    },
    colorMax: {
      type: Number,
      default: 160,
    },
    lineColorMin: {
      type: Number,
      default: 40,
    },
    lineColorMax: {
      type: Number,
      default: 180,
    },
    dotColorMin: {
      type: Number,
      default: 0,
    },
    dotColorMax: {
      type: Number,
      default: 255,
    },
    contentWidth: {
      type: Number,
      default: 112,
    },
    contentHeight: {
      type: Number,
      default: 38,
    },
  },
  methods: {
    // 生成一个随机数
    randomNum(min, max) {
      return Math.floor(Math.random() * (max - min) + min);
    },
    // 生成一个随机的颜色
    randomColor(min, max) {
      let r = this.randomNum(min, max);
      let g = this.randomNum(min, max);
      let b = this.randomNum(min, max);
      return &amp;quot;rgb(&amp;quot; + r + &amp;quot;,&amp;quot; + g + &amp;quot;,&amp;quot; + b + &amp;quot;)&amp;quot;;
    },
    drawPic() {
      let canvas = document.getElementById(&amp;quot;s-canvas&amp;quot;);
      let ctx = canvas.getContext(&amp;quot;2d&amp;quot;);
      ctx.textBaseline = &amp;quot;bottom&amp;quot;;
      // 绘制背景
      ctx.fillStyle = this.randomColor(
        this.backgroundColorMin,
        this.backgroundColorMax
      );
      ctx.fillRect(0, 0, this.contentWidth, this.contentHeight);
      // 绘制文字
      for (let i = 0; i &amp;lt; this.identifyCode.length; i++) {
        this.drawText(ctx, this.identifyCode[i], i);
      }
      this.drawLine(ctx);
      this.drawDot(ctx);
    },
    drawText(ctx, txt, i) {
      ctx.fillStyle = this.randomColor(this.colorMin, this.colorMax);
      ctx.font =
        this.randomNum(this.fontSizeMin, this.fontSizeMax) + &amp;quot;px SimHei&amp;quot;;
      let x = (i + 1) * (this.contentWidth / (this.identifyCode.length + 1));
      let y = this.randomNum(this.fontSizeMax, this.contentHeight - 5);
      var deg = this.randomNum(-45, 45);
      // 修改坐标原点和旋转角度
      ctx.translate(x, y);
      ctx.rotate((deg * Math.PI) / 180);
      ctx.fillText(txt, 0, 0);
      // 恢复坐标原点和旋转角度
      ctx.rotate((-deg * Math.PI) / 180);
      ctx.translate(-x, -y);
    },
    drawLine(ctx) {
      // 绘制干扰线
      for (let i = 0; i &amp;lt; 8; i++) {
        ctx.strokeStyle = this.randomColor(
          this.lineColorMin,
          this.lineColorMax
        );
        ctx.beginPath();
        ctx.moveTo(
          this.randomNum(0, this.contentWidth),
          this.randomNum(0, this.contentHeight)
        );
        ctx.lineTo(
          this.randomNum(0, this.contentWidth),
          this.randomNum(0, this.contentHeight)
        );
        ctx.stroke();
      }
    },
    drawDot(ctx) {
      // 绘制干扰点
      for (let i = 0; i &amp;lt; 50; i++) {
        ctx.fillStyle = this.randomColor(0, 255);
        ctx.beginPath();
        ctx.arc(
          this.randomNum(0, this.contentWidth),
          this.randomNum(0, this.contentHeight),
          1,
          0,
          2 * Math.PI
        );
        ctx.fill();
      }
    },
  },
  watch: {
    identifyCode() {
      this.drawPic();
    },
  },
  mounted() {
    this.drawPic();
  },
};
&amp;lt;/script&amp;gt;
&amp;lt;style scoped&amp;gt;
.s-canvas {
  height: 38px;
}
.s-canvas canvas {
  margin-top: 1px;
  margin-left: 8px;
}
&amp;lt;/style&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;三-腾讯云滑块验证码&#34;&gt;三、腾讯云滑块验证码&lt;/h4&gt;
&lt;h6 id=&#34;1-配置文件&#34;&gt;1、配置文件&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;#springboot配置文件配置
qq.captcha.open= false
qq.captcha.url= https://ssl.captcha.qq.com/ticket/verify
qq.captcha.appid: 2070825777
qq.captcha.AppSecretKey: 0SMUvPE3rlknblBFBU0ohgA**
//前端index.html引入
&amp;lt;script src=&amp;quot;https://ssl.captcha.qq.com/TCaptcha.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;2-前端调用&#34;&gt;2、前端调用&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-JS&#34;&gt;	//前端调用
    qqCaptchaVarify() {
      var _this = this;
      var captchaId = &amp;quot;2070825777&amp;quot;; //腾讯滑块验证码appid
      //生成一个滑块验证码对象
      var captcha = new TencentCaptcha(captchaId, function (res) {
        if (res.ret == 0) {
          _this
            .$http({
              headers: {
                &amp;quot;Content-Type&amp;quot;: &amp;quot;application/json;charset=utf8&amp;quot;,
              },
              method: &amp;quot;post&amp;quot;,
              url: &amp;quot;/api/studentmanage/student/qqCaptcha&amp;quot;,
              data: {
                Ticket: res.ticket,
                CaptchaAppId: res.appid,
                Randstr: res.randstr,
              },
            })
            .then(
              (res) =&amp;gt; {
                if (res.data) {
                  alert(&amp;quot;成功&amp;quot;);
                } else {
                  alert(&amp;quot;失败&amp;quot;);
                }
              },
              (err) =&amp;gt; {
                alert(&amp;quot;error&amp;quot;);
              }
            );
        }
      });
      // 滑块显示
      captcha.show();
    },
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;3-后端处理&#34;&gt;3、后端处理&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;	// 后端业务逻辑处理
	public Boolean qqCaptcha(HashMap&amp;lt;String, String&amp;gt; mapParam, HttpServletRequest request) {
		Map&amp;lt;String, Object&amp;gt; mapResult = new HashMap&amp;lt;&amp;gt;();
		mapResult.put(&amp;quot;aid&amp;quot;, appid);// 配置文件配置的qq.captcha.aid
		mapResult.put(&amp;quot;AppSecretKey&amp;quot;, AppSecretKey);// 配置文件配置的qq.captcha.AppSecretKey
		mapResult.put(&amp;quot;Ticket&amp;quot;, mapParam.get(&amp;quot;Ticket&amp;quot;));
		mapResult.put(&amp;quot;Randstr&amp;quot;, mapParam.get(&amp;quot;Randstr&amp;quot;));
		mapResult.put(&amp;quot;UserIP&amp;quot;, IPTool.getIpAddress(request));
		// 此处使用了http请求工具类
		String msg = HttpTool.getRequest(url, mapResult);
		/**
		 * response: 1:验证成功，0:验证失败，100:AppSecretKey参数校验错误[required]
		 * evil_level:[0,100]，恶意等级[optional] err_msg:验证错误信息[optional]
		 */
		JSONObject json = JSONObject.parseObject(msg);
		String response = (String) json.get(&amp;quot;response&amp;quot;);
		if (&amp;quot;1&amp;quot;.equals(response)) {
			return true;
		} else {
			return false;
		}
	}
&lt;/code&gt;&lt;/pre&gt;
">图形验证码</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/XtR9Xb2cb/"" data-c="
          &lt;h4 id=&#34;1-vue时间相关方法&#34;&gt;1、vue时间相关方法&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;// 日期转字符串
dateToString(date) {
  var dateInfo = {
    year: date.getFullYear(),
    month: (date.getMonth() + 1 + &amp;quot;&amp;quot;).padStart(2, &amp;quot;0&amp;quot;),
    date: (date.getDate() + &amp;quot;&amp;quot;).padStart(2, &amp;quot;0&amp;quot;),
  };
  var dateStr = dateInfo.year + &amp;quot;-&amp;quot; + dateInfo.month + &amp;quot;-&amp;quot; + dateInfo.date;
  return dateStr;
},
// 获取今天日期
getNowDate() {
  var nowDate = new Date();
  console.log(&amp;quot;今天日期为：&amp;quot; + this.dateToString(nowDate));
},
// 获取指定天数之前的日期
getNumDaysBeforeDate(num) {
  var nowDate = new Date();
  var beforeDate = new Date(nowDate.getTime() - 24 * 60 * 60 * 1000 * num);
  console.log(num + &amp;quot;天之前的日期为：&amp;quot; + this.dateToString(beforeDate);
},
// 获取本周
getNowWeek() {
  var nowDate = new Date();
  var nowTime = nowDate.getTime();
  var week = nowDate.getDay() || 7; // 不加 || 7.周末会变成下周一
  var oneDayTime = 24 * 60 * 60 * 1000;
  var MondayTime = nowTime - (week - 1) * oneDayTime; //显示周一
  var SundayTime = nowTime + (7 - week) * oneDayTime; //显示周日
  console.log(&amp;quot;本周一：&amp;quot; + this.dateToString(new Date(MondayTime));
  console.log(&amp;quot;本周日：&amp;quot; + this.dateToString(new Date(SundayTime));
},
// 获取本月
getNowMonth() {
  var nowDate = new Date();
  var nowDateStr = this.dateToString(nowDate);
  nowDate.setDate(1);
  console.log(&amp;quot;本月1号日期：：&amp;quot; + thi/2s.dateToString(new Date(nowDate));
},
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;2-vue-blob文件类型&#34;&gt;2、vue blob文件类型&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;import axios from &#39;axios&#39;
import { getToken } from &#39;@/utils/auth&#39;

const mimeMap = {
  zip: &#39;application/zip&#39;,
  pdf: &#39;application/pdf&#39;,
  png: &#39;application/png&#39;,
  jpg: &#39;image/jpeg&#39;,
  jpeg: &#39;image/jpeg&#39;,
  xls: &#39;application/vnd.ms-excel&#39;,
  xlsx: &#39;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#39;,
  csv: &#39;application/csv&#39;,
  doc: &#39;application/msword&#39;,
  docx: &#39;application/vnd.openxmlformats-officedocument.wordprocessingml.document&#39;,
  bmp: &#39;image/bmp&#39;,
  gif: &#39;image/gif&#39;,
}

const baseUrl = process.env.VUE_APP_BASE_API
export function downLoadBlob(str, type,filename) {
  var url = baseUrl + str
  axios({
    method: &#39;get&#39;,
    url: url,
    responseType: &#39;blob&#39;,
    headers: { &#39;Authorization&#39;: &#39;Bearer &#39; + getToken() }
  }).then(res =&amp;gt; {
    let mimeType;
    if(type == &#39;zip&#39;){
      mimeType = mimeMap.zip
    }else if(type == &#39;pdf&#39;){
      mimeType = mimeMap.pdf
    }else if(type == &#39;png&#39;){
      mimeType = mimeMap.png
    }else if(type == &#39;jpg&#39;){
      mimeType = mimeMap.jpg
    }else if(type == &#39;jpeg&#39;){
      mimeType = mimeMap.jpeg
    }else if(type == &#39;xls&#39;){
      mimeType = mimeMap.xls
    }else if(type == &#39;xlsx&#39;){
      mimeType = mimeMap.xlsx
    }else if(type == &#39;csv&#39;){
      mimeType = mimeMap.csv
    }else if(type == &#39;doc&#39;){
      mimeType = mimeMap.doc
    }else if(type == &#39;docx&#39;){
      mimeType = mimeMap.docx
    }else if(type == &#39;bmp&#39;){
      mimeType = mimeMap.bmp
    }else if(type == &#39;gif&#39;){
      mimeType = mimeMap.gif
    }
    resolveBlob(res, mimeType, filename)

  })
}
/**
 * 解析blob响应内容并下载
 * @param {*} res blob响应内容
 * @param {String} mimeType MIME类型
 */
export function resolveBlob(res, mimeType,filename) {
  const aLink = document.createElement(&#39;a&#39;)
  var blob = new Blob([res.data], { type: mimeType })
  // 视情况而定
  // 1.从response的headers中获取filename, 后端response.setHeader(&amp;quot;Content-disposition&amp;quot;, &amp;quot;attachment; filename=xxxx.docx&amp;quot;) 设置的文件名;
  // var patt = new RegExp(&#39;filename=([^;]+\\.[^\\.;]+);*&#39;)
  // var contentDisposition = decodeURI(res.headers[&#39;content-disposition&#39;])
  // var result = patt.exec(contentDisposition)
  // var fileName = result[1]
  // fileName = fileName.replace(/\&amp;quot;/g, &#39;&#39;)
  aLink.href = URL.createObjectURL(blob)
  // 2.直接使用自定义文件名
  aLink.setAttribute(&#39;download&#39;, filename) // 设置下载文件名称
  document.body.appendChild(aLink)
  aLink.click()
  document.body.removeChild(aLink);
}
&lt;/code&gt;&lt;/pre&gt;
">vue相关方法</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/F80mUKrNo/"" data-c="
          &lt;h4 id=&#34;mysql删除表的三种用法&#34;&gt;MySQL删除表的三种用法&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;用法：
1、当你不再需要该表时， 用 drop;
2、当你仍要保留该表，但要删除所有记录时， 用 truncate;
3、当你要删除部分记录或者有可能会后悔的话， 用 delete。


删除程度可从强到弱如下排列：
1.  drop table tb;
    drop 是直接将表格删除，无法找回。例如删除 user 表：
    drop table user;
2.  truncate （table） tb;
    truncate 是删除表中所有数据，但不能与where一起使用；
    TRUNCATE TABLE user;
3.  delete from tb (where);
    delete 也是删除表中数据，但可以与where连用，删除特定行；
    -- 删除表中所有数据
    delete from user;
    -- 删除指定行
    delete from user where username =&#39;Tom&#39;;

truncate 和 delete 的区别：
1. 事物
   truncate删除后不记录mysql日志，因此不可以rollback，更不可以恢复数据；而 delete 是可以 rollback;
   原因：truncate 相当于保留原mysql表的结果，重新创建了这个表，所有的状态都相当于新的，而delete的效果相当于一行行删除，所以可以rollback;
2. 效果
   效率上 truncate 比 delete快，而且 truncate 删除后将重建索引（新插入数据后id从0开始记起），而 delete不会删除索引 （新插入的数据将在删除数据的索引后继续增加）
3. truncate 不会触发任何 DELETE触发器；
4. 返回值
   delete 操作后返回删除的记录数，而 truncate 返回的是0或者-1（成功则返回0，失败返回-1）；
   delete 与 delete from 区别：
   如果只针对一张表进行删除，则效果一样；如果需要联合其他表，则需要使用from ：
   delete tb1 from tb1 m where id in (select id from tb2)
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;去除数据库换行空格&#34;&gt;去除数据库换行空格：&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;update test
set info = replace(replace(info,char(10),&#39;&#39;),char(13),&#39;&#39;)
where info like concat(&#39;%&#39;,char(10),&#39;%&#39;);
&lt;/code&gt;&lt;/pre&gt;
">SQL语句</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/tTVsh1r-l/"" data-c="
          &lt;h3 id=&#34;1-开启事件调度器&#34;&gt;1、开启事件调度器&lt;/h3&gt;
&lt;h5 id=&#34;确认是否开启&#34;&gt;确认是否开启&lt;/h5&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;SHOW VARIABLES LIKE &#39;event_scheduler&#39;;
&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&#34;开启命令&#34;&gt;开启命令&lt;/h5&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;SET GLOBAL event_scheduler = ON;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;2-创建事件创建后默认开启&#34;&gt;2、创建事件&amp;lt;创建后默认开启&amp;gt;&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;CREATE EVENT [IF NOT EXISTS] event_name ON SCHEDULE schedule
 [ON COMPLETION [NOT] PRESERVE] [ENABLE | DISABLE] [COMMENT &#39;comment&#39;]
 DO sql_statement;
&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&#34;例如每分钟60s清空一次记录表&#34;&gt;例如：每分钟(60S)清空一次记录表&lt;/h5&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;use database_name;
create event table_truncate on schedule every 60 second do truncate table operator_record_log;
&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&#34;20211227补充每30天2592000s清空30天前的所有记录仅保留近30天数据&#34;&gt;&amp;lt;2021.12.27&amp;gt;补充：每30天(2592000S)清空30天前的所有记录，仅保留近30天数据&lt;/h5&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;use database_name;
create event table_truncate on schedule every 2592000 second do delete from operator_record_log where create_date &amp;lt; DATE_SUB(CURDATE(),INTERVAL 30 DAY);
&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&#34;例如指定时间将表清空&#34;&gt;例如：指定时间将表清空&lt;/h5&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;use database_name;
create event table_truncate on schedule at timestamp &#39;2022-01-01 00:00:00&#39; do truncate table operator_record_log;
&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&#34;例如每天定时清空&#34;&gt;例如：每天定时清空&lt;/h5&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;use database_name;
create event table_truncate on schedule every 1 day starts &#39;2022-01-01 00:00:00&#39; do truncate table operator_record_log;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;3-关闭事件&#34;&gt;3、关闭事件&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;alter event event_name disable;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;4-开启事件&#34;&gt;4、开启事件&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;alter event event_name enable;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;5-删除事件&#34;&gt;5、删除事件&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;drop event if exists event_name;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;6-查看事件&#34;&gt;6、查看事件&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;show events;
&lt;/code&gt;&lt;/pre&gt;
">MySQL数据库定时删除数据</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/pKY5mSIwr/"" data-c="
          &lt;p&gt;程序可能出现崩溃级的bug，但这种bug可能十天半月才出现一次。修改起来比较困难，验证也非常耗时。这时候为了保证程序持续稳定运行，就需要一个监控程序了。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;功能&lt;/strong&gt;：监控进程 demo-admin.jar 是否存在，如果不存在就启动它。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;实现方式&lt;/strong&gt;：使用&lt;a href=&#34;https://so.csdn.net/so/search?q=crontab&amp;amp;spm=1001.2101.3001.7020&#34;&gt;crontab&lt;/a&gt; -e 添加定时任务, 每分钟都执行脚本文件 demo_startup.sh&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;脚本&lt;/strong&gt;：demo_startup.sh： 判断进程demo-admin.jar是否存在，不存在就执行 nohup java -jar demo-admin.jar &amp;amp; ，如果存在就忽略。&lt;/p&gt;
&lt;h5 id=&#34;1-在linux-shell中输入-crontab-e-在打开的文件中填入以下信息并保存设置的定时任务就生效了&#34;&gt;&lt;strong&gt;1、在linux shell中输入 crontab -e ， 在打开的文件中填入以下信息并保存，设置的定时任务就生效了。&lt;/strong&gt;&lt;/h5&gt;
&lt;pre&gt;&lt;code&gt;*/1 * * * * sh /work/demo_startup.sh
&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&#34;2-查看设置的定时任务信息&#34;&gt;&lt;strong&gt;2、查看设置的定时任务信息&lt;/strong&gt;&lt;/h5&gt;
&lt;pre&gt;&lt;code&gt;crontab -l
*/1 * * * * sh /work/demo_startup.sh
0 23 * * 6   每周六晚上11点
&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&#34;3-demo_startupsh的中具体内容&#34;&gt;**3、demo_startup.sh的中具体内容&lt;/h5&gt;
&lt;h6 id=&#34;示例&#34;&gt;示例：&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;\#!/bin/sh
source /etc/profile
ps -fe | grep demo-admin | grep -v grep
if [ $? -ne 0 ]
then
cd /work
nohup java -jar demo-admin.jar &amp;amp;
echo &amp;quot;running runing.....&amp;quot;
else
echo &amp;quot;runing.....&amp;quot;
fi
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;备份mysql的demo_startupsh&#34;&gt;备份MySQL的demo_startup.sh&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;/usr/local/mysql/bin/mysqldump --defaults-extra-file=/etc/my.cnf studentmanage &amp;gt; /home/dbback/studentmanage_$(date +%Y%m%d_%H%M%S).sql
&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&#34;4-如何查看定时任务日志文件&#34;&gt;&lt;strong&gt;4、如何查看定时任务日志文件&lt;/strong&gt;&lt;/h5&gt;
&lt;pre&gt;&lt;code&gt;/var/log/cron.log
&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&#34;5-定时任务日志格式说明&#34;&gt;&lt;strong&gt;5、定时任务日志格式说明&lt;/strong&gt;&lt;/h5&gt;
&lt;pre&gt;&lt;code&gt;crontab文件的含义：

用户建立的crontab文件中，每一行代表一项任务，每行的每个字段代表一项设置。它的格式共分为六个字段，前五段是时间设定段，第六段是要执行的命令段，格式如下：

minute hour day month week command

其中：

minute： 表示分钟，可以是从0到59之间的任何整数。

hour：表示小时，可以是从0到23之间的任何整数。

day：表示日期，可以是从1到31之间的任何整数。

month：表示月份，可以是从1到12之间的任何整数。

week：表示星期几，可以是从0到7之间的任何整数，这里的0或7代表星期日。

command：要执行的命令，可以是系统命令，也可以是自己编写的脚本文件。

**在以上各个字段中，还可以使用以下特殊字符：**

星号（*）：代表所有可能的值，例如month字段如果是星号，则表示在满足其它字段的制约条件后每月都执行该命令操作。

逗号（,）：可以用逗号隔开的值指定一个列表范围，例如，“1,2,5,7,8,9”

中杠（-）：可以用整数之间的中杠表示一个整数范围，例如“2-6”表示“2,3,4,5,6”

正斜线（/）：可以用正斜线指定时间的间隔频率，例如“0-23/2”表示每两小时执行一次。同时正斜线可以和星号一起使用，例如*/10，如果用在minute字段，表示每十分钟执行一次。

grep -v grep 是去掉包含grep的行

&amp;gt; \# ps -ef | grep demo | grep -v grep
&amp;gt; root 11996 1 0 12:08 ? 00:00:38 java -jar demo-admin.jar -Dspring.profiles.active=prod

##### **6、配置定时任务**

cron有两个配置文件，一个是一个全局配置文件（/etc/crontab），是针对系统任务的；一组是crontab命令生成的配置文件（/var/spool/cron下的文件）

查看用户下的定时任务:crontab -l或cat /var/spool/cron/用户名

实例1：每1分钟执行一次command

命令：* * * * * command

实例2：每小时的第3和第15分钟执行

命令：3,15 * * * * command

实例3：在上午8点到11点的第3和第15分钟执行

命令：3,15 8-11 * * * command

实例4：每隔两天的上午8点到11点的第3和第15分钟执行

命令：3,15 8-11 */2 * * command

实例5：每个星期一的上午8点到11点的第3和第15分钟执行

命令：3,15 8-11 * * 1 command

##### **7、crond服务启动/关闭/重启**

service crond status //查看服务器状态

service crond start //启动服务

service crond stop //关闭服务

service crond restart //重启服务

service crond reload //重新载入配置

##### **8、与cron相关的目录和文件**

/etc/crontab：系统定时任务，只能root用户使用，格式与crontab也不一样。

/var/spool/cron 目录 ：通过crontab命令添加的定时任务会以添加的账号命名放在此目录下

/etc/cron.d：这个目录里包含不同的用户的定时任务

/etc/cron.deny：禁止使用cron的用户列表文件

/etc/cron.allow：允许使用cron的用户列表文件

/etc/cron.daily：存放每天执行一次的脚本

/etc/cron.hourly：存放每个小时执行一个的脚本

/etc/cron.monthly：存放每个月执行一次的脚本

/etc/cron.weekly：存放每个星期执行一个的脚本
&lt;/code&gt;&lt;/pre&gt;
">Linux系统利用crontab定时备份Mysql数据库方法</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/WS_8n2pOu/"" data-c="
          &lt;h4 id=&#34;一-下载安装包&#34;&gt;一、下载安装包&lt;/h4&gt;
&lt;h6 id=&#34;访问httpsredisiodownload-到官网进行下载-这里下载最新的40版本&#34;&gt;访问https://redis.io/download 到官网进行下载。这里下载最新的4.0版本&lt;/h6&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/05/11/ee4f8d2c7cf177ba.png&#34; alt=&#34;image-20211029103735678&#34; style=&#34;zoom:50%;margin:0&#34; /&gt;
&lt;h4 id=&#34;二-安装&#34;&gt;二、安装&lt;/h4&gt;
&lt;h6 id=&#34;1通过远程管理工具将压缩包拷贝到linux服务器中执行解压操作输入命令&#34;&gt;1.通过远程管理工具，将压缩包拷贝到Linux服务器中，执行解压操作，输入命令：&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;tar -zxf redis-4.0.9.tar.gz
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/05/11/b499ff41e7e9b46e.png&#34; alt=&#34;image-20211029103735678&#34; style=&#34;margin:0&#34; /&gt;
&lt;h6 id=&#34;2进入解压文件目录使用make对解压的redis文件进行编译&#34;&gt;2.进入解压文件目录使用make对解压的Redis文件进行编译&lt;/h6&gt;
&lt;p&gt;图示：这里因为我redis的安装目录在 /usr/local/  目录下，因此会有如下操作&lt;/p&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/05/11/a8469c10452d2a4a.png&#34; alt=&#34;image-20211029103735678&#34; style=&#34;margin:0&#34; /&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/05/11/8b7083fae6003e81.png&#34; alt=&#34;image-20211029103735678&#34; style=&#34;margin:0&#34; /&gt;
&lt;p&gt;注：如果在编译过程中出现问题，有可能是安装包下载的有误，这里可以尝试的用别人下载的安装包或者直接用&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;wget http://download.redis.io/releases/redis-4.0.9.tar.gz
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;如果发现上述读不能解决问题，请参照该链接：https://www.cnblogs.com/liu2-/p/6914159.html&lt;br&gt;
编译完成之后，可以看到解压文件redis-3.0.7 中会有对应的src、conf等文件夹&lt;/p&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/05/11/fca5fa05c3ae91be.png&#34; alt=&#34;image-20211029103735678&#34; style=&#34;margin:0&#34; /&gt;
&lt;h6 id=&#34;3编译成功后进入src文件夹执行make-install进行redis安装如下图示安装完成界面如下&#34;&gt;3.编译成功后，进入src文件夹，执行make install进行Redis安装，如下图示安装完成，界面如下：&lt;/h6&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/05/11/d92bc8d8c97a5277.png&#34; alt=&#34;image-20211029103735678&#34; style=&#34;margin:0&#34; /&gt;
&lt;h4 id=&#34;三-部署&#34;&gt;三、部署&lt;/h4&gt;
&lt;h6 id=&#34;1为了方便管理将redis文件中的conf配置文件和常用命令移动到统一文件中&#34;&gt;1.为了方便管理，将Redis文件中的conf配置文件和常用命令移动到统一文件中&lt;/h6&gt;
&lt;p&gt;1）、创建bin和etc文件，如图示：&lt;/p&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/05/11/ff87725c6466df34.png&#34; alt=&#34;image-20211029103735678&#34; style=&#34;margin:0&#34; /&gt;
&lt;p&gt;2）、回到刚刚安装目录，找到redis.conf，将其复制移动到 /usr/local/redis/ect 下，执行命令如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mv redis.conf /usr/local/redis/etc/
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/05/11/5197198f3a1705f6.png&#34; alt=&#34;image-20211029103735678&#34; style=&#34;margin:0&#34; /&gt;
&lt;p&gt;进入src目录，移动mkreleasehdr.sh redis-benchmark redis-check-aof redis-check-rdb redis-cli redis-server到/usr/local/redis/bin/，执行命令 ：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mv mkreleasehdr.sh redis-benchmark redis-check-aof redis-check-rdb redis-cli redis-server /usr/local/redis/bin/
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/05/11/bb5a8da5d41fe33c.png&#34; alt=&#34;image-20211029103735678&#34; style=&#34;margin:0&#34; /&gt;
&lt;p&gt;依次查看移动后文件&lt;/p&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/05/11/5417e9f47d05cd56.png&#34; alt=&#34;image-20211029103735678&#34; style=&#34;margin:0&#34; /&gt;
&lt;h6 id=&#34;2-执行redis-server-启动redis&#34;&gt;2、执行redis-server 启动redis&lt;/h6&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/05/11/9fa0c9f865c97e3e.png&#34; alt=&#34;image-20211029103735678&#34; style=&#34;margin:0&#34; /&gt;
&lt;h6 id=&#34;3-设置绑定ip注该步骤如果不需要可省略&#34;&gt;3、设置绑定ip（注：该步骤如果不需要可省略）&lt;/h6&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/05/11/5b4d0f4c620030d0.png&#34; alt=&#34;image-20211029103735678&#34; style=&#34;margin:0&#34; /&gt;
&lt;p&gt;如需要，可将上图绑定ip改为指定ip。&lt;/p&gt;
&lt;h6 id=&#34;4-设置后台启动redis&#34;&gt;4、设置后台启动redis&lt;/h6&gt;
&lt;p&gt;1）、首先编辑conf文件，将daemonize属性改为yes（表明需要在后台运行）&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cd etc/
vim redis.conf
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/05/11/e1f304caeb729730.png&#34; alt=&#34;image-20211029103735678&#34; style=&#34;margin:0&#34; /&gt;
&lt;p&gt;将no修改为yes&lt;/p&gt;
&lt;p&gt;2)、再次启动redis服务，并指定启动服务配置文件&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;redis-server /usr/local/redis/etc/redis.conf
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;https://s3.bmp.ovh/imgs/2024/05/11/77d362cc1128a85f.png&#34; alt=&#34;image-20211029103735678&#34; style=&#34;margin:0&#34; /&gt;
&lt;p&gt;配置后台运行成功。``&lt;/p&gt;
">Linux安装Redis</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/6ZJCzf030/"" data-c="
          &lt;h4 id=&#34;一-nginx下载&#34;&gt;一、Nginx下载&lt;/h4&gt;
&lt;p&gt;官网下载：http://nginx.org/en/download.html&lt;/p&gt;
&lt;p&gt;或者直接在linux执行命令：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;wget http://nginx.org/download/nginx-1.12.2.tar.gz
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这里下载的版本是1.12.2&lt;/p&gt;
&lt;h4 id=&#34;二-安装步骤&#34;&gt;二、安装步骤&lt;/h4&gt;
&lt;p&gt;# 安装依赖&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;yum -y install gcc zlib zlib-devel pcre-devel openssl openssl-devel
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;# 解压缩&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;tar -zxvf linux-nginx-1.12.2.tar.gz
cd nginx-1.12.2/
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;# 执行配置&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;./configure
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;# 编译安装(默认安装在/usr/local/nginx)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make
make install
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;三-操作命令&#34;&gt;三、操作命令&lt;/h4&gt;
&lt;p&gt;启动&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/usr/local/nginx/sbin/nginx
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;重新加载：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/usr/local/nginx/sbin/nginx -s reload
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;停止&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/usr/local/nginx/sbin/nginx -s stop
或
/usr/local/nginx/sbin/nginx -s quit
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;查看进程&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ps -ef|grep nginx
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;杀死进程&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kill -quit 1212
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;查看配置文件是否正确&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;./nginx -t
&lt;/code&gt;&lt;/pre&gt;
">Linux安装Nginx</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/cPnHj5SCw/"" data-c="
          &lt;p&gt;Mysql数据库的安装对于开发者来说，是我们必然会面对的问题，它的安装过程其实并不复杂，并且网络上的安装教程也非常多，但是对于新手来说，各种不同形式的安装教程，又给新手们带来了要选择哪种方式进行安装的难题，而且很多时候按照教程也没有能够安装成功，安装过程出现各种各样的错误。&lt;/p&gt;
&lt;p&gt;下面记录了我在Linux(Centos 7)环境下安装Mysql的完整过程，实操记录，绝非水文，如有错误或遗漏，欢迎指正。&lt;/p&gt;
&lt;p&gt;本文档讲解安装版本为mysql-5.7.24，对于5.7.24之后的版本，不适用此说明文档，主要原因在于之后版本的mysql配置文件的目录位置和结构有所改变，使用此说明可能会出现找不到配置文件或者配置后不生效的情况。&lt;/p&gt;
&lt;p&gt;安装过程中务必保证文件路径的前后统一，否则可能会导致不可预期的结果，推荐直接使用文中的命令进行操作。&lt;/p&gt;
&lt;h4 id=&#34;一-安装前准备&#34;&gt;一 、安装前准备&lt;/h4&gt;
&lt;h6 id=&#34;1-检查是否已经安装过mysql&#34;&gt;1、检查是否已经安装过mysql&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;执行命令
[root@localhost /]# rpm -qa | grep mysql

从执行结果，可以看出我们已经安装了mysql-libs-5.1.73-5.el6_6.x86_64，执行删除命令
[root@localhost /]# rpm -e --nodeps mysql-libs-5.1.73-5.el6_6.x86_64

再次执行查询命令，查看是否删除
[root@localhost /]# rpm -qa | grep mysql
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;2-查询所有mysql对应的文件夹&#34;&gt;2、查询所有Mysql对应的文件夹&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;[root@localhost /]# whereis mysql
mysql: /usr/bin/mysql /usr/include/mysql
[root@localhost lib]# find / -name mysql
/data/mysql
/data/mysql/mysql

删除相关目录或文件
[root@localhost /]# rm -rf /usr/bin/mysql /usr/include/mysql /data/mysql /data/mysql/mysql 

验证是否删除完毕
[root@localhost /]# whereis mysql
mysql:
[root@localhost /]# find / -name mysql
[root@localhost /]# 
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;3-检查mysql用户组和用户是否存在如果没有则创建&#34;&gt;3、检查mysql用户组和用户是否存在，如果没有，则创建&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;[root@localhost /]# cat /etc/group | grep mysql
[root@localhost /]# cat /etc/passwd |grep mysql
[root@localhost /]# groupadd mysql
[root@localhost /]# useradd -r -g mysql mysql
[root@localhost /]# 
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;4-从官网下载是用于linux的mysql安装包&#34;&gt;4、从官网下载是用于Linux的Mysql安装包&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;下载命令：
[root@localhost /]# wget https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.24-linux-glibc2.12-x86_64.tar.gz
也可以直接到 mysql官网 选择对应版本进行下载。
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;二-安装mysql&#34;&gt;二 、安装Mysql&lt;/h4&gt;
&lt;h6 id=&#34;1-找到mysql安装包&#34;&gt;1、找到Mysql安装包&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;在执行wget命令的目录下或你的上传目录下找到Mysql安装包：mysql-5.7.24-linux-glibc2.12-x86_64.tar.gz
执行解压命令：
[root@localhost /]# tar xzvf mysql-5.7.24-linux-glibc2.12-x86_64.tar.gz

[root@localhost /]# ls
mysql-5.7.24-linux-glibc2.12-x86_64
mysql-5.7.24-linux-glibc2.12-x86_64.tar.gz
解压完成后，可以看到当前目录下多了一个解压文件，移动该文件到/usr/local/下，并将文件夹名称修改为mysql。

如果/usr/local/下已经存在mysql，请将已存在mysql文件修改为其他名称，否则后续步骤可能无法正确进行。

执行命令如下：
[root@localhost /]# mv mysql-5.7.24-linux-glibc2.12-x86_64 /usr/local/
[root@localhost /]# cd /usr/local/
[root@localhost /]# mv mysql-5.7.24-linux-glibc2.12-x86_64 mysql

如果/usr/local/下不存在mysql文件夹，直接执行如下命令，也可达到上述效果。
[root@localhost /]# mv mysql-5.7.24-linux-glibc2.12-x86_64 /usr/local/mysql
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;2-在usrlocalmysql目录下创建data目录&#34;&gt;2、在/usr/local/mysql目录下创建data目录&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;[root@localhost /]# mkdir /usr/local/mysql/data
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;3-更改mysql目录下所有的目录及文件夹所属的用户组和用户以及权限&#34;&gt;3、更改mysql目录下所有的目录及文件夹所属的用户组和用户，以及权限&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;[root@localhost /]# chown -R mysql:mysql /usr/local/mysql
[root@localhost /]# chmod -R 755 /usr/local/mysql
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;4-编译安装并初始化mysql务必记住初始化输出日志末尾的密码数据库管理员临时密码&#34;&gt;4、编译安装并初始化mysql,务必记住初始化输出日志末尾的密码（数据库管理员临时密码）&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;[root@localhost /]# cd /usr/local/mysql/bin
[root@localhost bin]# ./mysqld --initialize --user=mysql --datadir=/usr/local/mysql/data --basedir=/usr/local/mysql

补充说明：
第4步时，可能会出现错误：
出现该问题首先检查该链接库文件有没有安装使用 命令进行核查
[root@localhost bin]# rpm -qa|grep libaio   
[root@localhost bin]# 
运行命令后发现系统中无该链接库文件
[root@localhost bin]# yum install  libaio-devel.x86_64
安装成功后，继续运行数据库的初始化命令，此时可能会出现如下错误：

执行如下命令后：
[root@localhost bin]# yum -y install numactl
执行无误之后，再重新执行第4步初始化命令，无误之后再进行第5步操作！
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;5-运行初始化命令成功后输出日志&#34;&gt;5、运行初始化命令成功后，输出日志&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;记录日志最末尾位置root@localhost:后的字符串，此字符串为mysql管理员临时登录密码。
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;6-编辑配置文件mycnf添加配置如下&#34;&gt;6、编辑配置文件my.cnf，添加配置如下&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;[root@localhost bin]#  vi /etc/my.cnf

[mysqld]
datadir=/usr/local/mysql/data
port=3306
sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES
symbolic-links=0
max_connections=600
innodb_file_per_table=1
lower_case_table_names=1
character_set_server=utf8

参数说明
lower_case_table_names：是否区分大小写，1表示存储时表名为小写，操作时不区分大小写；0表示区分大小写；不能动态设置，修改后，必须重启才能生效：
character_set_server：设置数据库默认字符集，如果不设置默认为latin1
innodb_file_per_table：是否将每个表的数据单独存储，1表示单独存储；0表示关闭独立表空间，可以通过查看数据目录，查看文件结构的区别；
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;7-测试启动mysql服务器&#34;&gt;7、测试启动mysql服务器&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;[root@localhost /]# /usr/local/mysql/support-files/mysql.server start

异常情况
如果出现如下提示信息
Starting MySQL... ERROR! The server quit without updating PID file
查看是否存在mysql和mysqld的服务，如果存在，则结束进程，再重新执行启动命令

#查询服务
ps -ef|grep mysql | grep -v grep
ps -ef|grep mysqld | grep -v grep

#结束进程
kill -9 PID

#启动服务
/usr/local/mysql/support-files/mysql.server start
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;8-添加软连接并重启mysql服务&#34;&gt;8、添加软连接，并重启mysql服务&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;[root@localhost /]# ln -s /usr/local/mysql/support-files/mysql.server /etc/init.d/mysql 
[root@localhost /]# ln -s /usr/local/mysql/bin/mysql /usr/bin/mysql
[root@localhost /]# service mysql restart
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;9-登录mysql修改密码密码为步骤5生成的临时密码&#34;&gt;9、登录mysql，修改密码(密码为步骤5生成的临时密码)&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;[root@localhost /]# mysql -u root -p
Enter password:
mysql&amp;gt;set password for root@localhost = password(&#39;yourpass&#39;);
注意：输入密码时，Enter password 后面不会有任何显示，此时实际是输入成功的，输入完密码后直接回车即可。或使用：mysql -u root -p 密码 ，回车后，即可直接进入数据库
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;10-开放远程连接&#34;&gt;10、开放远程连接&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt;use mysql;
msyql&amp;gt;update user set user.Host=&#39;%&#39; where user.User=&#39;root&#39;;
mysql&amp;gt;flush privileges;
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;11-设置开机自动启动&#34;&gt;11、设置开机自动启动&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;将服务文件拷贝到init.d下，并重命名为mysql
[root@localhost /]# cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysqld

赋予可执行权限
[root@localhost /]# chmod +x /etc/init.d/mysqld

添加服务
[root@localhost /]# chkconfig --add mysqld

显示服务列表
[root@localhost /]# chkconfig --list
至此，mysql5.7.24版本的数据库安装，已经完成。
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;三-linux下mysql-查看默认端口号与修改端口号方法&#34;&gt;三、linux下mysql 查看默认端口号与修改端口号方法&lt;/h4&gt;
&lt;h6 id=&#34;查看默认端口号&#34;&gt;查看默认端口号&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;1、登录mysql
[root@localhost ~]# mysql -uroot -p
Enter password: 输入数据库密码；

2、使用show global variables like &#39;port&#39;; 命令查看端口号,
mysql&amp;gt; show global variables like &#39;port&#39;;
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| port          | 3306  |
+---------------+-------+
1 row in set (0.00 sec)

mysql&amp;gt; 
3306即为端口号。
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;mysql端口号的修改&#34;&gt;mysql端口号的修改&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;1、编辑/etc/my.cnf文件  [root@localhost ~]# vi /etc/my.cnf
2、添加port=2032;
3、重启mysql [root@localhost ~]# /etc/init.d/mysqld restart
&lt;/code&gt;&lt;/pre&gt;
">Linux安装MySQL</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/pJwY93GOW/"" data-c="
          &lt;h4 id=&#34;方式一yum方式下载安装&#34;&gt;方式一：yum方式下载安装&lt;/h4&gt;
&lt;h6 id=&#34;1-查找java相关的列表&#34;&gt;1、查找java相关的列表&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;yum -y list java*
或者
yum search jdk
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;2-安装jdk&#34;&gt;2、安装jdk&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;yum install java-1.8.0-openjdk.x86_64
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;3-完成安装后验证&#34;&gt;3、完成安装后验证&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;java -version
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;4-通过yum安装的默认路径为usrlibjvm&#34;&gt;4、通过yum安装的默认路径为：/usr/lib/jvm&lt;/h6&gt;
&lt;h6 id=&#34;5-将jdk的安装路径加入到java_home&#34;&gt;5、将jdk的安装路径加入到JAVA_HOME&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;vi /etc/profile

在文件最后加入：
#set java environment
JAVA_HOME=/usr/lib/jvm/jre-1.6.0-openjdk.x86_64
PATH=$PATH:$JAVA_HOME/bin
CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar
export JAVA_HOME CLASSPATH PATH

修改/etc/profile之后让其生效
. /etc/profile （注意 . 之后应有一个空格）
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;方式二官网下载jdkftp上传服务器解压安装&#34;&gt;方式二：官网下载jdk，ftp上传服务器解压安装&lt;/h4&gt;
&lt;h6 id=&#34;1-进入-oracle-官方网站-下载合适的-jdk-版本准备安装&#34;&gt;1、进入 Oracle 官方网站 下载合适的 JDK 版本，准备安装。&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;注意：这里需要下载 Linux 版本。这里以jdk-8u151-linux-x64.tar.gz为例，你下载的文件可能不是这个版本，这没关系，只要后缀(.tar.gz)一致即可。
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;2-创建目录&#34;&gt;2、创建目录&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;在/usr/目录下创建java目录，
mkdir /usr/local/java
cd /usr/local/java
把下载的文件 jdk-8u151-linux-x64.tar.gz 放在/usr/local/java/目录下。
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;3-解压-jdk&#34;&gt;3、解压 JDK&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;tar -zxvf jdk-8u151-linux-x64.tar.gz
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;4-设置环境变量&#34;&gt;4、设置环境变量&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;修改 vi /etc/profile
在 profile 文件中添加如下内容并保存：
set java environment
JAVA_HOME=/usr/local/java/jdk1.8.0_151        
JRE_HOME=/usr/local/java/jdk1.8.0_151/jre     
CLASS_PATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib
PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin
export JAVA_HOME JRE_HOME CLASS_PATH PATH
 
注意：其中 JAVA_HOME， JRE_HOME 请根据自己的实际安装路径及 JDK 版本配置。

让修改生效：
source /etc/profile
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;测试和运行&#34;&gt;测试和运行&lt;/h4&gt;
&lt;h6 id=&#34;1-测试是否安装成功&#34;&gt;1、测试是否安装成功&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;java -version
显示 java 版本信息，则说明 JDK 安装成功
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;2-运行jar项目&#34;&gt;2、运行jar项目&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;运行jar包通常我们都会以下面的方式运行:
java -jar babyshark-0.0.1-SNAPSHOT.jar

这样运行的话会有一个问题，就是我们一关闭当前窗口就会停止运行项目，要想解决这个问题，就需要在后台运行。
nohup java -jar shop-0.0.1-SNAPSHOT.jar &amp;gt; log.file  2&amp;gt;&amp;amp;1 &amp;amp;
上面的2 和 1 的意思如下:
0    标准输入（一般是键盘）
1    标准输出（一般是显示屏，是用户终端控制台）
2    标准错误（错误信息输出）

将运行的jar 错误日志信息输出到log.file文件中，然后（&amp;gt;&amp;amp;1）就是继续输出到标准输出(前面加的&amp;amp;，是为了让系统识别是标准输出)，最后一个&amp;amp;,表示在后台运行。
nohup java -jar shop-0.0.1-SNAPSHOT.jar &amp;gt; log.file  2&amp;gt;&amp;amp;1 &amp;amp;

查找运行的pid
netstat -anp

查找java进程运行的pid
ps -ef|grep java

杀死进程
kill -9 pid
&lt;/code&gt;&lt;/pre&gt;
">Linux安装JDK</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/qVu2LurYm/"" data-c="
          &lt;h4 id=&#34;1-项目配置&#34;&gt;1、项目配置&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;# 数据源配置
server.port=3000
spring.datasource.url=jdbc:mysql://127.0.0.1:3306/xxxx?useUnicode=true&amp;amp;characterEncoding=UTF-8&amp;amp;useSSL=false
spring.datasource.username=root
spring.datasource.password=root
spring.datasource.driver-class-name=com.mysql.jdbc.Driver
spring.devtools.restart.enabled=true

# 日期格式转换
spring.jackson.date-format=yyyy-MM-dd HH:mm:ss
spring.jackson.time-zone=GMT+8

# 实体类映射
mybatis-plus.type-aliases-package=com.xxxx.xxxx.model

# 打印SQL
logging.level.com.abjy.studentmanage.mapper=debug

# mybatis-plus配置
mybatis-plus.global-config.id-type=5
mybatis-plus.global-config.field-strategy=0
mybatis-plus.global-config.db-column-underline=true
mybatis-plus.global-config.refresh-mapper=true
mybatis-plus.global-config.capital-mode=true
mybatis-plus.global-config.logic-delete-value=0
mybatis-plus.global-config.logic-not-delete-value=1
mybatis-plus.configuration.map-underscore-to-camel-case=true
mybatis-plus.configuration.cache-enabled=false
mybatis-plus.global-config.sql-injector=com.baomidou.mybatisplus.mapper.LogicSqlInjector

#redis配置
spring.redis.database=0
spring.redis.host=127.0.0.1
spring.redis.port=6379
spring.redis.password=&amp;quot;&amp;quot;
spring.redis.jedis.pool.max-active=8
spring.redis.jedis.pool.max-wait=-1
spring.redis.jedis.pool.max-idle=8
spring.redis.jedis.pool.min-idle=0
spring.redis.timeout=5000

# 文件上传配置
spring.servlet.multipart.max-request-size=5MB
spring.servlet.multipart.max-file-size=1MB

# 公用参数配置
student.file.diskPath: /home/statics/students/
# 使用
# @Value(&amp;quot;${student.file.diskPath}&amp;quot;)
# private String diskPath;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;2-mybatis-plus分页配置&#34;&gt;2、mybatis-plus分页配置&lt;/h4&gt;
&lt;h6 id=&#34;配置类&#34;&gt;配置类&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import com.baomidou.mybatisplus.plugins.PaginationInterceptor;
import org.mybatis.spring.annotation.MapperScan;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.transaction.annotation.EnableTransactionManagement;
 
/**
 * @author liuyang
 * @date 2018/3/14
 */
@EnableTransactionManagement
@Configuration
@MapperScan(&amp;quot;com.xxxx.mapper&amp;quot;) //修改为mapper包路径
public class MybatisPlusConfig {
 
    /**
     * mybatis-plus分页插件&amp;lt;br&amp;gt;
     * 文档：http://mp.baomidou.com&amp;lt;br&amp;gt;
     */
    @Bean
    public PaginationInterceptor paginationInterceptor() {
        PaginationInterceptor paginationInterceptor = new PaginationInterceptor();
        return paginationInterceptor;
    }
 
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;mapper接口&#34;&gt;mapper接口&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;List&amp;lt;Model&amp;gt; getList(@Param(&amp;quot;page&amp;quot;) Pagination page, Model model);
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;service类&#34;&gt;service类&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;Map&amp;lt;String, Object&amp;gt; getList(HashMap&amp;lt;String, String&amp;gt; mapParam);
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;serviceimpl实现类&#34;&gt;serviceImpl实现类&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;	@Override
	public Map&amp;lt;String, Object&amp;gt; getList(HashMap&amp;lt;String, String&amp;gt; mapParam){
		Map&amp;lt;String, Object&amp;gt; mapResult = new HashMap&amp;lt;&amp;gt;();
		// 分页变量
		Integer currentPage = Integer.parseInt(mapParam.get(&amp;quot;currentPage&amp;quot;));
		Integer pageSize = Integer.parseInt(mapParam.get(&amp;quot;pageSize&amp;quot;));
		Page page = new Page&amp;lt;&amp;gt;(currentPage, pageSize);
        // 实体类，用于模糊查询
        Model model = new Model();
		Integer allCount = mapper.getListCount(model); // 查询总数量的SQL
		Integer pageNumber = (int) Math.ceil((double) allCount / pageSize);
		mapResult.put(&amp;quot;list&amp;quot;, mapper.getList(page, model));
		mapResult.put(&amp;quot;allCount&amp;quot;, allCount);
		mapResult.put(&amp;quot;pageNumber&amp;quot;, pageNumber);
		return mapResult;
	}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;3-静态资源访问路径&#34;&gt;3、静态资源访问路径&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.client.RestTemplate;
import org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

/**
 * 配置静态资源访问路径
 * @author Administrator
 *
 */
@Configuration
public class ResourceConfig implements WebMvcConfigurer{
	
	    @Override
	    public void addResourceHandlers(ResourceHandlerRegistry registry) {
	        registry.addResourceHandler(&amp;quot;/static/**&amp;quot;).addResourceLocations(&amp;quot;classpath:/images/&amp;quot;);
	    }
	    
	    @Bean
	    public RestTemplate restTemplate() {
	        return new RestTemplate();
	    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;4-拦截器配置&#34;&gt;4、拦截器配置&lt;/h4&gt;
&lt;h5 id=&#34;1旧版本会出现警告信息&#34;&gt;（1）旧版本会出现警告信息&lt;/h5&gt;
&lt;h6 id=&#34;sessioninterceptorjava&#34;&gt;SessionInterceptor.java&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.util.concurrent.TimeUnit;

import javax.annotation.PostConstruct;
import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.redis.core.StringRedisTemplate;
import org.springframework.stereotype.Component;
import org.springframework.web.servlet.HandlerInterceptor;
import org.springframework.web.servlet.ModelAndView;

@Component
public class SessionInterceptor implements HandlerInterceptor{
	
	/**
     * 进入controller层之前拦截请求
     * @param httpServletRequest
     * @param httpServletResponse
     * @param o
     * @return
     * @throws Exception
     */
    @Override
    public boolean preHandle(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o) throws Exception {
    	System.out.println(&amp;quot;------------进入拦截器之前-------------&amp;quot;);
    }

    @Override
    public void postHandle(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, ModelAndView modelAndView) throws Exception {
		System.out.println(&amp;quot;------------视图渲染完毕后-------------&amp;quot;);
    }

    @Override 
    public void afterCompletion(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, Exception e) throws Exception {
		System.out.println(&amp;quot;------------进入拦截器之后-------------&amp;quot;);
    } 
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;interceptorconfigjava&#34;&gt;InterceptorConfig.java&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.InterceptorRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;

import com.wowmake.aftersale.tools.SessionInterceptor;

/**
 * 拦截器配置
 * @author Administrator
 *
 */
@Configuration
public class InterceptorConfig extends WebMvcConfigurerAdapter{
	
    @Override
    public void addInterceptors(InterceptorRegistry registry){
        registry.addInterceptor(new SessionInterceptor())
		//拦截的路径
        .addPathPatterns(&amp;quot;/**&amp;quot;)
        //设置不拦截的路径
        .excludePathPatterns(&amp;quot;/user/login/**&amp;quot;)
        // 静态资源不拦截
        .excludePathPatterns(&amp;quot;/images/**&amp;quot;);
        super.addInterceptors(registry);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&#34;2新版本拦截器更改&#34;&gt;（2）新版本拦截器更改&lt;/h5&gt;
&lt;h6 id=&#34;sessioninterceptorjava-2&#34;&gt;SessionInterceptor.java&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.util.concurrent.TimeUnit;

import javax.annotation.PostConstruct;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.redis.core.StringRedisTemplate;
import org.springframework.stereotype.Component;
import org.springframework.web.servlet.HandlerInterceptor;
import org.springframework.web.servlet.ModelAndView;

@Component
public class SessionInterceptor implements HandlerInterceptor {

	@Autowired
	private StringRedisTemplate redis;

	public static SessionInterceptor sessionInterceptor;

	@PostConstruct
	public void init() {
		sessionInterceptor = this;
		sessionInterceptor.redis = this.redis;
	}

	/**
	 * 进入controller层之前拦截请求
	 * 
	 * @param httpServletRequest
	 * @param httpServletResponse
	 * @param o
	 * @return
	 * @throws Exception
	 */
	@Override
	public boolean preHandle(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o)
			throws Exception {
        System.out.println(&amp;quot;------------进入拦截器之前-------------&amp;quot;);
		String sessionId = httpServletRequest.getHeader(&amp;quot;sessionId&amp;quot;);
		try {
			Boolean flag = sessionInterceptor.redis.hasKey(sessionId);
			if (flag) {
				sessionInterceptor.redis.expire(sessionId, 60 * 60 * 24 * 7,
						TimeUnit.SECONDS);
				return true;
			} else {
				httpServletResponse.setContentType(&amp;quot;text/html; charset=utf-8&amp;quot;);
				httpServletResponse.setStatus(403);
				return false;
			}
		} catch (Exception e) {
			httpServletResponse.setContentType(&amp;quot;text/html; charset=utf-8&amp;quot;);
			httpServletResponse.setStatus(403);
			return false;
		}

	}

	@Override
	public void postHandle(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o,
			ModelAndView modelAndView) throws Exception {
        System.out.println(&amp;quot;------------视图渲染完毕后-------------&amp;quot;);
	}

	@Override
	public void afterCompletion(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse,
			Object o, Exception e) throws Exception {
        System.out.println(&amp;quot;------------进入拦截器之后-------------&amp;quot;);
	}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;interceptorconfigjava-2&#34;&gt;InterceptorConfig.java&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.InterceptorRegistry;
import org.springframework.web.servlet.config.annotation.PathMatchConfigurer;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport;

/**
 * 拦截器配置
 * @author Administrator
 *
 */
@Configuration
public class InterceptorConfig extends WebMvcConfigurationSupport {

    @Override
    public void configurePathMatch(PathMatchConfigurer configurer) {
        super.configurePathMatch(configurer);
        configurer.setUseSuffixPatternMatch(false);
    }
	
    @Override
    public void addInterceptors(InterceptorRegistry registry){
        registry.addInterceptor(new SessionInterceptor())
        //拦截的路径
        .addPathPatterns(&amp;quot;/**&amp;quot;)
        //设置不拦截的路径
        .excludePathPatterns(&amp;quot;/user/login/**&amp;quot;)
        // 静态资源不拦截
        .excludePathPatterns(&amp;quot;/images/**&amp;quot;);
        super.addInterceptors(registry);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;5-代码生成模板引擎&#34;&gt;5、代码生成模板引擎&lt;/h4&gt;
&lt;h6 id=&#34;pomxml&#34;&gt;pom.xml&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;!-- mybatis-plus代码生成器模板引擎 --&amp;gt;
&amp;lt;dependency&amp;gt;
	&amp;lt;groupId&amp;gt;org.apache.velocity&amp;lt;/groupId&amp;gt;
	&amp;lt;artifactId&amp;gt;velocity-engine-core&amp;lt;/artifactId&amp;gt;
	&amp;lt;version&amp;gt;2.0&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;工具类&#34;&gt;工具类&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import com.baomidou.mybatisplus.generator.AutoGenerator;
import com.baomidou.mybatisplus.generator.InjectionConfig;
import com.baomidou.mybatisplus.generator.config.DataSourceConfig;
import com.baomidou.mybatisplus.generator.config.FileOutConfig;
import com.baomidou.mybatisplus.generator.config.GlobalConfig;
import com.baomidou.mybatisplus.generator.config.PackageConfig;
import com.baomidou.mybatisplus.generator.config.StrategyConfig;
import com.baomidou.mybatisplus.generator.config.TemplateConfig;
import com.baomidou.mybatisplus.generator.config.converts.MySqlTypeConvert;
import com.baomidou.mybatisplus.generator.config.po.TableInfo;
import com.baomidou.mybatisplus.generator.config.rules.DbType;
import com.baomidou.mybatisplus.generator.config.rules.NamingStrategy;

/**
 * Created by Yangcq on 2018/08/16.
 */
public class Generator {
	
	//项目路径
	private static String canonicalPath = &amp;quot;&amp;quot;;

    //基本包名
    private static String basePackage = &amp;quot;com.liu.wechat&amp;quot;;
    //作者
    private static String authorName = &amp;quot;liuyang&amp;quot;;
    //要生成的表名
    private static String[] tables = {&amp;quot;table1&amp;quot;,&amp;quot;table2&amp;quot;,&amp;quot;table3&amp;quot;};
    //table前缀
    private static String prefix = &amp;quot;&amp;quot;;
    //数据库类型
    private static DbType dbType = DbType.MYSQL;
    //数据库配置四要素
    private static String driverName = &amp;quot;com.mysql.jdbc.Driver&amp;quot;;
    private static String url = &amp;quot;jdbc:mysql://localhost:3306/database?useUnicode=true&amp;amp;characterEncoding=UTF-8&amp;amp;useSSL=false&amp;quot;;
    private static String username = &amp;quot;root&amp;quot;;
    private static String password = &amp;quot;root&amp;quot;;

    public static void main(String[] args) {

        AutoGenerator gen = new AutoGenerator();
        
        /**
         * 获取项目路径
         */
		try {
			canonicalPath = new File(&amp;quot;&amp;quot;).getCanonicalPath();
		} catch (IOException e) {
			e.printStackTrace();
		}

        /**
         * 数据库配置
         */
        gen.setDataSource(new DataSourceConfig()
                .setDbType(dbType)
                .setDriverName(driverName)
                .setUrl(url)
                .setUsername(username)
                .setPassword(password)
                .setTypeConvert(new MySqlTypeConvert() {
                    // 自定义数据库表字段类型转换【可选】
                    //@Override
                    //public DbColumnType processTypeConvert(String fieldType) {
                        //System.out.println(&amp;quot;转换类型：&amp;quot; + fieldType);
                        // if ( fieldType.toLowerCase().contains( &amp;quot;tinyint&amp;quot; ) ) {
                        //    return DbColumnType.BOOLEAN;
                        // }
                        //return super.processTypeConvert(fieldType);
                    //}
                }));

        /**
         * 全局配置
         */
        gen.setGlobalConfig(new GlobalConfig()
                .setOutputDir( canonicalPath + &amp;quot;/src/main/java&amp;quot;)//输出目录
                .setFileOverride(true)// 是否覆盖文件
                .setActiveRecord(true)// 开启 activeRecord 模式
                .setEnableCache(false)// XML 二级缓存
                .setBaseResultMap(true)// XML ResultMap
                .setBaseColumnList(true)// XML columList
                .setOpen(false)//生成后打开文件夹
                .setAuthor(authorName)
                // 自定义文件命名，注意 %s 会自动填充表实体属性！
                .setMapperName(&amp;quot;%sMapper&amp;quot;)
                .setXmlName(&amp;quot;%sMapper&amp;quot;)
                .setServiceName(&amp;quot;%sService&amp;quot;)
                .setServiceImplName(&amp;quot;%sServiceImpl&amp;quot;)
                .setControllerName(&amp;quot;%sController&amp;quot;)
        );

        /**
         * 策略配置
         */
        gen.setStrategy(new StrategyConfig()
                // .setCapitalMode(true)// 全局大写命名
                //.setDbColumnUnderline(true)//全局下划线命名
                .setTablePrefix(new String[]{prefix})// 此处可以修改为您的表前缀
                .setNaming(NamingStrategy.underline_to_camel)// 表名生成策略
                .setInclude(tables) // 需要生成的表
                .setRestControllerStyle(true)
                //.setExclude(new String[]{&amp;quot;test&amp;quot;}) // 排除生成的表
                // 自定义实体父类
                // .setSuperEntityClass(&amp;quot;com.baomidou.demo.TestEntity&amp;quot;)
                // 自定义实体，公共字段
                //.setSuperEntityColumns(new String[]{&amp;quot;test_id&amp;quot;})
                //.setTableFillList(tableFillList)
                // 自定义 mapper 父类 默认BaseMapper
                //.setSuperMapperClass(&amp;quot;com.baomidou.mybatisplus.mapper.BaseMapper&amp;quot;)
                // 自定义 service 父类 默认IService
                // .setSuperServiceClass(&amp;quot;com.baomidou.demo.TestService&amp;quot;)
                // 自定义 service 实现类父类 默认ServiceImpl
                // .setSuperServiceImplClass(&amp;quot;com.baomidou.demo.TestServiceImpl&amp;quot;)
                // 自定义 controller 父类
                //.setSuperControllerClass(&amp;quot;com.kichun.&amp;quot;+packageName+&amp;quot;.controller.AbstractController&amp;quot;)
                // 【实体】是否生成字段常量（默认 false）
                // public static final String ID = &amp;quot;test_id&amp;quot;;
                // .setEntityColumnConstant(true)
                // 【实体】是否为构建者模型（默认 false）
                // public User setName(String name) {this.name = name; return this;}
                // .setEntityBuilderModel(true)
                // 【实体】是否为lombok模型（默认 false）&amp;lt;a href=&amp;quot;https://projectlombok.org/&amp;quot;&amp;gt;document&amp;lt;/a&amp;gt;
                .setEntityLombokModel(true)
                // Boolean类型字段是否移除is前缀处理
                // .setEntityBooleanColumnRemoveIsPrefix(true)
                // .setRestControllerStyle(true)
                // .setControllerMappingHyphenStyle(true)
        );

        /**
         * 包配置
         */
        gen.setPackageInfo(new PackageConfig()
                        //.setModuleName(&amp;quot;User&amp;quot;)
                        .setParent(basePackage)// 自定义包路径
                        .setController(&amp;quot;controller&amp;quot;)// 这里是控制器包名，默认 web
                        .setEntity(&amp;quot;model&amp;quot;) // 设置Entity包名，默认entity
                        .setMapper(&amp;quot;mapper&amp;quot;) // 设置Mapper包名，默认mapper
                        .setService(&amp;quot;service&amp;quot;) // 设置Service包名，默认service
                        .setServiceImpl(&amp;quot;service.impl&amp;quot;) // 设置Service Impl包名，默认service.impl
                        .setXml(&amp;quot;mapper&amp;quot;) // 设置Mapper XML包名，默认mapper.xml
                        );

        /**
         * 注入自定义配置
         */
        // 注入自定义配置，可以在 VM 中使用 cfg.abc 设置的值
        InjectionConfig abc = new InjectionConfig() {
            @Override
            public void initMap() {
                Map&amp;lt;String, Object&amp;gt; map = new HashMap&amp;lt;String, Object&amp;gt;();
                map.put(&amp;quot;abc&amp;quot;, this.getConfig().getGlobalConfig().getAuthor() + &amp;quot;-mp&amp;quot;);
                this.setMap(map);
            }
        };
        //自定义文件输出位置（非必须）
        List&amp;lt;FileOutConfig&amp;gt; fileOutList = new ArrayList&amp;lt;FileOutConfig&amp;gt;();
        fileOutList.add(new FileOutConfig(&amp;quot;/templates/mapper.xml.vm&amp;quot;) {
            @Override
            public String outputFile(TableInfo tableInfo) {
                return canonicalPath + &amp;quot;/src/main/java/com/liu/wechat/mapper/&amp;quot; + tableInfo.getEntityName() + &amp;quot;Mapper.xml&amp;quot;;
            }
        });
        abc.setFileOutConfigList(fileOutList);
        gen.setCfg(abc);

        /**
         * 指定模板引擎 默认是VelocityTemplateEngine ，需要引入相关引擎依赖
         */
        //gen.setTemplateEngine(new FreemarkerTemplateEngine());

        /**
         * 模板配置
         */
        gen.setTemplate(
                // 关闭默认 xml 生成，调整生成 至 根目录
                new TemplateConfig().setXml(null)
                // 自定义模板配置，模板可以参考源码 /mybatis-plus/src/main/resources/template 使用 copy
                // 至您项目 src/main/resources/template 目录下，模板名称也可自定义如下配置：
                // .setController(&amp;quot;...&amp;quot;);
                // .setEntity(&amp;quot;...&amp;quot;);
                // .setMapper(&amp;quot;...&amp;quot;);
                // .setXml(&amp;quot;...&amp;quot;);
                // .setService(&amp;quot;...&amp;quot;);
                // .setServiceImpl(&amp;quot;...&amp;quot;);
        );

        // 执行生成
        gen.execute();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;6-pomxml全部配置&#34;&gt;6、pom.xml全部配置&lt;/h4&gt;
&lt;h6 id=&#34;配置文件&#34;&gt;配置文件&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;project xmlns=&amp;quot;http://maven.apache.org/POM/4.0.0&amp;quot; xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
	xsi:schemaLocation=&amp;quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&amp;quot;&amp;gt;
	&amp;lt;modelVersion&amp;gt;4.0.0&amp;lt;/modelVersion&amp;gt;
	&amp;lt;parent&amp;gt;
		&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
		&amp;lt;artifactId&amp;gt;spring-boot-starter-parent&amp;lt;/artifactId&amp;gt;
		&amp;lt;version&amp;gt;2.0.5.RELEASE&amp;lt;/version&amp;gt;
		&amp;lt;relativePath /&amp;gt; &amp;lt;!-- lookup parent from repository --&amp;gt;
	&amp;lt;/parent&amp;gt;
	&amp;lt;groupId&amp;gt;com.xxxx&amp;lt;/groupId&amp;gt;
	&amp;lt;artifactId&amp;gt;xxxx&amp;lt;/artifactId&amp;gt;
	&amp;lt;version&amp;gt;0.0.1-SNAPSHOT&amp;lt;/version&amp;gt;
	&amp;lt;name&amp;gt;xxxx&amp;lt;/name&amp;gt;
	&amp;lt;description&amp;gt;Demo project for Spring Boot&amp;lt;/description&amp;gt;

	&amp;lt;properties&amp;gt;
		&amp;lt;java.version&amp;gt;1.8&amp;lt;/java.version&amp;gt;
	&amp;lt;/properties&amp;gt;

	&amp;lt;dependencies&amp;gt;
		&amp;lt;!--SpringBoot核心jar包 --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;spring-boot-starter&amp;lt;/artifactId&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;spring-boot-starter-test&amp;lt;/artifactId&amp;gt;
			&amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;!--mybatis plus核心库 --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;com.baomidou&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;mybatis-plus&amp;lt;/artifactId&amp;gt;
			&amp;lt;version&amp;gt;2.3&amp;lt;/version&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;!-- mybatis plus与springboot整合 --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;com.baomidou&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;mybatis-plus-boot-starter&amp;lt;/artifactId&amp;gt;
			&amp;lt;version&amp;gt;2.3&amp;lt;/version&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;!-- Web --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;spring-boot-starter-web&amp;lt;/artifactId&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;!-- tomcat --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;spring-boot-starter-tomcat&amp;lt;/artifactId&amp;gt;
			&amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;!--MySql --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;mysql&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;mysql-connector-java&amp;lt;/artifactId&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;!-- redis --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;spring-boot-starter-data-redis&amp;lt;/artifactId&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;!-- fastJson --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;com.alibaba&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;fastjson&amp;lt;/artifactId&amp;gt;
			&amp;lt;version&amp;gt;1.2.47&amp;lt;/version&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;!-- 邮箱配置 --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;spring-boot-starter-mail&amp;lt;/artifactId&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;!-- 云通信短信通知接口 --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;com.aliyun&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;dysmsapi20170525&amp;lt;/artifactId&amp;gt;
			&amp;lt;version&amp;gt;2.0.4&amp;lt;/version&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;!-- 文件上传 --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;commons-fileupload&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;commons-fileupload&amp;lt;/artifactId&amp;gt;
			&amp;lt;version&amp;gt;1.3.3&amp;lt;/version&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;!-- 支付宝支付 --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;com.alipay.sdk&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;alipay-sdk-java&amp;lt;/artifactId&amp;gt;
			&amp;lt;version&amp;gt;3.0.0&amp;lt;/version&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;!-- http --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;org.apache.httpcomponents&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;httpclient&amp;lt;/artifactId&amp;gt;
			&amp;lt;version&amp;gt;4.5&amp;lt;/version&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;org.apache.httpcomponents&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;httpmime&amp;lt;/artifactId&amp;gt;
			&amp;lt;version&amp;gt;4.5&amp;lt;/version&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;org.apache.httpcomponents&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;httpcore&amp;lt;/artifactId&amp;gt;
			&amp;lt;version&amp;gt;4.4.5&amp;lt;/version&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;!-- 图片压缩 --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;net.coobird&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;thumbnailator&amp;lt;/artifactId&amp;gt;
			&amp;lt;version&amp;gt;0.4.8&amp;lt;/version&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;!-- Excel导出 --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;org.apache.poi&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;poi&amp;lt;/artifactId&amp;gt;
			&amp;lt;version&amp;gt;3.17&amp;lt;/version&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;!-- springboot热部署 --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;spring-boot-devtools&amp;lt;/artifactId&amp;gt;
			&amp;lt;optional&amp;gt;true&amp;lt;/optional&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;!-- junit --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;junit&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;junit&amp;lt;/artifactId&amp;gt;
		&amp;lt;/dependency&amp;gt;
	&amp;lt;/dependencies&amp;gt;

	&amp;lt;build&amp;gt;
		&amp;lt;plugins&amp;gt;
			&amp;lt;!-- springboot热部署 --&amp;gt;
			&amp;lt;plugin&amp;gt;
				&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
				&amp;lt;artifactId&amp;gt;spring-boot-maven-plugin&amp;lt;/artifactId&amp;gt;
				&amp;lt;configuration&amp;gt;
					&amp;lt;fork&amp;gt;true&amp;lt;/fork&amp;gt;
				&amp;lt;/configuration&amp;gt;
			&amp;lt;/plugin&amp;gt;
			&amp;lt;!-- assembly（maven打包插件） --&amp;gt;
			&amp;lt;plugin&amp;gt;
				&amp;lt;artifactId&amp;gt;maven-assembly-plugin&amp;lt;/artifactId&amp;gt;
				&amp;lt;version&amp;gt;2.2&amp;lt;/version&amp;gt;
				&amp;lt;configuration&amp;gt;
					&amp;lt;archive&amp;gt;
						&amp;lt;manifest&amp;gt;
							&amp;lt;mainClass&amp;gt;com.abjy.studentmanage.StudentManageApplication&amp;lt;/mainClass&amp;gt;
						&amp;lt;/manifest&amp;gt;
					&amp;lt;/archive&amp;gt;
					&amp;lt;descriptorRefs&amp;gt;
						&amp;lt;descriptorRef&amp;gt;
							jar-with-dependencies
						&amp;lt;/descriptorRef&amp;gt;
					&amp;lt;/descriptorRefs&amp;gt;
				&amp;lt;/configuration&amp;gt;
			&amp;lt;/plugin&amp;gt;
		&amp;lt;/plugins&amp;gt;
	&amp;lt;/build&amp;gt;

&amp;lt;/project&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;打包命令&#34;&gt;打包命令&lt;/h6&gt;
&lt;p&gt;Maven项目打包成可执行Jar文件&lt;br&gt;
在使用Maven完成项目以后，如果是需要打包成可执行的Jar文件，我们通过eclipse的导出很麻烦，还得指定入口文件的位置，还得说明依赖的jar包，既然都使用Maven了，很重要的一个目的就是让这些繁琐的操作简单。我们可以通过插件完成这项工作，使用assembly插件。具体使用方式如下：&lt;/p&gt;
&lt;p&gt;在项目中&lt;strong&gt;加入插件的依赖&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;plugin&amp;gt;  
    &amp;lt;artifactId&amp;gt;maven-assembly-plugin&amp;lt;/artifactId&amp;gt;  
    &amp;lt;version&amp;gt;2.2&amp;lt;/version&amp;gt;  
    &amp;lt;configuration&amp;gt;  
        &amp;lt;archive&amp;gt;  
            &amp;lt;manifest&amp;gt;  
                &amp;lt;mainClass&amp;gt;com.xxx.Main&amp;lt;/mainClass&amp;gt;  
            &amp;lt;/manifest&amp;gt;  
        &amp;lt;/archive&amp;gt;  
        &amp;lt;descriptorRefs&amp;gt;  
            &amp;lt;descriptorRef&amp;gt;  
                jar-with-dependencies  
            &amp;lt;/descriptorRef&amp;gt;  
        &amp;lt;/descriptorRefs&amp;gt;  
    &amp;lt;/configuration&amp;gt;  
&amp;lt;/plugin&amp;gt;  
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;注意插件中要写明main方法文件入口位置。&lt;br&gt;
2、通过命令行到工作空间的项目路径下，比如：D:\workspace\test（工作空间是workspace，项目是test），然后执行以下命令：&lt;br&gt;
&lt;strong&gt;mvn assembly:assembly&lt;/strong&gt;&lt;br&gt;
注意：在执行这个命令之前，必须先配置Maven的环境变量，检查是否配置可通过命令：mvn -version&lt;br&gt;
3、如果上面的命令成功执行，那么在项目路径的target文件下就会有两个jar文件，一个是有jar包依赖的，一个是没jar包依赖的。&lt;br&gt;
4、&lt;strong&gt;执行jar包，通过命令：java -jar xxx.jar执行&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;注意：如果是在Eclipse中通过Maven插件，可以直接运行assembly:assembly,然后在项目的target中就能看见.jar文件。&lt;/p&gt;
&lt;h4 id=&#34;7-支付宝支付配置&#34;&gt;7、支付宝支付配置&lt;/h4&gt;
&lt;h5 id=&#34;1沙箱测试参数&#34;&gt;（1）沙箱测试参数&lt;/h5&gt;
&lt;h6 id=&#34;appid&#34;&gt;APPID&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;2016091800540296
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;应用公钥&#34;&gt;应用公钥&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAo0cLYGj36dxgKb4T5ODTygUC/u83JNleZBhwZKqfHDan4kXhcdzfOThAJE53jQ7Z99stY+AycSL4N/vzdJL9eZJPNwF2DaQEyI7ACydezOIq+QYNVu288vuozEIMK+MAt1ZA4SzuONMOytRgzc+H8LLU744/YbFglQVGs0WuVX++22gLUwzpI2KBE+sdm/SJ9lXkej3i3DP/F4/oWUVlaCJ2K1fDg9g7UPVN4C3pB5ESkSEl2pEXFb+TDH+lFDcuHnVmb12bR3NIao5ioIkncuhHbg8D3fe75p+f+d1cUoFkr11Y0eQmtad3mpQvt49Y6iVk+e3bnDhQo57T9AVPiQIDAQAB
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;应用私钥&#34;&gt;应用私钥&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQCjRwtgaPfp3GApvhPk4NPKBQL+7zck2V5kGHBkqp8cNqfiReFx3N85OEAkTneNDtn32y1j4DJxIvg3+/N0kv15kk83AXYNpATIjsALJ17M4ir5Bg1W7bzy+6jMQgwr4wC3VkDhLO440w7K1GDNz4fwstTvjj9hsWCVBUazRa5Vf77baAtTDOkjYoET6x2b9In2VeR6PeLcM/8Xj+hZRWVoInYrV8OD2DtQ9U3gLekHkRKRISXakRcVv5MMf6UUNy4edWZvXZtHc0hqjmKgiSdy6EduDwPd97vmn5/53VxSgWSvXVjR5Ca1p3ealC+3j1jqJWT57ducOFCjntP0BU+JAgMBAAECggEAX8dRGSD6LKklj9b8fIqWMi92bm2M/4SzJixf4e1koHw/RzCO6ugR2dLxbVrKLmjD2+0qVygw7sUArnaRfZSsNCBrb2zf/2hzleKHLQPPTIhvhNzT/mY/LJoLjqY/1Y634NQsAusEYzkLuFeU4aYXrE57MntTGs+eRExwCMGbXnM9Bnm416wkal/67t+p//A0CxbYNKZ+TehC6kVZi+NNg+WId6BRtowrPiu1owNqVl8/HP4sVZPwiH8yVcOkqo2aCgtraJBgmFSsoELBGb6YcH2tHw3FdEvT7DAtjugGH7lt1bBl8T5Bbrb//K6aoRq83R50Z9uGWuSuOBTL7TGLwQKBgQDZWFr7AktgujKg3drmkR8cw2cDIZdNYW7LpOobcRl3F0tMBWr1oW6bp3z7tk9M1w7QJBot25ji9wqxeVyPbaovwqIT1mTWZZADkgAagmnLhVx6ak8DCSJJG6z4//yZIEKyFY9XI7wF3zTZQR9jmhClKDfNTJUssfFFjKQ40cnLxQKBgQDAUQKS2ZRN2Q5irsLUyMLqII/EbDyornsKW6itp4vx4+5+1+cKupsMZtwnjeGcatTZKIKvTr4z4JfGjy6FnUQqmos8TZ6ZFnxXKlU30CJGR2AvzaH7HhMcELvgb7SsPNKLZfS2GkWESmRZqCzpNC4I6gvykibAnLFeDmic/Cjc9QKBgF3XEDEgJHt26TUblM/ICK7ajzeC4Vi/oJ68bXe7tUr9+7yu+idjs+Xwwr3LUSHUGMk1TThPgAs+rpdB1vz2VGyalHAMOS14XF2uQ+0uMY913R/dlo+w+eSm1mAL5nwWubU6KdFt1FiUrrS+sVbHxjgIzU8OqbnKemmU97KwoXghAoGBAIC5OHnGfMemk0RmKS53uk8vwEr/D5LwRpbmRv8E+FzN7aKlLJY31PP2HUG0a+BgeVtpDB//Grxqhex3hfIVE71Yd/3DDnb1YACP6z5SZ76Wo8EbaGJG/Q95++b7nfjzNRHtCmChMQqdKJICSR1GudFpptmUDbA6sVV9W3RIK6nJAoGBAJ4qgrVImI3Ij9UhYPaWpxH026TgvXrQEq9xrN/MuIN4aqDZs7I1hNXmcEA/I0WrBmTCyFh0VCfeQy0a2sQWn/p6dSP/Q7/QwHH3m8/jeiFuql4lV8fKdNP84ESzpnzQU5NzDUSGMz8ZPKzL6g619sQsn+7ynyyeNomsn7zTSB00
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;支付宝公钥&#34;&gt;支付宝公钥&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApqwVTSOZLyv6LODEw2r5/qHIOQxVr0Bk9PDCYkJguN6dnsWWGJrohf54iw39wB2xtARsrjAp9PHkw9/RdKsc4sYUSuGLrWveWa3hMZ+/tS9G1dUQnLeXdUATFoeiXl3A33o76ugXcLz3i7TXYyADVENNqKXnnmijDlTKtfU6/o+ViWeIsBTsiDLiktyD4Zf15QB/H8iTrT86S+oX13i7Q6l/pV1TMcZsCeEoNIVOnY5tZdm/7oknjhkjvHMQw1jWYSZdFqVxpPWKZKwvHHzAmYF9ylqK64WfAMNL5YRbDL8DGyn3av3vXn/uydzZAEEv294g0B8g5hFYcwEGvKCOtQIDAQAB
&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&#34;2配置文件&#34;&gt;（2）配置文件&lt;/h5&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class AlipayConfig {
	
	// 应用ID,您的APPID，收款账号既是您的APPID对应支付宝账号,开发时使用沙箱提供的APPID，生产环境改成自己的APPID
    public static String app_id = &amp;quot;您的APPID&amp;quot;;

    // 商户私钥，您的PKCS8格式RSA2私钥
    public static String merchant_private_key = &amp;quot;商户私钥&amp;quot;;
    
    // 支付宝公钥,查看地址：https://openhome.alipay.com/platform/keyManage.htm 对应APPID下的支付宝公钥。
    public static String alipay_public_key = &amp;quot;支付宝公钥&amp;quot;;
    
    // 服务器异步通知页面路径  需http://格式的完整路径，不能加?id=123这类自定义参数，必须外网可以正常访问
    public static String notify_url = &amp;quot;https://71df657.cpolar.io/pay/alipayNotifyUrl&amp;quot;;

    // 页面跳转同步通知页面路径 需http://格式的完整路径，不能加?id=123这类自定义参数，必须外网可以正常访问(其实就是支付成功后返回的页面)
    public static String return_url = &amp;quot;http://182.92.113.175:3000/pay/alipayReturnUrl&amp;quot;;
    //public static String return_url = &amp;quot;http://127.0.0.1:3000/pay/alipayReturnUrl&amp;quot;;

    // 签名方式
    public static String sign_type = &amp;quot;RSA2&amp;quot;;

    // 字符编码格式
    public static String charset = &amp;quot;utf-8&amp;quot;;

    // 支付宝网关，这是沙箱的网关
    public static String gatewayUrl = &amp;quot;https://openapi.alipaydev.com/gateway.do&amp;quot;;

    public static String log_path = &amp;quot;C://&amp;quot;;

}
&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&#34;3业务处理&#34;&gt;（3）业务处理&lt;/h5&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.io.IOException;
import java.io.OutputStream;
import java.io.UnsupportedEncodingException;
import java.math.BigDecimal;
import java.text.ParseException;
import java.util.Date;
import java.util.HashMap;
import java.util.Iterator;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.servlet.ModelAndView;

import com.xxxx.xxxx.config.AlipayConfig;

import com.abjy.tool.DateTool;
import com.alibaba.fastjson.JSON;
import com.alipay.api.AlipayApiException;
import com.alipay.api.AlipayClient;
import com.alipay.api.DefaultAlipayClient;
import com.alipay.api.internal.util.AlipaySignature;
import com.alipay.api.request.AlipayTradePagePayRequest;
import com.alipay.api.request.AlipayTradeQueryRequest;
import com.alipay.api.request.AlipayTradeWapPayRequest;
import com.alipay.api.response.AlipayTradeQueryResponse;

@Controller
@RequestMapping(&amp;quot;/pay&amp;quot;)
public class PayController {

	/**
	 * 支付宝支付请求
	 * 
	 * @param mapParam
	 * @return
	 * @throws AlipayApiException
	 * @throws UnsupportedEncodingException
	 */
	@ResponseBody
	@RequestMapping(value = &amp;quot;/alipay&amp;quot;, method = RequestMethod.POST, produces = &amp;quot;application/json; charset=UTF-8&amp;quot;)
	public Map&amp;lt;String, Object&amp;gt; alipay(@RequestBody HashMap&amp;lt;String, String&amp;gt; mapParam)
			throws AlipayApiException, UnsupportedEncodingException {
		Map&amp;lt;String, Object&amp;gt; mapResult = new HashMap&amp;lt;&amp;gt;();
		// 获得初始化的AlipayClient
		AlipayClient alipayClient = new DefaultAlipayClient(AlipayConfig.gatewayUrl, AlipayConfig.app_id,
				AlipayConfig.merchant_private_key, &amp;quot;json&amp;quot;, AlipayConfig.charset, AlipayConfig.alipay_public_key,
				AlipayConfig.sign_type);
		// 商户订单号，商户网站订单系统中唯一订单号，必填
		String out_trade_no = mapParam.get(&amp;quot;paymentOrderCode&amp;quot;);
		// 付款金额，必填
		String total_amount = mapParam.get(&amp;quot;total_amount&amp;quot;);
		// 订单名称，必填
		String subject = mapParam.get(&amp;quot;subject&amp;quot;);
		// 支付类型
		// 1.电脑网站支付产品alipay.trade.page.pay接口中，product_code为：FAST_INSTANT_TRADE_PAY
		// 2.手机网站支付产品alipay.trade.wap.pay接口中，product_code为：QUICK_WAP_WAY
		// 3.当面付条码支付产品alipay.trade.pay接口中，product_code为：FACE_TO_FACE_PAYMENT
		// 4.APP支付产品alipay.trade.app.pay接口中，product_code为：QUICK_MSECURITY_PAY
		String alipayProductCode = mapParam.get(&amp;quot;alipayProductCode&amp;quot;);
		if (alipayProductCode.equals(&amp;quot;FAST_INSTANT_TRADE_PAY&amp;quot;)) {
			// 设置请求参数
			AlipayTradePagePayRequest alipayWebPay = new AlipayTradePagePayRequest();
			alipayWebPay.setReturnUrl(AlipayConfig.return_url);
			alipayWebPay.setNotifyUrl(AlipayConfig.notify_url);
			alipayWebPay.setBizContent(&amp;quot;{\&amp;quot;out_trade_no\&amp;quot;:\&amp;quot;&amp;quot; + out_trade_no + &amp;quot;\&amp;quot;,&amp;quot; + &amp;quot;\&amp;quot;total_amount\&amp;quot;:\&amp;quot;&amp;quot;
					+ total_amount + &amp;quot;\&amp;quot;,&amp;quot; + &amp;quot;\&amp;quot;subject\&amp;quot;:\&amp;quot;&amp;quot; + subject + &amp;quot;\&amp;quot;,&amp;quot; + &amp;quot;\&amp;quot;product_code\&amp;quot;:\&amp;quot;&amp;quot;
					+ alipayProductCode + &amp;quot;\&amp;quot;,&amp;quot; + &amp;quot;\&amp;quot;payment_order_code\&amp;quot;:\&amp;quot;&amp;quot; + out_trade_no + &amp;quot;\&amp;quot;}&amp;quot;);
			// 请求
			String result = alipayClient.pageExecute(alipayWebPay).getBody();
			// 输出
			mapResult.put(&amp;quot;msg&amp;quot;, &amp;quot;success&amp;quot;);
			mapResult.put(&amp;quot;alipayForm&amp;quot;, result);
		} else if (alipayProductCode.equals(&amp;quot;QUICK_WAP_WAY&amp;quot;)) {
			AlipayTradeWapPayRequest alipayWapPay = new AlipayTradeWapPayRequest();
			alipayWapPay.setReturnUrl(AlipayConfig.return_url);
			alipayWapPay.setNotifyUrl(AlipayConfig.notify_url);
			alipayWapPay.setBizContent(&amp;quot;{\&amp;quot;out_trade_no\&amp;quot;:\&amp;quot;&amp;quot; + out_trade_no + &amp;quot;\&amp;quot;,&amp;quot; + &amp;quot;\&amp;quot;total_amount\&amp;quot;:\&amp;quot;&amp;quot;
					+ total_amount + &amp;quot;\&amp;quot;,&amp;quot; + &amp;quot;\&amp;quot;subject\&amp;quot;:\&amp;quot;&amp;quot; + subject + &amp;quot;\&amp;quot;,&amp;quot; + &amp;quot;\&amp;quot;product_code\&amp;quot;:\&amp;quot;&amp;quot;
					+ alipayProductCode + &amp;quot;\&amp;quot;,&amp;quot; + &amp;quot;\&amp;quot;payment_order_code\&amp;quot;:\&amp;quot;&amp;quot; + out_trade_no + &amp;quot;\&amp;quot;}&amp;quot;);
			// 请求
			String result = alipayClient.pageExecute(alipayWapPay).getBody();
			// 输出
			mapResult.put(&amp;quot;msg&amp;quot;, &amp;quot;success&amp;quot;);
			mapResult.put(&amp;quot;alipayForm&amp;quot;, result);
		} else {
			mapResult.put(&amp;quot;msg&amp;quot;, &amp;quot;fail&amp;quot;);
		}
		return mapResult;
	}

	/**
	 * 支付宝同步跳转
	 * 
	 * @param request
	 * @param response
	 * @return
	 * @throws AlipayApiException
	 * @throws IOException
	 * @throws ParseException
	 */
	@RequestMapping(value = &amp;quot;/alipayReturnUrl&amp;quot;, method = RequestMethod.GET)
	public ModelAndView alipayReturnUrl(HttpServletRequest request, HttpServletResponse response)
			throws AlipayApiException, IOException, ParseException {
		// 获取支付宝GET过来反馈信息
		Map&amp;lt;String, String&amp;gt; params = new HashMap&amp;lt;String, String&amp;gt;();
		Map&amp;lt;String, String[]&amp;gt; requestParams = request.getParameterMap();
		for (Iterator&amp;lt;String&amp;gt; iter = requestParams.keySet().iterator(); iter.hasNext();) {
			String name = (String) iter.next();
			String[] values = (String[]) requestParams.get(name);
			String valueStr = &amp;quot;&amp;quot;;
			for (int i = 0; i &amp;lt; values.length; i++) {
				valueStr = (i == values.length - 1) ? valueStr + values[i] : valueStr + values[i] + &amp;quot;,&amp;quot;;
			}
			// 乱码解决，这段代码在出现乱码时使用
			valueStr = new String(valueStr.getBytes(&amp;quot;ISO-8859-1&amp;quot;), &amp;quot;utf-8&amp;quot;);
			params.put(name, valueStr);
		}
		boolean signVerified = AlipaySignature.rsaCheckV1(params, AlipayConfig.alipay_public_key, AlipayConfig.charset,
				AlipayConfig.sign_type); // 调用SDK验证签名
		if (signVerified) {
			response.sendRedirect(&amp;quot;http://127.0.0.1:8080/#/paystate.html/&amp;quot; + request.getParameter(&amp;quot;out_trade_no&amp;quot;));
		} else {
			return null;
		}
		return null;
	}

	/**
	 * 支付宝异步通知
	 * 
	 * @param request
	 * @param response
	 * @return
	 * @throws UnsupportedEncodingException
	 * @throws AlipayApiException
	 * @throws ParseException
	 */
	@RequestMapping(value = &amp;quot;/alipayNotifyUrl&amp;quot;, method = RequestMethod.POST)
	public String alipayNotifyUrl(HttpServletRequest request, HttpServletResponse response)
			throws UnsupportedEncodingException, AlipayApiException, ParseException {
		// 获取支付宝POST过来反馈信息
		Map&amp;lt;String, String&amp;gt; params = new HashMap&amp;lt;String, String&amp;gt;();
		Map&amp;lt;String, String[]&amp;gt; requestParams = request.getParameterMap();
		for (Iterator&amp;lt;String&amp;gt; iter = requestParams.keySet().iterator(); iter.hasNext();) {
			String name = (String) iter.next();
			String[] values = (String[]) requestParams.get(name);
			String valueStr = &amp;quot;&amp;quot;;
			for (int i = 0; i &amp;lt; values.length; i++) {
				valueStr = (i == values.length - 1) ? valueStr + values[i] : valueStr + values[i] + &amp;quot;,&amp;quot;;
			}
			// 乱码解决，这段代码在出现乱码时使用
			// valueStr = new String(valueStr.getBytes(&amp;quot;ISO-8859-1&amp;quot;), &amp;quot;utf-8&amp;quot;);
			params.put(name, valueStr);
		}
		// 调用SDK验证签名
		boolean signVerified = AlipaySignature.rsaCheckV1(params, AlipayConfig.alipay_public_key, AlipayConfig.charset,
				AlipayConfig.sign_type); // 调用SDK验证签名
		if (signVerified) {// 验证成功
		    // 异步通知返回的参数
			// 商户订单号
			String out_trade_no = request.getParameter(&amp;quot;out_trade_no&amp;quot;);
			// 支付宝交易号
			String trade_no = request.getParameter(&amp;quot;trade_no&amp;quot;);
			// 交易状态
			String trade_status = request.getParameter(&amp;quot;trade_status&amp;quot;);
			if (trade_status.equals(&amp;quot;TRADE_FINISHED&amp;quot;)) {
				// 做过处理不再执行
				return &amp;quot;success&amp;quot;;
			} else if (trade_status.equals(&amp;quot;TRADE_SUCCESS&amp;quot;)) {
				// 处理您的业务逻辑
				return &amp;quot;success&amp;quot;;
			} else {
				return &amp;quot;fail&amp;quot;;
			}
		} else {
			// 验证失败
			return &amp;quot;fail&amp;quot;;
		}

	}

	/*
	 * 统一收单线下交易查询
	 */
	@RequestMapping(value = &amp;quot;/alipayQuery/{paymentReturnCode}&amp;quot;, method = RequestMethod.POST)
	@ResponseBody
	public Map&amp;lt;String, String&amp;gt; AlipayQuery(@PathVariable String paymentReturnCode)
			throws AlipayApiException, ParseException {
		Map&amp;lt;String, String&amp;gt; mapResult = new HashMap&amp;lt;&amp;gt;();
		AlipayClient alipayClient = new DefaultAlipayClient(AlipayConfig.gatewayUrl, AlipayConfig.app_id,
				AlipayConfig.merchant_private_key, &amp;quot;json&amp;quot;, AlipayConfig.charset, AlipayConfig.alipay_public_key,
				AlipayConfig.sign_type);
		AlipayTradeQueryRequest alipayRequest = new AlipayTradeQueryRequest();
		;// 创建API对应的request

		// 回调函数
		alipayRequest.setReturnUrl(AlipayConfig.return_url);
		alipayRequest.setNotifyUrl(AlipayConfig.notify_url);

		Map&amp;lt;String, Object&amp;gt; map = new HashMap&amp;lt;String, Object&amp;gt;();
		map.put(&amp;quot;trade_no&amp;quot;, paymentReturnCode);// 测试用时生成的支付宝订单号
		String param = JSON.toJSONString(map);
		alipayRequest.setBizContent(param);
		AlipayTradeQueryResponse response = alipayClient.execute(alipayRequest);
		String msg = response.getMsg();
		if (msg.equals(&amp;quot;Success&amp;quot;)) {
			String buyerLogonId = response.getBuyerLogonId();
			String sendPayDate = DateTool.dateToString(response.getSendPayDate(), &amp;quot;yyyy-MM-dd HH:mm:ss&amp;quot;);
			String buyerPayAmount = response.getBuyerPayAmount();
			String receiptAmount = response.getReceiptAmount();
			mapResult.put(&amp;quot;msg&amp;quot;, &amp;quot;success&amp;quot;);
			mapResult.put(&amp;quot;content&amp;quot;, &amp;quot;（支付宝账号：&amp;quot; + buyerLogonId + &amp;quot;）于 &amp;quot; + sendPayDate + &amp;quot; 付款 &amp;quot; + buyerPayAmount
					+ &amp;quot; 元，账户实收 &amp;quot; + receiptAmount + &amp;quot; 元，请注意查收！&amp;quot;);
			return mapResult;
		} else {
			mapResult.put(&amp;quot;msg&amp;quot;, &amp;quot;fail&amp;quot;);
			mapResult.put(&amp;quot;content&amp;quot;, &amp;quot;没有查询到交易记录，请核对订单编号（&amp;quot; + paymentReturnCode + &amp;quot;)&amp;quot;);
			return mapResult;
		}
	}

}
&lt;/code&gt;&lt;/pre&gt;
">Spring Boot配置文件</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/KBCRP8JEb/"" data-c="
          &lt;h4 id=&#34;一-jdk环境变量配置&#34;&gt;一、jdk环境变量配置&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;找到系统环境变量
新建JAVA_HOME系统变量
变量名：**JAVA_HOME**，变量值：**C:\Program Files\Java\jdk1.8.0_171**(这里填你自己选择的安装路径！！！)
新建CLASSPATH变量
变量名：**CLASSPATH**,，变量值： **.;%JAVA_HOME%\lib;%JAVA_HOME%\lib\tools.jar**（注意最前面有一点）。
配置系统环境变量Path
双击**Path**--&amp;gt;新建--&amp;gt;添加“**%JAVA_HOME%\bin**”--&amp;gt;将这一行变量上移到最顶端--&amp;gt;完成
测试安装是否完成，win+R弹出运行窗口后，输入cmd，回车弹出命令行窗口，分别输java -version、javac
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;二-maven配置&#34;&gt;二、Maven配置&lt;/h4&gt;
&lt;h6 id=&#34;maven环境变量配置&#34;&gt;Maven环境变量配置&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;新建系统变量:
变量名：**MAVEN_HOME**
变量值：**F:\dev\apache-maven-3.6.1**【这是maven安装地址】
编辑系统变相**Path**：
在最后加上：**%MAVEN_HOME%\bin**
cmd验证是否安装成功：mvn -version
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;eclipse和maven设置&#34;&gt;Eclipse和Maven设置&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;修改Eclipse的MAVEN的存储位置：
Window-&amp;gt;Preferences-&amp;gt;Maven-&amp;gt;Installations：选择本地maven的安装地址
Window-&amp;gt;Preferences-&amp;gt;Maven-&amp;gt;User Settings：点击Browser按钮，选择maven配置文件【settings.xml】，点击update Settings按钮即可。
Eclipse字体大小设置
Window-&amp;gt;Prefrences-&amp;gt;General-&amp;gt;Appearance-&amp;gt;Colors and Fonts-&amp;gt;Basic-&amp;gt;Text Font-&amp;gt;Edit
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;更改maven默认仓库地址&#34;&gt;更改maven默认仓库地址&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;!-- localRepository
   | The path to the local repository maven will use to store artifacts.
   |
   | Default: ~/.m2/repository
&amp;lt;localRepository&amp;gt;/path/to/local/repo&amp;lt;/localRepository&amp;gt;
--&amp;gt;
修改为：
&amp;lt;!-- localRepository
   | The path to the local repository maven will use to store artifacts.
   |
   | Default: ~/.m2/repository
&amp;lt;localRepository&amp;gt;/path/to/local/repo&amp;lt;/localRepository&amp;gt;
--&amp;gt;
&amp;lt;localRepository&amp;gt;E:/mavenrepository&amp;lt;/localRepository&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;maven官网仓库地址替换为国内访问速度较快的镜像地址&#34;&gt;Maven官网仓库地址替换为国内访问速度较快的镜像地址&lt;/h6&gt;
&lt;p&gt;第一种方法：在settings.xml中找到mirrors标签里面配一个mirror，让中央仓库（central）的默认地址被aliyun拦截。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;mirror&amp;gt;
      &amp;lt;id&amp;gt;mirrorId&amp;lt;/id&amp;gt;
      &amp;lt;mirrorOf&amp;gt;central&amp;lt;/mirrorOf&amp;gt;
      &amp;lt;name&amp;gt;Human Readable Name for this Mirror.&amp;lt;/name&amp;gt;
      &amp;lt;url&amp;gt;http://maven.aliyun.com/nexus/content/groups/public/&amp;lt;/url&amp;gt;
&amp;lt;/mirror&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;第二种方法：直接在pom.xml上改&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;repositories&amp;gt;
        &amp;lt;repository&amp;gt;
            &amp;lt;id&amp;gt;aliyun&amp;lt;/id&amp;gt;
            &amp;lt;name&amp;gt;aliyun&amp;lt;/name&amp;gt;
            &amp;lt;url&amp;gt;http://maven.aliyun.com/nexus/content/groups/public/&amp;lt;/url&amp;gt;
            &amp;lt;layout&amp;gt;default&amp;lt;/layout&amp;gt;
            &amp;lt;releases&amp;gt;
                &amp;lt;enabled&amp;gt;true&amp;lt;/enabled&amp;gt;
                &amp;lt;updatePolicy&amp;gt;never&amp;lt;/updatePolicy&amp;gt;
            &amp;lt;/releases&amp;gt;
            &amp;lt;snapshots&amp;gt;
                &amp;lt;enabled&amp;gt;true&amp;lt;/enabled&amp;gt;
                &amp;lt;updatePolicy&amp;gt;never&amp;lt;/updatePolicy&amp;gt;
            &amp;lt;/snapshots&amp;gt;
        &amp;lt;/repository&amp;gt;
    &amp;lt;/repositories&amp;gt;
    &amp;lt;pluginRepositories&amp;gt;
            &amp;lt;pluginRepository&amp;gt;
            &amp;lt;id&amp;gt;aliyun&amp;lt;/id&amp;gt;
            &amp;lt;name&amp;gt;aliyun&amp;lt;/name&amp;gt;
            &amp;lt;url&amp;gt;http://maven.aliyun.com/nexus/content/groups/public/&amp;lt;/url&amp;gt;
            &amp;lt;releases&amp;gt;
                &amp;lt;enabled&amp;gt;true&amp;lt;/enabled&amp;gt;
            &amp;lt;/releases&amp;gt;
            &amp;lt;snapshots&amp;gt;
                &amp;lt;enabled&amp;gt;false&amp;lt;/enabled&amp;gt;
            &amp;lt;/snapshots&amp;gt;
            &amp;lt;/pluginRepository&amp;gt;
        &amp;lt;/pluginRepositories&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
">Java JDK和Maven配置</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/SYEf-2yBR/"" data-c="
          &lt;h6 id=&#34;pomxml&#34;&gt;pom.xml&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;!-- 阿里云云通信短信通知接口 旧版--&amp;gt;
&amp;lt;dependency&amp;gt;
	&amp;lt;groupId&amp;gt;com.aliyun&amp;lt;/groupId&amp;gt;
	&amp;lt;artifactId&amp;gt;aliyun-java-sdk-core&amp;lt;/artifactId&amp;gt;
	&amp;lt;version&amp;gt;4.1.0&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;!-- 阿里云云通信短信通知接口 新版--&amp;gt;
&amp;lt;dependency&amp;gt;
	&amp;lt;groupId&amp;gt;com.aliyun&amp;lt;/groupId&amp;gt;
	&amp;lt;artifactId&amp;gt;dysmsapi20170525&amp;lt;/artifactId&amp;gt;
	&amp;lt;version&amp;gt;2.0.4&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;旧版工具类&#34;&gt;旧版工具类&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.util.HashMap;
import java.util.Map;
import java.util.Random;

import com.aliyuncs.CommonRequest;
import com.aliyuncs.CommonResponse;
import com.aliyuncs.DefaultAcsClient;
import com.aliyuncs.IAcsClient;
import com.aliyuncs.exceptions.ClientException;
import com.aliyuncs.exceptions.ServerException;
import com.aliyuncs.http.MethodType;
import com.aliyuncs.profile.DefaultProfile;
import com.google.gson.JsonObject;
import com.google.gson.JsonParser;

public class SendSmsTool {
	
	public static Map&amp;lt;String, Object&amp;gt; SendSMS(String phone) {
		Map&amp;lt;String, Object&amp;gt; map = new HashMap&amp;lt;&amp;gt;();
		String code = String.valueOf(new Random().nextInt(899999) + 100000);//生成短信验证码
        DefaultProfile profile = DefaultProfile.getProfile(&amp;quot;default&amp;quot;, &amp;quot;您的AccessKey ID&amp;quot;, &amp;quot;您的AccessKey Secret&amp;quot;);
        IAcsClient client = new DefaultAcsClient(profile);
        CommonRequest request = new CommonRequest();
        //request.setProtocol(ProtocolType.HTTPS);
        request.setMethod(MethodType.POST);
        request.setDomain(&amp;quot;dysmsapi.aliyuncs.com&amp;quot;);
        request.setVersion(&amp;quot;2017-05-25&amp;quot;);
        request.setAction(&amp;quot;SendSms&amp;quot;);
        request.putQueryParameter(&amp;quot;PhoneNumbers&amp;quot;, phone);
        request.putQueryParameter(&amp;quot;SignName&amp;quot;, &amp;quot;您的签名&amp;quot;);
        request.putQueryParameter(&amp;quot;TemplateCode&amp;quot;, &amp;quot;您的模板编号&amp;quot;);
        request.putQueryParameter(&amp;quot;TemplateParam&amp;quot;, &amp;quot;{\&amp;quot;code\&amp;quot;:&amp;quot;+ code +&amp;quot;}&amp;quot;);
        try {
            CommonResponse response = client.getCommonResponse(request);
            JsonParser jp = new JsonParser();
    		//将json字符串转化成json对象
            JsonObject jo = jp.parse(response.getData()).getAsJsonObject();
            //获取message对应的值
            String message = jo.get(&amp;quot;Message&amp;quot;).getAsString();
            if (message.equals(&amp;quot;OK&amp;quot;)) {
            	map.put(&amp;quot;message&amp;quot;, message);
            	map.put(&amp;quot;return_code&amp;quot;, code);
			}else{
				map.put(&amp;quot;message&amp;quot;, message);
			}
        } catch (ServerException e) {
            e.printStackTrace();
        } catch (ClientException e) {
            e.printStackTrace();
        }
		return map;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;新版工具类&#34;&gt;新版工具类&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.util.HashMap;
import java.util.Map;
import java.util.Random;

import com.aliyun.dysmsapi20170525.models.*;
import com.aliyun.teaopenapi.models.*;

public class SendSmsTool {

	/**
	 * 使用AK&amp;amp;SK初始化账号Client
	 * 
	 * @param accessKeyId
	 * @param accessKeySecret
	 * @return Client
	 * @throws Exception
	 */
	public static com.aliyun.dysmsapi20170525.Client createClient(String accessKeyId, String accessKeySecret)
			throws Exception {
		Config config = new Config()
				// 您的AccessKey ID
				.setAccessKeyId(accessKeyId)
				// 您的AccessKey Secret
				.setAccessKeySecret(accessKeySecret);
		// 访问的域名
		config.endpoint = &amp;quot;dysmsapi.aliyuncs.com&amp;quot;;
		return new com.aliyun.dysmsapi20170525.Client(config);
	}

	public static Map&amp;lt;String, String&amp;gt; SendSMS(String phone) throws Exception {
		Map&amp;lt;String, String&amp;gt; map = new HashMap&amp;lt;&amp;gt;();
		String AccessKeyID = &amp;quot;AccessKeyID&amp;quot;;
		String AccessKeySecret = &amp;quot;AccessKeySecret&amp;quot;;
		String SignName = &amp;quot;XXX&amp;quot;;
		String TemplateCode = &amp;quot;SMS_XXXXX&amp;quot;;
		String code = String.valueOf(new Random().nextInt(899999) + 100000);// 生成短信验证码
		com.aliyun.dysmsapi20170525.Client client = SendSmsTool.createClient(AccessKeyID,
				AccessKeySecret);
		SendSmsRequest sendSmsRequest = new SendSmsRequest().setPhoneNumbers(phone).setSignName(SignName)
				.setTemplateCode(TemplateCode).setTemplateParam(&amp;quot;{\&amp;quot;code\&amp;quot;:&amp;quot; + code + &amp;quot;}&amp;quot;);
		// 复制代码运行请自行打印 API 的返回值
		SendSmsResponse response = client.sendSms(sendSmsRequest);
		System.out.println(response.getBody().message);
		if (response.getBody().message.equals(&amp;quot;OK&amp;quot;)) {
			map.put(&amp;quot;msg&amp;quot;, &amp;quot;success&amp;quot;);
			map.put(&amp;quot;code&amp;quot;, code);
			map.put(&amp;quot;returnTeacherPhone&amp;quot;, phone);
		} else {
			map.put(&amp;quot;msg&amp;quot;, &amp;quot;fail&amp;quot;);
		}
		return map;
	}
}
&lt;/code&gt;&lt;/pre&gt;
">云通信短信验证码</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/OQOtx_qzt/"" data-c="
          &lt;h6 id=&#34;pomxml&#34;&gt;pom.xml&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;!-- 邮箱配置 --&amp;gt;
&amp;lt;dependency&amp;gt;
	&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
	&amp;lt;artifactId&amp;gt;spring-boot-starter-mail&amp;lt;/artifactId&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;工具类1&#34;&gt;工具类1&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.io.UnsupportedEncodingException;
import java.security.Security;
import java.util.Date;
import java.util.Properties;

import javax.activation.DataHandler;
import javax.activation.FileDataSource;
import javax.mail.Authenticator;
import javax.mail.BodyPart;
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.Multipart;
import javax.mail.PasswordAuthentication;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeBodyPart;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.MimeMultipart;
import javax.mail.internet.MimeUtility;

/**
 * 邮件处理类
 * 
 * @author jiafuwei
 * 
 */
public class sendMail {

    private static final String FROM_MAIL_SMTP = &amp;quot;邮箱服务器，例如smtp.163.com&amp;quot;;
    private static final String FROM_MAIL_NAME = &amp;quot;您的邮箱&amp;quot;;
    private static final String FROM_MAIL_PASS = &amp;quot;您的授权码&amp;quot;;

    
    /**
     * 发送邮件(灵活度高，通用版)
     * @param from 发件人
     * @param to 收件人, 多个Email以英文逗号分隔
     * @param cc 抄送, 多个Email以英文逗号分隔
     * @param subject 主题
     * @param content 内容
     * @param fileList 附件列表
     * @return
     */
    public static boolean sendMail(String to, String cc, String subject, String content, String[] fileList){
         try {
             Security.addProvider(new com.sun.net.ssl.internal.ssl.Provider());
             final String SSL_FACTORY = &amp;quot;javax.net.ssl.SSLSocketFactory&amp;quot;;
             final Properties p = System.getProperties() ;
             p.setProperty(&amp;quot;mail.smtp.host&amp;quot;, FROM_MAIL_SMTP);
             p.setProperty(&amp;quot;mail.smtp.auth&amp;quot;, &amp;quot;true&amp;quot;);
             p.setProperty(&amp;quot;mail.smtp.user&amp;quot;, FROM_MAIL_NAME);
             p.setProperty(&amp;quot;mail.smtp.pass&amp;quot;, FROM_MAIL_PASS);
             
             p.setProperty(&amp;quot;mail.smtp.socketFactory.class&amp;quot;, SSL_FACTORY);
             p.setProperty(&amp;quot;mail.smtp.socketFactory.fallback&amp;quot;, &amp;quot;false&amp;quot;);
             //邮箱发送服务器端口,这里设置为465端口
             p.setProperty(&amp;quot;mail.smtp.port&amp;quot;, &amp;quot;465&amp;quot;);
             p.setProperty(&amp;quot;mail.smtp.socketFactory.port&amp;quot;, &amp;quot;465&amp;quot;);
    
            // 根据邮件会话属性和密码验证器构造一个发送邮件的session
            Session session = Session.getInstance(p, new Authenticator(){
                protected PasswordAuthentication getPasswordAuthentication() {
                    return new PasswordAuthentication(p.getProperty(&amp;quot;mail.smtp.user&amp;quot;),p.getProperty(&amp;quot;mail.smtp.pass&amp;quot;));
                }
            });
            session.setDebug(true);
            Message message = new MimeMessage(session);
            //消息发送的主题
            message.setSubject(subject);
            //接受消息的人
            message.setReplyTo(InternetAddress.parse(FROM_MAIL_NAME));
            //消息的发送者
            message.setFrom(new InternetAddress(p.getProperty(&amp;quot;mail.smtp.user&amp;quot;),&amp;quot;您的邮箱&amp;quot;));
            // 创建邮件的接收者地址，并设置到邮件消息中
            String[] split = to.split(&amp;quot;,&amp;quot;);
            InternetAddress []tos = new InternetAddress[split.length];
            for (int i = 0; i &amp;lt; split.length; i++) {
                tos[i]=new InternetAddress(split[i]);
            }
            // 设置抄送人
//            if (cc != null &amp;amp;&amp;amp; cc.length() &amp;gt; 0) {
//                message.setRecipients(Message.RecipientType.CC, InternetAddress.parse(cc)); 
//            }
            message.setRecipients(Message.RecipientType.TO, tos);
            // 消息发送的时间
            message.setSentDate(new Date());
            Multipart mainPart = new MimeMultipart();
            // 创建一个包含HTML内容的MimeBodyPart
            BodyPart html = new MimeBodyPart();
            // 设置HTML内容
            html.setContent(content, &amp;quot;text/html; charset=utf-8&amp;quot;);
            mainPart.addBodyPart(html);
            // 将MiniMultipart对象设置为邮件内容
            message.setContent(mainPart);
            // 设置附件
            if (fileList != null &amp;amp;&amp;amp; fileList.length &amp;gt; 0) {
                for (int i = 0; i &amp;lt; fileList.length; i++) {
                    html = new MimeBodyPart();
                    FileDataSource fds = new FileDataSource(fileList[i]); 
                    html.setDataHandler(new DataHandler(fds)); 
                    html.setFileName(MimeUtility.encodeText(fds.getName(), &amp;quot;UTF-8&amp;quot;, &amp;quot;B&amp;quot;));
                    mainPart.addBodyPart(html); 
                }
            }
            message.setContent(mainPart); 
            message.saveChanges(); 
            Transport.send(message);
         } catch (MessagingException e) {
             e.printStackTrace();
             return false;
         } catch (UnsupportedEncodingException e) {
            e.printStackTrace();
            return false;
        }
        return true;
    }

    /**
     * 测试Mian方法
     * 
     * @param args
     */
    public static void main(String[] args) {
        String content = &amp;quot;&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;&amp;lt;style type=&#39;text/css&#39;&amp;gt;p{padding-left:50px;font-family:&#39;楷体&#39;;font-size:20px;}table{padding-left:50px;border:0;font-family:&#39;楷体&#39;;font-size:30px;}&amp;lt;/style&amp;gt;&amp;lt;/head&amp;gt;&amp;lt;body&amp;gt;验证码：&amp;lt;br/&amp;gt;&amp;lt;p&amp;gt;123456&amp;lt;/p&amp;gt;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&amp;quot;;
//        String[] fileList = new String[1];
//        fileList[0] = &amp;quot;d:/pac.txt&amp;quot;;
        System.out.println(sendMail(&amp;quot;发送者邮箱&amp;quot;, null, &amp;quot;测试测试&amp;quot;, content,null));
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;工具类2&#34;&gt;工具类2&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.util.Objects;

import org.springframework.mail.SimpleMailMessage;
import org.springframework.mail.javamail.JavaMailSenderImpl;

public class sendMail {
	public static JavaMailSenderImpl JavaMailSender() {
        JavaMailSenderImpl mailSender = new JavaMailSenderImpl();
        mailSender.setHost(&amp;quot;邮箱服务器，例如smtp.163.com&amp;quot;);
        mailSender.setUsername(&amp;quot;您的邮箱&amp;quot;);
        mailSender.setPassword(&amp;quot;您的授权码&amp;quot;);
        return mailSender;
    }
    //一个简单的邮件,只有text信息
    /**
     * @Description:
     * @Param: [subject:标题, text:内容, email:接收人的邮件地址]
     * @return: void
     * @Author: liuyang
     * @Date: 2020/2/27
     */
    public static void SendSimpleEmail(String subject, String text, String email) {
        JavaMailSenderImpl javaMailSender = JavaMailSender();
        SimpleMailMessage mailMessage = new SimpleMailMessage();
        mailMessage.setSubject(subject); //邮件的主题
        mailMessage.setText(text);
        mailMessage.setTo(email); //发送给谁
        mailMessage.setFrom(Objects.requireNonNull(javaMailSender.getUsername())); //谁发送的
        javaMailSender.send(mailMessage);
    }
    
    public static void main(String[] args) {
    	SendMail.SendSimpleEmail(&amp;quot;邮件主题&amp;quot;, &amp;quot;邮件内容&amp;quot;, &amp;quot;收件人邮箱&amp;quot;);
	}

}
&lt;/code&gt;&lt;/pre&gt;
">邮箱发送工具类</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/pOSJswbRk/"" data-c="
          &lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.text.SimpleDateFormat;
import java.util.HashMap;
import java.util.Map;

import org.springframework.http.ResponseEntity;
import org.springframework.web.client.RestTemplate;

import com.google.gson.Gson;
import com.wowmake.aftersale.model.Bill;
import com.wowmake.aftersale.model.wechat.WeChatTemplateData;
import com.wowmake.aftersale.model.wechat.WeChatTemplateMsg;
import com.wowmake.aftersale.model.wechat.WechatAccessToken;

public class WeChatPush {

	/*
	 * 微信小程序推送单个用户
	 */
	public static void pushOneUser(RestTemplate restTemplate,String openid,String formId,Bill bill) {
		// 获取access_token
		String access_token = getAccess_token(&amp;quot;wx5db83dbd5a5df58c&amp;quot;, &amp;quot;f4af31412da4baf7b4a616113ff8f270&amp;quot;,restTemplate);
		String url = &amp;quot;https://api.weixin.qq.com/cgi-bin/message/wxopen/template/send&amp;quot; + &amp;quot;?access_token=&amp;quot; + access_token;
		Integer billState = bill.getBillState();
		WeChatTemplateMsg wxTemplateMsg = new WeChatTemplateMsg();
		wxTemplateMsg.setTouser(openid);// 要推送用户的openid
		wxTemplateMsg.setForm_id(formId);// 要推送用户的formid
		if (billState == 1) {
			wxTemplateMsg.setTemplate_id(&amp;quot;z6NUC6iQ5rb5hnZElv3qljgulHwgXKykAzWO8RcPQxY&amp;quot;);// 模版id
			Map&amp;lt;String, WeChatTemplateData&amp;gt; m = new HashMap&amp;lt;&amp;gt;();
			// 拼接推送的模版
			WeChatTemplateData keyword1 = new WeChatTemplateData();
			keyword1.setValue(bill.getBillNumber());
			m.put(&amp;quot;keyword1&amp;quot;, keyword1);

			WeChatTemplateData keyword2 = new WeChatTemplateData();
			keyword2.setValue(bill.getMachineInfo().getMachineNumber());
			m.put(&amp;quot;keyword2&amp;quot;, keyword2);
			wxTemplateMsg.setData(m);

			WeChatTemplateData keyword3 = new WeChatTemplateData();
			keyword3.setValue(bill.getBillArea()+bill.getBillAddress());
			m.put(&amp;quot;keyword3&amp;quot;, keyword3);
			wxTemplateMsg.setData(m);

			WeChatTemplateData keyword4 = new WeChatTemplateData();
			keyword4.setValue(bill.getCustomerInfo().getUserNickName());
			m.put(&amp;quot;keyword4&amp;quot;, keyword4);
			wxTemplateMsg.setData(m);

			WeChatTemplateData keyword5 = new WeChatTemplateData();
			SimpleDateFormat sdf = new SimpleDateFormat(&amp;quot;yyyy-MM-dd HH:mm:ss&amp;quot;);
			keyword5.setValue(sdf.format(bill.getBillSubmitDate()));
			m.put(&amp;quot;keyword5&amp;quot;, keyword5);
			wxTemplateMsg.setData(m);
			
			WeChatTemplateData keyword6 = new WeChatTemplateData();
			keyword6.setValue(bill.getServiceInfo().getUserNickName());
			m.put(&amp;quot;keyword6&amp;quot;, keyword6);
			wxTemplateMsg.setData(m);
			
			WeChatTemplateData keyword7 = new WeChatTemplateData();
			keyword7.setValue(bill.getServiceInfo().getUserPhone());
			m.put(&amp;quot;keyword7&amp;quot;, keyword7);
			wxTemplateMsg.setData(m);
			
			WeChatTemplateData keyword8 = new WeChatTemplateData();
			keyword8.setValue(&amp;quot;待处理&amp;quot;);
			m.put(&amp;quot;keyword8&amp;quot;, keyword8);
			wxTemplateMsg.setData(m);
		} else if(billState == 2){
			wxTemplateMsg.setTemplate_id(&amp;quot;mVkOVv_yO4GcS5kTAuCPJf3k9sxcF__p75h_7M0e85Y&amp;quot;);// 模版id
			Map&amp;lt;String, WeChatTemplateData&amp;gt; m = new HashMap&amp;lt;&amp;gt;();
			// 拼接推送的模版
			WeChatTemplateData keyword1 = new WeChatTemplateData();
			keyword1.setValue(bill.getBillNumber());
			m.put(&amp;quot;keyword1&amp;quot;, keyword1);

			WeChatTemplateData keyword2 = new WeChatTemplateData();
			keyword2.setValue(bill.getServiceInfo().getUserNickName());
			m.put(&amp;quot;keyword2&amp;quot;, keyword2);
			wxTemplateMsg.setData(m);
			
			WeChatTemplateData keyword3 = new WeChatTemplateData();
			keyword3.setValue(bill.getServiceInfo().getUserPhone());
			m.put(&amp;quot;keyword3&amp;quot;, keyword3);
			wxTemplateMsg.setData(m);
			
			WeChatTemplateData keyword4 = new WeChatTemplateData();
			keyword4.setValue(&amp;quot;已处理，期待您的评价&amp;quot;);
			m.put(&amp;quot;keyword4&amp;quot;, keyword4);
			wxTemplateMsg.setData(m);
		}
		ResponseEntity&amp;lt;String&amp;gt; responseEntity = restTemplate.postForEntity(url, wxTemplateMsg, String.class);
		System.out.printf(&amp;quot;小程序推送结果：&amp;quot;);
		System.out.println(responseEntity.getBody());
	}

	/*
	 * 获取access_token appid和appsecret到小程序后台获取，当然也可以让小程序开发人员给你传过来
	 */
	public static String getAccess_token(String appid, String appsecret,RestTemplate restTemplate) {
		// 获取access_token
		String url = &amp;quot;https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&amp;quot; + &amp;quot;&amp;amp;appid=&amp;quot; + appid
				+ &amp;quot;&amp;amp;secret=&amp;quot; + appsecret;
		String json = restTemplate.getForObject(url, String.class);
		WechatAccessToken accessToken = new Gson().fromJson(json, WechatAccessToken.class);
		return accessToken.getAccess_token();
	}

}
&lt;/code&gt;&lt;/pre&gt;
">小程序模板通知</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/jSMenZ-BQ/"" data-c="
          &lt;h6 id=&#34;pomxml&#34;&gt;pom.xml&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;!-- 图片压缩 --&amp;gt;
&amp;lt;dependency&amp;gt;
	&amp;lt;groupId&amp;gt;net.coobird&amp;lt;/groupId&amp;gt;
	&amp;lt;artifactId&amp;gt;thumbnailator&amp;lt;/artifactId&amp;gt;
	&amp;lt;version&amp;gt;0.4.8&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;工具类&#34;&gt;工具类&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.OutputStream;
import java.util.ArrayList;
import java.util.List;
import java.util.zip.ZipEntry;
import java.util.zip.ZipOutputStream;

import javax.servlet.ServletOutputStream;
import javax.servlet.http.HttpServletResponse;

import org.springframework.web.multipart.MultipartFile;

import net.coobird.thumbnailator.Thumbnails;

public class FileTool {

	/**
	 * 获取文件大小
	 * 
	 * @param fileSrc
	 * @return
	 */
	public static long getFileSize(String fileSrc) {
		File file = new File(fileSrc);
		if (!file.exists() || !file.isFile()) {
			return -1;
		}
		return file.length();
	}

	/**
	 * 获取上传文件的后缀名
	 * 
	 * @param file
	 * @return
	 */
	public static String getFileSuffixName(MultipartFile file) {
		String fileSuffixName = file.getOriginalFilename().substring(file.getOriginalFilename().lastIndexOf(&amp;quot;.&amp;quot;));
		return fileSuffixName;
	}
    
    	/**
	 * 获取文件夹下文件列表
	 * 
	 * @param strPath
	 * @return
	 */
	public static List&amp;lt;File&amp;gt; getFileList(String strPath) {
		List&amp;lt;File&amp;gt; filelist = new ArrayList&amp;lt;&amp;gt;();
		File dir = new File(strPath);
		File[] files = dir.listFiles(); // 该文件目录下文件全部放入数组
		if (files != null) {
			for (int i = 0; i &amp;lt; files.length; i++) {
				String fileName = files[i].getName();
				if (files[i].isDirectory()) {
					getFileList(files[i].getAbsolutePath()); // 遍历子文件夹里面的东西
				} else if (fileName.endsWith(&amp;quot;exe&amp;quot;)) { // 以***结尾的文件
					String strFileName = files[i].getAbsolutePath();
					filelist.add(files[i]);
				} else {
					filelist.add(files[i]);
					continue;
				}
			}
		}
		return filelist;
	}

	/**
	 * 将文件压缩至指定大小
	 * 
	 * @param fileSrc
	 *            文件路径
	 * @param fileSize
	 *            压缩后最大值
	 * @return
	 * @throws IOException
	 */
	public static Boolean FileCompress(String fileSrc, long fileSize) throws IOException {
		Thumbnails.of(fileSrc).scale(1). // 缩放大小
				outputQuality(0.8). // 图片压缩80%质量
				toFile(fileSrc);
		long FileCompressSize = getFileSize(fileSrc);
		if (FileCompressSize / 1024 &amp;gt; fileSize) {
			FileCompress(fileSrc, fileSize);
		}
		return true;
	}

	/**
	 * 下载硬盘上的文件
	 * 
	 * @param response
	 * @param DiskPath
	 *            文件硬盘路径
	 * @param FileName
	 *            下载后的名称
	 */
	public static void downLoadDisk(HttpServletResponse response, String DiskPath, String FileName) {
		// 1.设置文件ContentType类型，这样设置，会自动判断下载文件类型
		response.setContentType(&amp;quot;multipart/form-data&amp;quot;);
		// 2.设置文件头：最后一个参数是设置下载文件名
		response.setHeader(&amp;quot;Content-Disposition&amp;quot;, &amp;quot;attachment;fileName=&amp;quot; + FileName);
		// 通过文件路径获得File对象
		File file = new File(DiskPath);
		ServletOutputStream out = null;
		FileInputStream inputStream = null;
		try {
			inputStream = new FileInputStream(file);
			// 3.通过response获取ServletOutputStream对象(out)
			out = response.getOutputStream();
			int b = 0;
			byte[] buffer = new byte[512];
			while (b != -1) {
				b = inputStream.read(buffer);
				if (b != -1) {
					out.write(buffer, 0, b);// 4.写到输出流(out)中
				}
			}
		} catch (IOException e) {
			e.printStackTrace();
		} finally {
			try {
				if (inputStream != null) {
					inputStream.close();
				}
				if (out != null) {
					out.close();
					out.flush();
				}
			} catch (IOException e) {
				e.printStackTrace();
			}

		}
	}

	/**
	 * @param srcDir
	 *            压缩文件夹路径
	 * @param out
	 *            压缩文件输出流
	 * @param KeepDirStructure
	 *            是否保留原来的目录结构,true:保留目录结构;false:所有文件跑到压缩包根目录下(注意：不保留目录结构可能会出现同名文件,会压缩失败)
	 * @throws RuntimeException
	 *             压缩失败会抛出运行时异常
	 */
	public static void fileToZip(String srcDir, OutputStream out, boolean KeepDirStructure) throws RuntimeException {
		long start = System.currentTimeMillis();
		ZipOutputStream zos = null;
		try {
			zos = new ZipOutputStream(out);
			File sourceFile = new File(srcDir);
			compressZip(sourceFile, zos, sourceFile.getName(), KeepDirStructure);
			long end = System.currentTimeMillis();
			System.out.println(&amp;quot;压缩完成，耗时：&amp;quot; + (end - start) + &amp;quot; ms&amp;quot;);
		} catch (Exception e) {
			throw new RuntimeException(&amp;quot;zip error from ZipUtils&amp;quot;, e);
		} finally {
			if (zos != null) {
				try {
					zos.close();
				} catch (IOException e) {
					e.printStackTrace();
				}
			}
		}
	}

	/**
	 * 
	 * 压缩成ZIP 方法2
	 * 
	 * @param srcFiles
	 *            需要压缩的文件列表
	 * 
	 * @param out
	 *            压缩文件输出流
	 * 
	 * @throws RuntimeException
	 *             压缩失败会抛出运行时异常
	 * 
	 */
	public static void fileListToZip(List&amp;lt;File&amp;gt; srcFiles, OutputStream out) throws RuntimeException {
		long start = System.currentTimeMillis();
		ZipOutputStream zos = null;
		try {
			zos = new ZipOutputStream(out);
			for (File srcFile : srcFiles) {
				byte[] buf = new byte[BUFFER_SIZE];
				zos.putNextEntry(new ZipEntry(srcFile.getName()));
				int len;
				FileInputStream in = new FileInputStream(srcFile);
				while ((len = in.read(buf)) != -1) {
					zos.write(buf, 0, len);
				}
				zos.closeEntry();
				in.close();
			}
			long end = System.currentTimeMillis();
			System.out.println(&amp;quot;压缩完成，耗时：&amp;quot; + (end - start) + &amp;quot; ms&amp;quot;);
		} catch (Exception e) {
			throw new RuntimeException(&amp;quot;zip error from ZipUtils&amp;quot;, e);
		} finally {
			if (zos != null) {
				try {
					zos.close();
				} catch (IOException e) {
					e.printStackTrace();
				}
			}
		}
	}

	/**
	 * 递归压缩方法
	 * 
	 * @param sourceFile
	 *            源文件
	 * @param zos
	 *            zip输出流
	 * @param name
	 *            压缩后的名称
	 * @param KeepDirStructure
	 *            是否保留原来的目录结构,true:保留目录结构;false:所有文件跑到压缩包根目录下(注意：不保留目录结构可能会出现同名文件,会压缩失败)
	 * @throws Exception
	 */
	private static final int BUFFER_SIZE = 2 * 1024;

	private static void compressZip(File sourceFile, ZipOutputStream zos, String name, boolean KeepDirStructure)
			throws Exception {
		byte[] buf = new byte[BUFFER_SIZE];
		if (sourceFile.isFile()) {
			// 向zip输出流中添加一个zip实体，构造器中name为zip实体的文件的名字
			zos.putNextEntry(new ZipEntry(name));
			// copy文件到zip输出流中
			int len;
			FileInputStream in = new FileInputStream(sourceFile);
			while ((len = in.read(buf)) != -1) {
				zos.write(buf, 0, len);
			}
			// Complete the entry
			zos.closeEntry();
			in.close();
		} else {
			File[] listFiles = sourceFile.listFiles();
			if (listFiles == null || listFiles.length == 0) {
				// 需要保留原来的文件结构时,需要对空文件夹进行处理
				if (KeepDirStructure) {
					// 空文件夹的处理
					zos.putNextEntry(new ZipEntry(name + &amp;quot;/&amp;quot;));
					// 没有文件，不需要文件的copy
					zos.closeEntry();
				}
			} else {
				for (File file : listFiles) {
					// 判断是否需要保留原来的文件结构
					if (KeepDirStructure) {
						// 注意：file.getName()前面需要带上父文件夹的名字加一斜杠,
						// 不然最后压缩包中就不能保留原来的文件结构,即：所有文件都跑到压缩包根目录下了
						compressZip(file, zos, name + &amp;quot;/&amp;quot; + file.getName(), KeepDirStructure);
					} else {
						compressZip(file, zos, file.getName(), KeepDirStructure);
					}
				}
			}
		}
	}
    
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;压缩方法测试&#34;&gt;压缩方法测试&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;//测试压缩方法1
FileOutputStream fos1 = new FileOutputStream(new File(&amp;quot;c:/mytest01.zip&amp;quot;));
FileTool.fileToZip(&amp;quot;D:/log&amp;quot;, fos1,true);
//测试压缩方法2
List&amp;lt;File&amp;gt; fileList = new ArrayList&amp;lt;&amp;gt;();
fileList.add(new File(&amp;quot;D:/Java/jdk1.7.0_45_64bit/bin/jar.exe&amp;quot;));
fileList.add(new File(&amp;quot;D:/Java/jdk1.7.0_45_64bit/bin/java.exe&amp;quot;));
FileOutputStream fos2 = new FileOutputStream(new File(&amp;quot;c:/mytest02.zip&amp;quot;));
FileTool.fileListToZip(fileList, fos2);
&lt;/code&gt;&lt;/pre&gt;
">文件工具类</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/lpEPljG7l/"" data-c="
          &lt;p&gt;pom.xml&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;!-- 手机号归属地查询 --&amp;gt;
&amp;lt;dependency&amp;gt;
&amp;lt;groupId&amp;gt;com.googlecode.libphonenumber&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;libphonenumber&amp;lt;/artifactId&amp;gt;
			&amp;lt;version&amp;gt;8.7.1&amp;lt;/version&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;com.googlecode.libphonenumber&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;geocoder&amp;lt;/artifactId&amp;gt;
			&amp;lt;version&amp;gt;2.76&amp;lt;/version&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;com.googlecode.libphonenumber&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;carrier&amp;lt;/artifactId&amp;gt;
			&amp;lt;version&amp;gt;1.66&amp;lt;/version&amp;gt;
		&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;工具类&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.abjy.tool;

import com.google.i18n.phonenumbers.PhoneNumberToCarrierMapper;
import com.google.i18n.phonenumbers.PhoneNumberUtil;
import com.google.i18n.phonenumbers.Phonenumber;
import com.google.i18n.phonenumbers.geocoding.PhoneNumberOfflineGeocoder;

import java.util.Locale;

import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;

public class PhoneUtil {
	private static PhoneNumberUtil phoneNumberUtil = PhoneNumberUtil.getInstance();
	private static PhoneNumberToCarrierMapper carrierMapper = PhoneNumberToCarrierMapper.getInstance();
	private static PhoneNumberOfflineGeocoder geocoder = PhoneNumberOfflineGeocoder.getInstance();

	/**
	 * 根据国家代码和手机号 判断手机号是否有效
	 * 
	 * @param phoneNumber
	 * @param countryCode
	 * @return
	 */
	public static boolean checkPhoneNumber(String phoneNumber, String countryCode) {
		int ccode = Integer.valueOf(countryCode);
		long phone = Long.valueOf(phoneNumber);
		Phonenumber.PhoneNumber pn = new Phonenumber.PhoneNumber();
		pn.setCountryCode(ccode);
		pn.setNationalNumber(phone);
		return phoneNumberUtil.isValidNumber(pn);
	}

	/**
	 * 根据国家代码和手机号 判断手机运营商  谷歌接口部分手机号无法识别，使用最下边的方法
	 * 
	 * @param phoneNumber
	 * @param countryCode
	 * @return
	 */
	public static String getCarrier(String phoneNumber, String countryCode) {
		int ccode = Integer.valueOf(countryCode);
		long phone = Long.valueOf(phoneNumber);
		Phonenumber.PhoneNumber pn = new Phonenumber.PhoneNumber();
		pn.setCountryCode(ccode);
		pn.setNationalNumber(phone);
		// 返回结果只有英文，自己转成成中文
		String carrierEn = carrierMapper.getNameForNumber(pn, Locale.ENGLISH);
		String carrierZh = &amp;quot;&amp;quot;;
		carrierZh += geocoder.getDescriptionForNumber(pn, Locale.CHINESE);
		switch (carrierEn) {
		case &amp;quot;China Mobile&amp;quot;:
			carrierZh += &amp;quot;移动&amp;quot;;
			break;
		case &amp;quot;China Unicom&amp;quot;:
			carrierZh += &amp;quot;联通&amp;quot;;
			break;
		case &amp;quot;China Telecom&amp;quot;:
			carrierZh += &amp;quot;电信&amp;quot;;
			break;
		default:
			break;
		}
		return carrierZh;
	}

	/**
	 *
	 * @Description: 根据国家代码和手机号 手机归属地 @date 2015-7-13 上午11:33:18 @param @param
	 *               phoneNumber @param @param countryCode @param @return
	 *               参数 @throws
	 */
	public static String getAdd(String phoneNumber, String countryCode) {
		int ccode = Integer.valueOf(countryCode);
		long phone = Long.valueOf(phoneNumber);
		Phonenumber.PhoneNumber pn = new Phonenumber.PhoneNumber();
		pn.setCountryCode(ccode);
		pn.setNationalNumber(phone);
		return geocoder.getDescriptionForNumber(pn, Locale.CHINA);
	}

	/**
	 * 获取手机号码归属地，省份+电信/联通/移动
	 * 
	 * @param phone
	 * @return
	 */
	public static String getPhoneInfo(String phone) {
		String result = &amp;quot;&amp;quot;;
		try {
			String uri = &amp;quot;https://www.baifubao.com/callback?cmd=1059&amp;amp;callback=phone&amp;amp;phone=&amp;quot; + phone;
			URL url = new URL(uri);
			HttpURLConnection connection = (HttpURLConnection) url.openConnection();
			connection.setDoOutput(true); // 设置该连接是可以输出的
			connection.setRequestMethod(&amp;quot;GET&amp;quot;); // 设置请求方式
			connection.setRequestProperty(&amp;quot;Content-Type&amp;quot;, &amp;quot;application/x-www-form-urlencoded; charset=UTF-8&amp;quot;);
			BufferedReader br = new BufferedReader(new InputStreamReader(connection.getInputStream(), &amp;quot;utf-8&amp;quot;));
			String line = null;
			StringBuilder resultString = new StringBuilder();
			while ((line = br.readLine()) != null) { // 读取数据
				resultString.append(line + &amp;quot;\n&amp;quot;);
			}
			connection.disconnect();
			result = resultString.toString().split(&amp;quot;area_operator\&amp;quot;:\&amp;quot;&amp;quot;)[1];
			result = result.split(&amp;quot;\&amp;quot;,&amp;quot;)[0];
		} catch (Exception e) {
			e.printStackTrace();
		}
		return result;
	}

    // main方法
	public static void main(String[] args) {
	System.out.println(PhoneUtil.getCarrier(&amp;quot;17638150415&amp;quot;, &amp;quot;+86&amp;quot;));
	System.err.println(getPhoneInfo(&amp;quot;17634710211&amp;quot;));
	}

}
&lt;/code&gt;&lt;/pre&gt;
">手机号码归属地查询</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/Xno3-hcnQ/"" data-c="
          &lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Random;

public class DateTool {

	/**
	 * 获取当前时间
	 * 
	 * @param format
	 * @return
	 * @throws ParseException
	 */
	public static Date getCurrentDate(String format) throws ParseException {
		SimpleDateFormat sdf = new SimpleDateFormat(format);
		SimpleDateFormat sdfDateTime = new SimpleDateFormat(format);
		return sdfDateTime.parse(sdf.format(new Date()));
	}

	/**
	 * 时间转字符串
	 * 
	 * @param date
	 * @return
	 * @throws ParseException
	 */
	public static String dateToString(Date date, String format) throws ParseException {
		SimpleDateFormat sdf = new SimpleDateFormat(format);
		return sdf.format(date);
	}

	/**
	 * 字符串转时间
	 * @param dateString
	 * @param format
	 * @return
	 * @throws ParseException
	 */
	public static Date stringToDate(String dateString, String format) throws ParseException {
		SimpleDateFormat sdf = new SimpleDateFormat(format);
		Date date = null;
		try {
			date = sdf.parse(dateString);
		} catch (ParseException e) {
			e.printStackTrace();
		}
		return date;
	}

	/**
	 * 当前时间+8位随机数，用于生成流水号
	 * 
	 * @return
	 */
	public static String getNumberCode() {
		SimpleDateFormat sdf = new SimpleDateFormat(&amp;quot;yyyyMMddHHmmss&amp;quot;);
		String nowDate = sdf.format(new Date());
		String result = &amp;quot;&amp;quot;;
		Random random = new Random();
		for (int i = 0; i &amp;lt; 8; i++) {
			result += random.nextInt(10);
		}
		return nowDate + result;
	}

	/* 
     * 将时间转换为时间戳
     */    
    public static String dateToStamp(String dateString) throws ParseException{
        String res;
        SimpleDateFormat sdf = new SimpleDateFormat(&amp;quot;yyyy-MM-dd HH:mm:ss&amp;quot;);
        Date date = sdf.parse(dateString);
        long ts = date.getTime();
        res = String.valueOf(ts);
        return res;
    }

	/* 
     * 将时间戳转换为时间
     */
    public static String stampToDate(String dateString){
        String res;
        SimpleDateFormat sdf = new SimpleDateFormat(&amp;quot;yyyy-MM-dd HH:mm:ss&amp;quot;);
        long lt = new Long(dateString);
        Date date = new Date(lt);
        res = sdf.format(date);
        return res;
    }
}
&lt;/code&gt;&lt;/pre&gt;
">时间工具类</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/aG0Qkh-dJ/"" data-c="
          &lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.MalformedURLException;
import java.net.ProtocolException;
import java.net.URL;

import javax.servlet.http.HttpServletRequest;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONObject;

public class IPTool {
	/**
	 * 获取登录用户的IP地址
	 *
	 * @param request
	 * @return
	 */
	public static String getIpAddress(HttpServletRequest request) {
		String ip = request.getHeader(&amp;quot;x-forwarded-for&amp;quot;);
		if (ip == null || ip.length() == 0 || &amp;quot;unknown&amp;quot;.equalsIgnoreCase(ip)) {
			ip = request.getHeader(&amp;quot;Proxy-Client-IP&amp;quot;);
		}
		if (ip == null || ip.length() == 0 || &amp;quot;unknown&amp;quot;.equalsIgnoreCase(ip)) {
			ip = request.getHeader(&amp;quot;WL-Proxy-Client-IP&amp;quot;);
		}
		if (ip == null || ip.length() == 0 || &amp;quot;unknown&amp;quot;.equalsIgnoreCase(ip)) {
			ip = request.getRemoteAddr();
		}
		if (&amp;quot;0:0:0:0:0:0:0:1&amp;quot;.equals(ip)) {
			ip = &amp;quot;127.0.0.1&amp;quot;;
		}
		if (ip.split(&amp;quot;,&amp;quot;).length &amp;gt; 1) {
			ip = ip.split(&amp;quot;,&amp;quot;)[0];
		}
		return ip;
	}

}
&lt;/code&gt;&lt;/pre&gt;
">获取IP地址</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/SZhFre_BA/"" data-c="
          &lt;h6 id=&#34;pomxml&#34;&gt;pom.xml&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;!-- 二维码生成 --&amp;gt;
&amp;lt;dependency&amp;gt;
	&amp;lt;groupId&amp;gt;com.google.zxing&amp;lt;/groupId&amp;gt;
	&amp;lt;artifactId&amp;gt;core&amp;lt;/artifactId&amp;gt;
	&amp;lt;version&amp;gt;3.3.0&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;工具类&#34;&gt;工具类&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import com.google.zxing.BarcodeFormat;
import com.google.zxing.EncodeHintType;
import com.google.zxing.MultiFormatWriter;
import com.google.zxing.common.BitMatrix;
 
import javax.imageio.ImageIO;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import java.io.OutputStream;
import java.util.HashMap;
import java.util.Map;
 
public class QrCode {
	
    public static String createQrCode(String url, String path, String fileName) {
        try {
            Map&amp;lt;EncodeHintType, String&amp;gt; hints = new HashMap&amp;lt;&amp;gt;();
            hints.put(EncodeHintType.CHARACTER_SET, &amp;quot;UTF-8&amp;quot;);
            BitMatrix bitMatrix = new MultiFormatWriter().encode(url, BarcodeFormat.QR_CODE, 400, 400, hints);
            File file = new File(path, fileName);
            if (file.exists() || ((file.getParentFile().exists() || file.getParentFile().mkdirs()) &amp;amp;&amp;amp; file.createNewFile())) {
                writeToFile(bitMatrix, &amp;quot;jpg&amp;quot;, file);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
        return null;
    }
 
    static void writeToFile(BitMatrix matrix, String format, File file) throws IOException {
        BufferedImage image = toBufferedImage(matrix);
        if (!ImageIO.write(image, format, file)) {
            throw new IOException(&amp;quot;Could not write an image of format &amp;quot; + format + &amp;quot; to &amp;quot; + file);
        }
    }
 
    static void writeToStream(BitMatrix matrix, String format, OutputStream stream) throws IOException {
        BufferedImage image = toBufferedImage(matrix);
        if (!ImageIO.write(image, format, stream)) {
            throw new IOException(&amp;quot;Could not write an image of format &amp;quot; + format);
        }
    }
 
    private static final int BLACK = 0xFF000000;
    private static final int WHITE = 0xFFFFFFFF;
 
    private static BufferedImage toBufferedImage(BitMatrix matrix) {
        int width = matrix.getWidth();
        int height = matrix.getHeight();
        BufferedImage image = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);
        for (int x = 0; x &amp;lt; width; x++) {
            for (int y = 0; y &amp;lt; height; y++) {
                image.setRGB(x, y, matrix.get(x, y) ? BLACK : WHITE);
            }
        }
        return image;
    }
}
&lt;/code&gt;&lt;/pre&gt;
">根据链接生成二维码</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/ZoApXrOLr/"" data-c="
          &lt;h6 id=&#34;pomxml&#34;&gt;pom.xml&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;!-- 钉钉sdk --&amp;gt;
&amp;lt;dependency&amp;gt;
	&amp;lt;groupId&amp;gt;com.dingtalk&amp;lt;/groupId&amp;gt;
	&amp;lt;artifactId&amp;gt;dingtalk-source&amp;lt;/artifactId&amp;gt;
	&amp;lt;version&amp;gt;1.0.0&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;dependency&amp;gt;
	&amp;lt;groupId&amp;gt;com.dingtalk&amp;lt;/groupId&amp;gt;
	&amp;lt;artifactId&amp;gt;dingtalk&amp;lt;/artifactId&amp;gt;
	&amp;lt;version&amp;gt;1.0.0&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;工具类&#34;&gt;工具类&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONArray;
import com.alibaba.fastjson.JSONObject;
import com.dingtalk.api.DefaultDingTalkClient;
import com.dingtalk.api.DingTalkClient;
import com.dingtalk.api.request.OapiDepartmentListIdsRequest;
import com.dingtalk.api.request.OapiGettokenRequest;
import com.dingtalk.api.request.OapiMessageCorpconversationAsyncsendV2Request;
import com.dingtalk.api.request.OapiUserListbypageRequest;
import com.dingtalk.api.response.OapiDepartmentListIdsResponse;
import com.dingtalk.api.response.OapiGettokenResponse;
import com.dingtalk.api.response.OapiMessageCorpconversationAsyncsendV2Response;
import com.dingtalk.api.response.OapiUserListbypageResponse;
import com.taobao.api.ApiException;

public class DingTalkTool {
	
	/**
	 * 根据Appkey和Appsecret获取AccessToken
	 * @return
	 */
	public static String getAccessToken(){
		String AccessToken = null;
		DefaultDingTalkClient client = new DefaultDingTalkClient(&amp;quot;https://oapi.dingtalk.com/gettoken&amp;quot;);
		OapiGettokenRequest request = new OapiGettokenRequest();
		request.setAppkey(&amp;quot;您的Appkey&amp;quot;);
		request.setAppsecret(&amp;quot;您的Appsecret&amp;quot;);
		request.setHttpMethod(&amp;quot;GET&amp;quot;);
		try {
			OapiGettokenResponse response = client.execute(request);
			JSONObject jsonObject = (JSONObject) JSON.parse(response.getBody());
			if (jsonObject.getString(&amp;quot;errmsg&amp;quot;).equals(&amp;quot;ok&amp;quot;)) {
				AccessToken = jsonObject.getString(&amp;quot;access_token&amp;quot;);
			}
		} catch (ApiException e) {
			e.printStackTrace();
		}
		return AccessToken;
	}
	
	/**
	 * 获取所有的部门id
	 * @param accessToken
	 */
	public static void getDepartmentIdList(String accessToken){
		DingTalkClient client = new DefaultDingTalkClient(&amp;quot;https://oapi.dingtalk.com/department/list_ids&amp;quot;);
		OapiDepartmentListIdsRequest request = new OapiDepartmentListIdsRequest();
		request.setId(&amp;quot;1&amp;quot;);
		request.setHttpMethod(&amp;quot;GET&amp;quot;);
		try {
			OapiDepartmentListIdsResponse response = client.execute(request, accessToken);
			System.out.println(response.getBody());
		} catch (ApiException e) {
			e.printStackTrace();
		}
	}
	
	/**
	 * 获取部门所有用户详细信息，遍历后根据手机号返回唯一的用户id
	 * @param accessToken
	 * @param userPhone
	 * @return
	 */
	public static String getUserId(String accessToken,String userPhone) {
		DingTalkClient client = new DefaultDingTalkClient(&amp;quot;https://oapi.dingtalk.com/user/listbypage&amp;quot;);
		OapiUserListbypageRequest request = new OapiUserListbypageRequest();
		request.setDepartmentId(18622967L);// 部门id
		request.setOffset(0L);
		request.setSize(10L);
		request.setOrder(&amp;quot;entry_desc&amp;quot;);
		request.setHttpMethod(&amp;quot;GET&amp;quot;);
		try {
			OapiUserListbypageResponse response = client.execute(request,accessToken);
			JSONObject jsonObject = (JSONObject) JSON.parse(response.getBody());
			JSONArray json = JSONArray.parseArray(jsonObject.getString(&amp;quot;userlist&amp;quot;)); // 首先把字符串转成 JSONArray  对象
			if(json.size()&amp;gt;0){
			  for(int i=0;i&amp;lt;json.size();i++){
			    JSONObject job = json.getJSONObject(i); 
			    if(job.get(&amp;quot;mobile&amp;quot;).equals(userPhone)){
			    	return (String) job.get(&amp;quot;userid&amp;quot;);
			    }
			  }
			}
		} catch (ApiException e) {
			e.printStackTrace();
		}
	    return &amp;quot;error&amp;quot;;
	}
	
	/**
	 * 根据用户id推送消息到个人
	 * @param accessToken
	 * @param UserId
	 */
	public static void pushMessage(String accessToken,String UserId,String content){
		
		DingTalkClient client = new DefaultDingTalkClient(&amp;quot;https://oapi.dingtalk.com/topapi/message/corpconversation/asyncsend_v2&amp;quot;);
		OapiMessageCorpconversationAsyncsendV2Request request = new OapiMessageCorpconversationAsyncsendV2Request();
		request.setUseridList(UserId);
		request.setAgentId(260932923L);
		request.setToAllUser(false);
		OapiMessageCorpconversationAsyncsendV2Request.Msg msg = new OapiMessageCorpconversationAsyncsendV2Request.Msg();
		msg.setMsgtype(&amp;quot;text&amp;quot;);
		msg.setText(new OapiMessageCorpconversationAsyncsendV2Request.Text());
		msg.getText().setContent(content);
		request.setMsg(msg);
		try {
			OapiMessageCorpconversationAsyncsendV2Response response = client.execute(request,accessToken);
		    System.out.println(response.getBody());
		} catch (ApiException e) {
			e.printStackTrace();
		}
	}
	
}

&lt;/code&gt;&lt;/pre&gt;
">钉钉推送工具类</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/96LJYl71m/"" data-c="
          &lt;h5 id=&#34;springboot自带加密方法&#34;&gt;SpringBoot自带加密方法：&lt;/h5&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;String encryptStr = DigestUtils.md5DigestAsHex(&amp;quot;需要加密的字符串&amp;quot;.getBytes());
&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&#34;md5加密解密&#34;&gt;MD5加密解密&lt;/h5&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.security.MessageDigest;
 
/**
 * 采用MD5加密解密
 */
public class MD5Tool {
	/*String s = new String(&amp;quot;tangfuqiang&amp;quot;);
	System.out.println(&amp;quot;原始：&amp;quot; + s);
	System.out.println(&amp;quot;MD5后：&amp;quot; + md5Encryption(s));
	System.out.println(&amp;quot;加密的：&amp;quot; + md5Decrypt(s));
	System.out.println(&amp;quot;解密的：&amp;quot; + md5Decrypt(md5Decrypt(s)));*/
	/***
	 * MD5加码 生成32位md5码
	 */
	public static String md5Encryption(String inStr){
		MessageDigest md5 = null;
		try{
			md5 = MessageDigest.getInstance(&amp;quot;MD5&amp;quot;);
		}catch (Exception e){
			System.out.println(e.toString());
			e.printStackTrace();
			return &amp;quot;&amp;quot;;
		}
		char[] charArray = inStr.toCharArray();
		byte[] byteArray = new byte[charArray.length];
 
		for (int i = 0; i &amp;lt; charArray.length; i++)
			byteArray[i] = (byte) charArray[i];
		byte[] md5Bytes = md5.digest(byteArray);
		StringBuffer hexValue = new StringBuffer();
		for (int i = 0; i &amp;lt; md5Bytes.length; i++){
			int val = ((int) md5Bytes[i]) &amp;amp; 0xff;
			if (val &amp;lt; 16)
				hexValue.append(&amp;quot;0&amp;quot;);
			hexValue.append(Integer.toHexString(val));
		}
		return hexValue.toString();
	}
 
	/**
	 * 加密解密算法 执行一次加密，两次解密
	 */ 
	public static String md5Decrypt(String inStr){
		char[] a = inStr.toCharArray();
		for (int i = 0; i &amp;lt; a.length; i++){
			a[i] = (char) (a[i] ^ &#39;t&#39;);
		}
		String s = new String(a);
		return s;
	}
 
}
&lt;/code&gt;&lt;/pre&gt;
">MD5加密解密</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/oGGzfLzXA/"" data-c="
          &lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;//fastjson JSONObject遍历
private static String getDesc(String jsonStr, String key) {
        JSONObject jsonObject = JSONObject.parseObject(jsonStr);
        for (Map.Entry entry : jsonObject.entrySet()) {
            if (key.equals(entry.getKey())) {
                return entry.getValue().toString();
            }
        }
		return null;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class JsonLoop {
 
    public static String json = &amp;quot;{\&amp;quot;TITLE\&amp;quot;:\&amp;quot;Json Title\&amp;quot;,\&amp;quot;FORM\&amp;quot;:{\&amp;quot;USERNAME\&amp;quot;:\&amp;quot;Rick and Morty\&amp;quot;},\&amp;quot;ARRAY\&amp;quot;:[{\&amp;quot;FIRST\&amp;quot;:\&amp;quot;Rick\&amp;quot;},{\&amp;quot;LAST\&amp;quot;:\&amp;quot;Morty\&amp;quot;}]}&amp;quot;;
 
    public static void jsonLoop(Object object) {
 
        if(object instanceof JSONObject) {
            JSONObject jsonObject = (JSONObject) object;
            for (Map.Entry&amp;lt;String, Object&amp;gt; entry: jsonObject.entrySet()) {
                Object o = entry.getValue();
                if(o instanceof String) {
                    System.out.println(&amp;quot;key:&amp;quot; + entry.getKey() + &amp;quot;，value:&amp;quot; + entry.getValue());
                } else {
                    jsonLoop(o);
                }
            }
        }
        if(object instanceof JSONArray) {
            JSONArray jsonArray = (JSONArray) object;
            for(int i = 0; i &amp;lt; jsonArray.size(); i ++) {
                jsonLoop(jsonArray.get(i));
            }
        }
    }
 
    public static void main(String[] args) {
 
        JSONObject jsonObject = JSON.parseObject(json);
        jsonLoop(jsonObject);
    }
}

&lt;/code&gt;&lt;/pre&gt;
">JSON对象遍历</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/NG8rgf9na/"" data-c="
          &lt;h6 id=&#34;pomxml&#34;&gt;pom.xml&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;!-- http --&amp;gt;
&amp;lt;dependency&amp;gt;
	&amp;lt;groupId&amp;gt;org.apache.httpcomponents&amp;lt;/groupId&amp;gt;
	&amp;lt;artifactId&amp;gt;httpclient&amp;lt;/artifactId&amp;gt;
	&amp;lt;version&amp;gt;4.5&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;dependency&amp;gt;
	&amp;lt;groupId&amp;gt;org.apache.httpcomponents&amp;lt;/groupId&amp;gt;
	&amp;lt;artifactId&amp;gt;httpmime&amp;lt;/artifactId&amp;gt;
	&amp;lt;version&amp;gt;4.5&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;dependency&amp;gt;
	&amp;lt;groupId&amp;gt;org.apache.httpcomponents&amp;lt;/groupId&amp;gt;
	&amp;lt;artifactId&amp;gt;httpcore&amp;lt;/artifactId&amp;gt;
	&amp;lt;version&amp;gt;4.4.5&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;工具类&#34;&gt;工具类&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import java.io.IOException;
import java.nio.charset.Charset;
import java.security.KeyManagementException;
import java.security.KeyStore;
import java.security.KeyStoreException;
import java.security.NoSuchAlgorithmException;
import java.security.cert.CertificateException;
import java.security.cert.X509Certificate;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;
import java.util.Map.Entry;
 
import javax.net.ssl.SSLContext;
 
import com.alibaba.fastjson.JSONObject;
import org.apache.http.HttpEntity;
import org.apache.http.NameValuePair;
import org.apache.http.ParseException;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.CloseableHttpResponse;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.config.ConnectionConfig;
import org.apache.http.config.Registry;
import org.apache.http.config.RegistryBuilder;
import org.apache.http.config.SocketConfig;
import org.apache.http.conn.socket.ConnectionSocketFactory;
import org.apache.http.conn.socket.LayeredConnectionSocketFactory;
import org.apache.http.conn.socket.PlainConnectionSocketFactory;
import org.apache.http.conn.ssl.SSLConnectionSocketFactory;
import org.apache.http.conn.ssl.SSLContexts;
import org.apache.http.conn.ssl.TrustStrategy;
import org.apache.http.impl.client.CloseableHttpClient;
import org.apache.http.impl.client.HttpClientBuilder;
import org.apache.http.impl.conn.PoolingHttpClientConnectionManager;
import org.apache.http.message.BasicHeader;
import org.apache.http.message.BasicNameValuePair;
import org.apache.http.util.EntityUtils;
 
/**
 * &amp;lt;p&amp;gt;类名: HttpUtils&amp;lt;/p&amp;gt;
 * &amp;lt;p&amp;gt;描述: http请求工具类&amp;lt;/p&amp;gt;
 * &amp;lt;p&amp;gt;修改时间: 2019年04月30日 上午10:12:35&amp;lt;/p&amp;gt;
 *
 * @author lidongyang
 */
public class HttpTool {
 
    public static String defaultEncoding = &amp;quot;utf-8&amp;quot;;
 
    /**
     * 发送http post请求，并返回响应实体
     *
     * @param url 请求地址
     * @return url响应实体
     */
    public static String postRequest(String url) {
        return postRequest(url, null, null);
    }
 
    /**
     * &amp;lt;p&amp;gt;方法名: postRequest&amp;lt;/p&amp;gt;
     * &amp;lt;p&amp;gt;描述: 发送httpPost请求&amp;lt;/p&amp;gt;
     *
     * @param url
     * @param params
     * @return
     */
    public static String postRequest(String url, Map&amp;lt;String, Object&amp;gt; params) {
        return postRequest(url, null, params);
    }
 
    /**
     * 发送http post请求，并返回响应实体
     *
     * @param url     访问的url
     * @param headers 请求需要添加的请求头
     * @param params  请求参数
     * @return
     */
    public static String postRequest(String url, Map&amp;lt;String, String&amp;gt; headers,
                                     Map&amp;lt;String, Object&amp;gt; params) {
        String result = null;
        CloseableHttpClient httpClient = buildHttpClient();
        HttpPost httpPost = new HttpPost(url);
 
        if (null != headers &amp;amp;&amp;amp; headers.size() &amp;gt; 0) {
            for (Entry&amp;lt;String, String&amp;gt; entry : headers.entrySet()) {
                String key = entry.getKey();
                String value = entry.getValue();
                httpPost.addHeader(new BasicHeader(key, value));
            }
        }
        if (null != params &amp;amp;&amp;amp; params.size() &amp;gt; 0) {
            List&amp;lt;NameValuePair&amp;gt; pairList = new ArrayList&amp;lt;NameValuePair&amp;gt;(params.size());
            for (Map.Entry&amp;lt;String, Object&amp;gt; entry : params.entrySet()) {
                NameValuePair pair = new BasicNameValuePair(entry.getKey(), entry.getValue().toString());
                pairList.add(pair);
            }
            httpPost.setEntity(new UrlEncodedFormEntity(pairList, Charset.forName(defaultEncoding)));
        }
 
        try {
            CloseableHttpResponse response = httpClient.execute(httpPost);
            try {
                HttpEntity entity = response.getEntity();
                if (entity != null) {
                    result = EntityUtils.toString(entity,
                            Charset.forName(defaultEncoding));
                }
            } finally {
                response.close();
            }
        } catch (Exception ex) {
            ex.printStackTrace();
        } finally {
            try {
                httpClient.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
 
        return result;
    }
 
    /**
     * 发送http get请求
     *
     * @param url 请求url
     * @return url返回内容
     */
    public static String getRequest(String url) {
        return getRequest(url, null);
    }
 
 
    /**
     * 发送http get请求
     *
     * @param url    请求的url
     * @param params 请求的参数
     * @return
     */
    public static String getRequest(String url, Map&amp;lt;String, Object&amp;gt; params) {
        return getRequest(url, null, params);
    }
 
    /**
     * 发送http get请求
     *
     * @param url        请求的url
     * @param headersMap 请求头
     * @param params     请求的参数
     * @return
     */
    public static String getRequest(String url, Map&amp;lt;String, String&amp;gt; headersMap, Map&amp;lt;String, Object&amp;gt; params) {
        String result = null;
        CloseableHttpClient httpClient = buildHttpClient();
        try {
            String apiUrl = url;
            if (null != params &amp;amp;&amp;amp; params.size() &amp;gt; 0) {
                StringBuffer param = new StringBuffer();
                int i = 0;
                for (String key : params.keySet()) {
                    if (i == 0)
                        param.append(&amp;quot;?&amp;quot;);
                    else
                        param.append(&amp;quot;&amp;amp;&amp;quot;);
                    param.append(key).append(&amp;quot;=&amp;quot;).append(params.get(key));
                    i++;
                }
                apiUrl += param;
            }
 
            HttpGet httpGet = new HttpGet(apiUrl);
            if (null != headersMap &amp;amp;&amp;amp; headersMap.size() &amp;gt; 0) {
                for (Entry&amp;lt;String, String&amp;gt; entry : headersMap.entrySet()) {
                    String key = entry.getKey();
                    String value = entry.getValue();
                    httpGet.addHeader(new BasicHeader(key, value));
                }
            }
            CloseableHttpResponse response = httpClient.execute(httpGet);
            try {
                HttpEntity entity = response.getEntity();
                if (null != entity) {
                    result = EntityUtils.toString(entity, defaultEncoding);
                }
            } finally {
                response.close();
            }
        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (ParseException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            try {
                httpClient.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
        return result;
    }
 
    /**
     * 创建httpclient
     *
     * @return
     */
    public static CloseableHttpClient buildHttpClient() {
        try {
            RegistryBuilder&amp;lt;ConnectionSocketFactory&amp;gt; builder = RegistryBuilder
                    .create();
            ConnectionSocketFactory factory = new PlainConnectionSocketFactory();
            builder.register(&amp;quot;http&amp;quot;, factory);
            KeyStore trustStore = KeyStore.getInstance(KeyStore
                    .getDefaultType());
            SSLContext context = SSLContexts.custom().useTLS()
                    .loadTrustMaterial(trustStore, new TrustStrategy() {
                        public boolean isTrusted(X509Certificate[] chain,
                                                 String authType) throws CertificateException {
                            return true;
                        }
                    }).build();
            LayeredConnectionSocketFactory sslFactory = new SSLConnectionSocketFactory(
                    context,
                    SSLConnectionSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);
            builder.register(&amp;quot;https&amp;quot;, sslFactory);
            Registry&amp;lt;ConnectionSocketFactory&amp;gt; registry = builder.build();
            PoolingHttpClientConnectionManager manager = new PoolingHttpClientConnectionManager(
                    registry);
            ConnectionConfig connConfig = ConnectionConfig.custom()
                    .setCharset(Charset.forName(defaultEncoding)).build();
            SocketConfig socketConfig = SocketConfig.custom()
                    .setSoTimeout(100000).build();
            manager.setDefaultConnectionConfig(connConfig);
            manager.setDefaultSocketConfig(socketConfig);
            return HttpClientBuilder.create().setConnectionManager(manager)
                    .build();
        } catch (KeyStoreException e) {
            e.printStackTrace();
        } catch (KeyManagementException e) {
            e.printStackTrace();
        } catch (NoSuchAlgorithmException e) {
            e.printStackTrace();
        }
        return null;
    }
 
    public static void main(String[] args) {
        String url = &amp;quot;请求路径&amp;quot;;
        JSONObject params = new JSONObject();
        params.put(&amp;quot;参数key&amp;quot;, &amp;quot;参数value&amp;quot;);
        String result = HttpTool.getRequest(url, params);
        System.out.println(&amp;quot;请求时间&amp;quot; + System.currentTimeMillis());
        System.out.println(&amp;quot;请求结果&amp;quot; + result);
    }
 
 
}
&lt;/code&gt;&lt;/pre&gt;
">Http请求工具类</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/W0F8CGbD5/"" data-c="
          &lt;h6 id=&#34;pomxml&#34;&gt;pom.xml&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;!-- Excel导出 --&amp;gt;
&amp;lt;dependency&amp;gt;
	&amp;lt;groupId&amp;gt;org.apache.poi&amp;lt;/groupId&amp;gt;
	&amp;lt;artifactId&amp;gt;poi&amp;lt;/artifactId&amp;gt;
	&amp;lt;version&amp;gt;3.17&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;工具类&#34;&gt;工具类&lt;/h6&gt;
&lt;pre&gt;&lt;code&gt;import org.apache.poi.hssf.usermodel.*;

import javax.servlet.http.HttpServletResponse;
import java.io.IOException;
import java.util.List;

/**
 * Excel工具类
 */
public class ExcelTool {

    /**
     * Excel表格导出
     * @param response HttpServletResponse对象
     * @param excelData Excel表格的数据，封装为List&amp;lt;List&amp;lt;String&amp;gt;&amp;gt;
     * @param sheetName sheet的名字
     * @param fileName 导出Excel的文件名
     * @param columnWidth Excel表格的宽度，建议为15
     * @throws IOException 抛IO异常
     */
    public static void exportExcel(HttpServletResponse response,
                                   List&amp;lt;List&amp;lt;String&amp;gt;&amp;gt; excelData, 
                                   String sheetName, 
                                   String fileName, 
                                   int columnWidth) throws IOException {

        //声明一个工作簿
        HSSFWorkbook workbook = new HSSFWorkbook();

        //生成一个表格，设置表格名称
        HSSFSheet sheet = workbook.createSheet(sheetName);

        //设置表格列宽度
        sheet.setDefaultColumnWidth(columnWidth);

        //写入List&amp;lt;List&amp;lt;String&amp;gt;&amp;gt;中的数据
        int rowIndex = 0;
        for(List&amp;lt;String&amp;gt; data : excelData){
            //创建一个row行，然后自增1
            HSSFRow row = sheet.createRow(rowIndex++);

            //遍历添加本行数据
            for (int i = 0; i &amp;lt; data.size(); i++) {
                //创建一个单元格
                HSSFCell cell = row.createCell(i);

                //创建一个内容对象
                HSSFRichTextString text = new HSSFRichTextString(data.get(i));

                //将内容对象的文字内容写入到单元格中
                cell.setCellValue(text);
            }
        }

        //准备将Excel的输出流通过response输出到页面下载
        //八进制输出流
        response.setContentType(&amp;quot;application/octet-stream&amp;quot;);

        //设置导出Excel的名称
        response.setHeader(&amp;quot;Content-disposition&amp;quot;, &amp;quot;attachment;filename=&amp;quot; + fileName);

        //刷新缓冲
        response.flushBuffer();

        //workbook将Excel写入到response的输出流中，供页面下载该Excel文件
        workbook.write(response.getOutputStream());

        //关闭workbook
        workbook.close();
    }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;h6 id=&#34;导出方法&#34;&gt;导出方法&lt;/h6&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void excelExportData(HttpServletRequest request, HttpServletResponse response)
			throws IOException, ParseException {
		// 设置excel表头
		List&amp;lt;List&amp;lt;String&amp;gt;&amp;gt; excelData = new ArrayList&amp;lt;&amp;gt;();
		List&amp;lt;String&amp;gt; head = new ArrayList&amp;lt;&amp;gt;();
		head.add(&amp;quot;第一列&amp;quot;);
		head.add(&amp;quot;第二列&amp;quot;);
		head.add(&amp;quot;第三列&amp;quot;);
		excelData.add(head);
		// 设置excel内容
		List&amp;lt;String&amp;gt; data1 = new ArrayList&amp;lt;&amp;gt;();
		data.add(&amp;quot;第一列第一行内容&amp;quot;);
    	data.add(&amp;quot;第二列第一行内容&amp;quot;);
    	data.add(&amp;quot;第二列第一行内容&amp;quot;);
		List&amp;lt;String&amp;gt; data2 = new ArrayList&amp;lt;&amp;gt;();
		data.add(&amp;quot;第一列第二行内容&amp;quot;);
    	data.add(&amp;quot;第二列第二行内容&amp;quot;);
    	data.add(&amp;quot;第二列第二行内容&amp;quot;);
    	List&amp;lt;String&amp;gt; data3 = new ArrayList&amp;lt;&amp;gt;();
		data.add(&amp;quot;第一列第三行内容&amp;quot;);
    	data.add(&amp;quot;第二列第三行内容&amp;quot;);
    	data.add(&amp;quot;第二列第三行内容&amp;quot;);
		excelData.add(data1);
    	excelData.add(data2);
    	excelData.add(data3);
		String sheetName = &amp;quot;导出文件测试&amp;quot;;
		String fileName = &amp;quot;导出文件测试.xls&amp;quot;;
		ExcelTool.exportExcel(response, excelData, sheetName, fileName, 15);
	}
&lt;/code&gt;&lt;/pre&gt;
">Excel导出工具类</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/ew2Vr4pXL/"" data-c="
          &lt;h4 id=&#34;常用代码&#34;&gt;常用代码&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;//句柄
MoveTo 824, 705
LeftClick 1
Delay 300
//切屏两下
KeyDown 18, 1
KeyPress 9, 2 //此处的2为切屏次数
KeyUp 18, 1
Delay 300
//选择变量
UserVar link = DropList{&amp;quot;zzabjy&amp;quot;:&amp;quot;www.zzabjy.com/&amp;quot;|&amp;quot;hencjw&amp;quot;:&amp;quot;www.hencjw.cn/&amp;quot;}=0 &amp;quot;网站地址&amp;quot;
SayString link
//运行次数
UserVar Var=100 &amp;quot;运行次数&amp;quot;
For Var
Next
//每隔一秒判断某个坐标的颜色【0 等于】【1 不等于】【2 近似于】
Do While true
    Delay 1000
    IfColor 949, 421, &amp;quot;00CCFF&amp;quot;, 0 Then
        Exit do  
    End If
Loop
Msgbox &amp;quot;判断成功&amp;quot;
//获取剪切板的内容
StuName = Plugin.Sys.GetCLB()
//设置剪切板的内容
Plugin.Sys.SetCLB(StuName)
//清除换行
NewStuName = Replace(StuName, vbcrlf, &amp;quot;&amp;quot;) 
Delay 800
//根据两个坐标截图以及字符串和变量拼接
Call Plugin.Pic.PrintScreen(634, 308, 1583, 880, &amp;quot;本地储存路径&amp;quot; + NewStuName &amp;amp; &amp;quot;.jpg&amp;quot;)
Delay 800
//截取字符串，从第7位开始截取，截取6位
userBirthDate = Mid(&amp;quot;410184199708263245&amp;quot;, 7, 6)//取出出生年月
//判断年龄是否大于25
If userBirthDate + 0 &amp;lt; 199510 Then 
    Msgbox &amp;quot;大于25岁&amp;quot;
End If
//判断字符串是否相等
userNation = &amp;quot;汉&amp;quot;
If userNation &amp;lt;&amp;gt; &amp;quot;汉&amp;quot; Then  
    Msgbox &amp;quot;是少数民族&amp;quot;  
End If
//判断数组是否包含
myname = &amp;quot;张三&amp;quot;
nameArray = array(&amp;quot;张三&amp;quot;,&amp;quot;李四&amp;quot;,&amp;quot;王五&amp;quot;)
If UBound(Filter(nameArray, myname)) + 1 &amp;gt; 0 Then  
    Msgbox &amp;quot;包含张三这个人&amp;quot; 
End If
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;帖子修改&#34;&gt;帖子修改&lt;/h4&gt;
&lt;h4 id=&#34;&#34;&gt;&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;// 打开文档
KeyPress &amp;quot;Enter&amp;quot;, 1
Do While true
    Delay 500
    IfColor 1123, 992, &amp;quot;FFFFFF&amp;quot;, 0 Then //判断文档是否打开
        Exit do  
    End If
Loop
// 全选 便于判断是否为空文档
KeyDown 17, 1
KeyPress 65, 1
KeyUp 17, 1
Delay 500
// 是用文字工具对文档整体格式整理
MoveTo 1053, 54
LeftClick 1
Delay 500
KeyPress &amp;quot;W&amp;quot;, 1
Delay 500
MoveTo 1053, 54
LeftClick 1
Delay 500
KeyPress &amp;quot;B&amp;quot;, 1
MoveTo 1053, 54
LeftClick 1
Delay 500
KeyPress &amp;quot;F&amp;quot;, 1
Delay 500
// 判断是否是空文档
IfColor 750, 250, &amp;quot;C7C7C7&amp;quot;, 1 Then
    IfColor 735, 270, &amp;quot;C7C7C7&amp;quot;, 1 Then
        IfColor 372, 253, &amp;quot;C7C7C7&amp;quot;, 1 Then
            //  保存当前文档
            KeyDown 17, 1
            KeyPress 83, 1
            KeyUp 17, 1
            Delay 500
            // 关闭文档
            KeyDown 17, 1
            KeyPress 87, 1
            KeyUp 17, 1
            Delay 500
            // 删除空白文档
            MoveTo 106, 1059
            LeftClick 1
            Delay 500
            KeyDown 17, 1
            KeyPress 68, 1
            KeyUp 17, 1
            Delay 800
            KeyPress &amp;quot;Enter&amp;quot;, 1
            Delay 800
            // 选择下一个文档
            KeyPress &amp;quot;Up&amp;quot;, 1
            Delay 500
            KeyPress &amp;quot;Down&amp;quot;, 1
            // 结束代码，重新执行
            EndScript
        End If
    End If
End If
// 打开替换框
Delay 600
KeyDown 17, 1
KeyPress 72, 1
KeyUp 17, 1
Delay 500
//--------------------------------将内容替换为空-----------------------------
// 定义一个数组，储存替换的内容，将其替换为空
contentArray1 = array(&amp;quot; &amp;quot;)
// 循环替换内容
For Each value In contentArray1
    // 设置剪贴板内容为数组中的内容
    Call Plugin.Sys.SetCLB(value)
    Delay 500
    // 粘贴替换内容
    KeyDown 17, 1
    KeyPress 86, 1
    KeyUp 17, 1
    Delay 500
    // 点击全部替换
    MoveTo 811, 596
    LeftClick 1
    Delay 500
    // 如果出现提示点击确定，不出现点击无任何反应
    MoveTo 878, 541
    LeftClick 1
    Delay 500
    // 点击确认替换完成
    MoveTo 934, 544
    LeftClick 1
    Delay 500
Next
//--------------------------------将内容替换为空-----------------------------
//--------------------------------将指定内容替换为指定值-----------------------------
Dim contentArray2 //创建替换对象，key为替换前的内容，value为替换后的内容
Set contentArray2 = CreateObject(&amp;quot;Scripting.Dictionary&amp;quot;)
contentArray2.Add &amp;quot;免费领取考试复习资料价值988元的视频课件!&amp;quot;, &amp;quot;领取考试复习资料和视频课件!&amp;quot;
contentArray2.Add &amp;quot;第一&amp;quot;, &amp;quot;第1&amp;quot;
contentArray2.Add &amp;quot;国家&amp;quot;, &amp;quot;我国&amp;quot;
contentArray2.Add &amp;quot;优秀&amp;quot;, &amp;quot;优-秀&amp;quot;
contentArray2.Add &amp;quot;最&amp;quot;,&amp;quot;zui&amp;quot;
oldContent = contentArray2.keys
newContent = contentArray2.Items
For i = 0 To contentArray2.count - 1 //从上到下遍历
    //替换敏感词
    KeyPress &amp;quot;BackSpace&amp;quot;, 1
    Delay 800
    Call Plugin.Sys.SetCLB(oldContent(i))
    KeyDown 17, 1
    KeyPress 86, 1
    KeyUp 17, 1
    Delay 500
    KeyPress &amp;quot;Tab&amp;quot;, 1
    Call Plugin.Sys.SetCLB(newContent(i))
    KeyDown 17, 1
    KeyPress 86, 1
    KeyUp 17, 1
    Delay 500
    // 点击全部替换
    MoveTo 811, 596
    LeftClick 1
    Delay 500
    // 如果出现提示点击确定，不出现点击无任何反应
    MoveTo 878, 541
    LeftClick 1
    Delay 500
    // 点击确认替换完成
    MoveTo 934, 544
    LeftClick 1
    Delay 500
Next
//--------------------------------将指定内容替换为指定值-----------------------------
//--------------------------------将符合条件的正则表达式替换为指定值-----------------------------
// 在word中使用正则表达式
// 打开高级搜索
MoveTo 743, 552
LeftClick 1
Delay 500
// 点击通配符
MoveTo 698, 652
LeftClick 1
Delay 500
//创建替换对象，key为符合条件的正则表达式，value为替换后的内容
Dim contentArray3 
Set contentArray3 = CreateObject(&amp;quot;Scripting.Dictionary&amp;quot;)
contentArray3.Add &amp;quot;[0-9]{11,}&amp;quot;,&amp;quot;177-3711-8576&amp;quot;
regularExpression = contentArray3.keys
replaceContent = contentArray3.Items
For i = 0 To contentArray3.count - 1//从上到下遍历
    // 移动到正则表达式框
    MoveTo 797, 434
    LeftClick 1
    Delay 500
    // 清空内容
    KeyDown 17, 1
    KeyPress 65, 1
    KeyUp 17, 1
    Delay 500
    KeyPress &amp;quot;BackSpace&amp;quot;, 1
    Delay 500
    //输入正则表达式
    SayString regularExpression(i)
    Delay 500
    // 输入替换后的内容
    MoveTo 792, 490
    LeftClick 1
    Delay 500
    // 清空内容
    KeyDown 17, 1
    KeyPress 65, 1
    KeyUp 17, 1
    Delay 500
    KeyPress &amp;quot;BackSpace&amp;quot;, 1
    Delay 500
    SayString replaceContent(i)
    Delay 500
    // 点击全部替换
    MoveTo 811, 731
    LeftClick 1
    Delay 500
    // 如果出现提示点击确定，不出现点击无任何反应
    MoveTo 876, 612
    LeftClick 1
    Delay 500
    // 点击确认替换完成
    MoveTo 934, 612
    LeftClick 1
    Delay 500
Next
// 在word中关闭正则表达式
// 关闭通配符
MoveTo 698, 652
LeftClick 1
Delay 500
// 选择普通文本替换
MoveTo 697, 670
LeftClick 1
Delay 500
// 关闭高级搜索
MoveTo 743, 552
LeftClick 1
Delay 500
//--------------------------------将符合条件的正则表达式替换为指定值-----------------------------
// 关闭替换框
KeyPress &amp;quot;Esc&amp;quot;, 1
Delay 600
//--------------------------
// 保存文档并退出
KeyDown 17, 1
KeyPress 83, 1
KeyUp 17, 1
Delay 800
KeyDown 17, 1
KeyPress 87, 1
KeyUp 17, 1
Delay 800
// 切换到下一个文档
MoveTo 106, 1059
LeftClick 1
Delay 500
KeyPress &amp;quot;Down&amp;quot;, 1
Delay 500
&lt;/code&gt;&lt;/pre&gt;
">按键精灵常用代码</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/XuQvrNvEf/"" data-c="
          &lt;p&gt;Less is more&lt;/p&gt;
&lt;p&gt;😘 Enjoy~&lt;/p&gt;
">关于</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://viaoh.github.io/post/qIcjFMRjk/"" data-c="
          &lt;p&gt;“行到水穷处、坐看云起时”，人生无处不宽窄。读书、交友、赶路、沉思，生活中的宽与窄，如微光照亮心房。正是在这样的状态下，近日偶得“宽窄”微思几则，摘录如下。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;做人准则&lt;/strong&gt;&lt;br&gt;
整理电脑里的资料，发现了自己八年前写下的一篇《做人准则》，共十条：一、少谈自己，无论是言谈还是在文章中，别人是不喜欢听的看的，除非是接受记者采访。二、不迁怒，不二过。三、说到做到，做不到就不要说。四、能马上办的，不拖后；今天能处理的，不拖至明天。五、衣服干干净净，做人也要干干净净。当你离开的时候，不要给人家留下被指责和批评的口实。六、利益面前，多想别人。推己及人。七、专注于自己的工作和写作，与此无关的少参与。八、写序、题词，能推掉的尽量推掉。少参加研讨会。九、无欲则刚。不求人，自己便会很强大。十、一切节约归根结底是时间的节约。浪费时间的事情尽量少做直至不做。&lt;br&gt;
以上十条，有的到今天也没做好。比如，总是想着把一件事情做完美，想找整块时间来做，或者等把某件事做了再做某事，其实，哪有那么多整块时间？往往是这个还没开始做，下个事情又来了，原定的工作就拖下来。一件事，不管是大是小，还是要先做起来，再说做好。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;朋友&lt;/strong&gt;&lt;br&gt;
我的朋友不多，我也不想多。十几年、二十几年还能继续走在一起的，应该是真朋友。朋友身上的闪光点，让我见贤思齐。小时候抄马克思关于友谊的名言：“友谊需要用忠诚去播种，用热情去浇灌，用原则去培养，用谅解去护理。”当时似懂非懂，现在看这句话真有道理。不按这句话做的，友谊都长久不了，有的也许都不能叫友谊。&lt;br&gt;
岁尾年初，我都会为新结识的朋友感到高兴，也为老朋友的渐渐远去而难过。远去有我的原因，也有对方的原因。有时候也说不上是什么原因。&lt;br&gt;
我帮很多朋友做过的事，朋友要是不提，或者我不翻看从前的书信、日记，我自己也不会想起。比如，很多年以前，朋友的孩子需要一种药，我辗转坐公交车到医院挂号、排队去买。朋友需要当地买不到的教材，我到他说的专门书店去买，这家没有再找另一家。冬天迎着风，夏天顶着太阳。我认为这是对朋友的应尽之责。只是，今天如果有人还提出这样的要求，我肯定要掂量有没有必要去，我得考虑这样做值不值。&lt;br&gt;
我是不是变得世故了？也不全是。我想起马克思关于友谊的论述。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;读书&lt;/strong&gt;&lt;br&gt;
春秋战国时期，文字都是刻在竹简上，“学富五车”，换成今天的书其实并不多。古代可能是因为典籍少，所以要反复阅读，而今天书太多了，对大多数人来说，只能走马观花，并不能走心。&lt;br&gt;
我经常说，一个作家只要不犯法、不违反道德规范，对生活体验得越多越好。我现在的问题是，精读太少，经常有“书到用时方恨少”的感觉。现在每年出那么多书，绝大多数没时间去看，当然，也没必要全看。但是，怎么把书由厚读薄，由薄读厚，对我们是考验。有的人读书不多，读过的都是精华，且都被他吸收了，这就比囫囵吞枣读千本万本要好。我如果喜欢一个作家，往往把他的作品翻来覆去地读，每天都读，感觉学习的效果就很明显。我曾在地铁里看到一个女孩抱着《中日大词典》一直在看，旁边有什么对她丝毫不影响。她也许是为了考试，也许是为了工作，但以这样的精神去读书，真的让我感到震撼。我们如果能把高考前的那股劲头拿出来一直学习、读书，那肯定会战无不胜、攻无不克。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;人生是一本书&lt;/strong&gt;&lt;br&gt;
每个人都在书写他自己的历史，也可以说在写他自己这本书。也许这本书不会出版，但是，它是存在的。&lt;br&gt;
当我们老了的时候，我们当然希望这本书厚重、大气，会被越来越多的人提起、翻看。不希望这本书被放在角落沾满灰尘，或者外面看着光鲜，里面真正给人启迪的不多。我们当然也不希望人家看完后说，什么书，全部是“假大空”。还是想有一些实实在在的东西，哪怕薄一些，但是，要有真实的、有意义的东西在其中。&lt;br&gt;
我们每天都在书写自己这本书。后人在看着我们书写。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;祖先&lt;/strong&gt;&lt;br&gt;
我曾在一本儿童小说中写了儿子和父亲的对话：&lt;br&gt;
“爸爸，这么多星星，是不是我们的祖先那时候也在看它们呢？”&lt;br&gt;
“那当然，它们的寿命都是以亿计算的。”&lt;br&gt;
“您说我们的祖先都是干什么的？”&lt;br&gt;
“我们不是大户人家，没有家谱，也就没有记载。”&lt;br&gt;
“有没有带兵打仗的？”&lt;br&gt;
“可能有。”&lt;br&gt;
“有没有当官的？”&lt;br&gt;
“可能有。”&lt;br&gt;
“有没有坐过牢的？”&lt;br&gt;
“可能有。”&lt;br&gt;
“有没有当大官的？”&lt;br&gt;
“可能有。”&lt;br&gt;
“有没有做不好的事，被人家在背后指指点点的？”&lt;br&gt;
“可能有。”&lt;br&gt;
“这个不好，最好不要有。”&lt;br&gt;
“是呀，我们虽然不知道我们的祖先是从哪里来的，曾经做过什么，但是，可以通过我们的努力，让我们的后人为我们感到骄傲。”&lt;br&gt;
“爸爸，我要努力，成为您的骄傲。”&lt;br&gt;
“儿子，我更要努力，让你为爸爸骄傲。”&lt;br&gt;
我们的祖先里出过英雄还是不好的人，我们无法去考证。但是，我们可以做的是，不给我们的后人丢脸。每当我看到有的人在那里旁若无人吹嘘的时候，我就想，如果他的孩子在场，孩子会怎么想。当然，这还不算大事。倘若做了违法犯罪的事进了监狱，肯定会影响孩子的一生。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;幸福&lt;/strong&gt;&lt;br&gt;
随着年龄的增加，我已经对有些事情看得没有以前那么重了，觉得还是平平淡淡最好。写好自己的文字，做好自己的工作，有更多的时间和家里人在一起，有一些谈得来的朋友，一生就满足了。&lt;br&gt;
写到这里，想起了刚刚在《读者》杂志看到的一篇短文，上帝问人，你的愿望是什么，那个人大概说了我上面的话。上帝扭头就走，上帝说，这样的生活也是我所向往的。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;调兵遣将&lt;/strong&gt;&lt;br&gt;
《新华字典》里的多数汉字人们都会用，但是，要组合得不一般，甚至光彩夺目，顿叫山河增色，却不是每个人都能做到的。优秀的作家都有这种本事，就好像优秀的音乐家对声音和节奏特别敏感一样。天分特别重要，没有天分，很多时候努力一辈子，也是徒劳，如我。一想起来就很沮丧，沮丧。&lt;br&gt;
上天把我降生到这个世界，最适合我做的是什么工作呢？要正确认识自己，很难，很难。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;替古人担忧&lt;/strong&gt;&lt;br&gt;
看历史书，时不时替古人惋惜，为什么要这样走，而不那样走。这是我们跳出局外看，如果身处其中，可能比他们还要傻。我们正在书写明天的历史，只是我们的事情小，不会惊天动地，但是，也是个人的历史，吸取历史的教训，不要出昏招，坚实走好每一步。&lt;br&gt;
“以史为鉴”是好话，很多时候，我们并没有认真地去总结历史、吸取教训。就说骄兵必败吧，说了几千年，还是有人在重蹈覆辙，大的，小的。不迁怒、不二过，孔子那个时候就说，我们今天是不是真做到了？&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;他是一个人&lt;/strong&gt;&lt;br&gt;
作家严文井在《悼沈从文先生》一文的最后说：“他来了，又去了，一生曲曲折折、辛辛苦苦，但是不虚此行。他是一个人。”&lt;br&gt;
小时候在家乡经常听到这句话的反话，长大了在电视剧里也会看到，一个人对另一个人气愤到了极点，会声嘶力竭地说，你不是人、他不是人。在骂者眼里，人是有标准的，不管这个标准是高是低。严文井说沈从文是一个人，应该是一个大写的人，一个优秀的人。在严文井眼里，肯定也有小写的人，不能称之为人的人，他只是没有说出来而已。&lt;br&gt;
我也经常想起小的时候大人们常说的一句话，书都读到哪里去了？意思是说，读书人和不读书人还是有区别的。生活中，一个人饱读诗书，但是，他的言行还没有不读书的人文明或者高尚，那他读书又有什么用呢？&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;放下&lt;/strong&gt;&lt;br&gt;
看一个内部刊物《禅》，其中有一篇文章《放下你的心》。文章说：“对功名利禄放不下，出现了跑官、买官、贪官；对金钱富贵放不下，催生了贪污、受贿、盗窃；对爱情婚姻放不下，产生了痴男、怨女、殉情。”“你只有放下一种执著，才能收获一种自在。”&lt;br&gt;
该放下的是要放下，不该做的也不要去做，但是，全部放下就好吗？我看未必。还是古人说得好，恰到好处，过犹不及，不好全都放下，也不好全都放不下。&lt;/p&gt;
">孙卫卫“宽窄”微思录</a>
      </div>
      
    </div>
    <div class="page">
      <div id="page_ul"></div>
    </div>
  </div>
</div>
<script>
  !function () {
    let searchMask = document.querySelector('#search_mask');
    let result = document.querySelector('#result');
    let items = document.querySelectorAll('.item');
    let searchBox = document.querySelector('#search');
    let statCount = document.querySelector('#stat_count');
    let statTimes = document.querySelector('#stat_times');
    let pageUl = document.querySelector('#page_ul');
    let close = document.querySelector('#close');
    
    close.addEventListener('click', function() {
      searchMask.style = 'display: none;'
    })

    let finds = [];
    let contents = [];
    let pageSize = 10;
    items.forEach(item => {
      let a = item.querySelector('a');
      contents.push({
        title: a.innerText,
        details: a.dataset.c,
        link: a.href
      })
      item.remove();
    })

    function insertStr(soure, start, count) {
      let newStr = soure.substr(start, count);
      return soure.slice(0, start) + '<em>' + newStr + '</em>' + soure.slice(start + count);
    }

    pageUl.addEventListener('click', function(event) {
      let target = event.target;
      if (target.__proto__ === HTMLSpanElement.prototype) {
        appendResults(parseInt(target.dataset.i));
      }
    })

    function appendResults(index) {
      let htmlResult = '';
      let start = index || 0;
      let end = Math.min(start + pageSize, finds.length);
      for (let i = start; i < end; i++) {
        const current = finds[i];
        let html = current.title;
        let sum = 0;
        let positions = current.positions;
        positions.forEach(position => {
          html = insertStr(html, position.start + sum, position.count);
          sum += 9;
        })
        htmlResult += `<div class="item"><a class="result-title" href="${current.link}">${html}</a></div>`;
      }
      result.innerHTML = htmlResult;
      pageUl.innerHTML = '';
      let count = finds.length / pageSize;
      let lis = '';
      if (start !== 0) {
        lis += `<span class="fa fa-angle-left" data-i='${start - 1}'></span>`;
      }
      for (let i = 0; i < count; i++) {
        lis += `<span class='${i === start?'current':''}' data-i='${i}'>${i+1}</span>`;     
      }
      if (start+1 < count) {
        lis += `<span class="fa fa-angle-right" data-i='${start+1}'></span>`;  
      }
      pageUl.innerHTML = lis;
    }

    function search(delay) {
      let timer = null
      return function () {
        clearTimeout(timer)
        timer = setTimeout(() => {
          let start = Date.now();
          let segments = searchBox.value.split(' ').filter(c => c != '');
          if (segments.length <= 0) {
            return;
          }
          finds = [];
          let htmlResult = '';
          contents.forEach(content => {
            let title = content.title;
            let positions = [];
            let find = false;
            segments.forEach((segment) => {
              if (content.title.includes(segment)) {
                find = true;
                positions.push({
                  start: content.title.indexOf(segment),
                  count: segment.length
                })
              } else if (content.details.includes(segment)) {
                find = true;
              }
            });
            if (find) {
              finds.push({
                title: content.title,
                link: content.link,
                positions
              });
            }
          })
          appendResults(0);
          statCount.textContent = finds.length;
          statTimes.textContent = Date.now() - start;
        }, delay)
      }
    }
    searchBox.addEventListener('input', search(200));
  }()
</script>

<input hidden id="copy" />
<script>
  !function () {
    let times = document.querySelectorAll('.publish-time');
    for (let i = 0; i < times.length; i++) {
      let date = times[i].dataset.t;
      let time = Math.floor((new Date().getTime() - new Date(date).getTime()) / 1000);
      if (time < 60) {
        str = time + '秒之前';
      } else if (time < 3600) {
        str = Math.floor(time / 60) + '分钟之前';
      } else if (time >= 3600 && time < 86400) {
        str = Math.floor(time / 3600) + '小时之前';
      } else if (time >= 86400 && time < 259200) {
        str = Math.floor(time / 86400) + '天之前';
      } else {
        str = times[i].textContent;
      }
      times[i].textContent = str;
    }
  }();
</script>

<script>
  let language = '';
  if (language !== '') {
    let map = new Map();
    if (language === 'en') {
      map.set('search', 'Search');
      map.set('category', 'Categories');
      map.set('article', 'Articles');
      map.set('tag', 'Tags');
      map.set('top', 'Top');
      map.set('publish', 'published');
      map.set('minute', ' minutes');
      map.set('read-more', 'Read More');
      map.set('view', 'View');
      map.set('words', ' words');
      map.set('category-in', 'category in');
      map.set('preview', 'Meta');
      map.set('index', 'Toc');
      map.set('no-archives', "You haven't created yet");
      map.set('archives', " articles in total");
      map.set('cloud-tags', " tags in total");
      map.set('copyright', "Copyright: ");
      map.set('author', "Author: ");
      map.set('link', "Link: ");
      map.set('leave-message', "Leave a message");
      map.set('format', "Links Format");
      map.set('site-name', "Name: ");
      map.set('site-link', "Link: ");
      map.set('site-desc', "Desc: ");
      map.set('stat', " related results, taking ");
      map.set('stat-time', " ms");
      map.set('site-img', "Image: ");
    }

    if (map.size > 0) {
      let lanElems = document.querySelectorAll('.language');
      lanElems.forEach(elem => {
        let lan = elem.dataset.lan, text = map.get(lan);
        if (elem.__proto__ === HTMLInputElement.prototype) {
          elem.placeholder = text
        } else {
          if (elem.dataset.count) {
            text = elem.dataset.count + text;
          }
          elem.textContent = text;
        }
      })
    }
  }

  window.Clipboard = (function (window, document, navigator) {
    var textArea,
      copy;

    // 判断是不是ios端
    function isOS() {
      return navigator.userAgent.match(/ipad|iphone/i);
    }
    //创建文本元素
    function createTextArea(text) {
      textArea = document.createElement('textArea');
      textArea.value = text;
      textArea.style.width = 0;
      textArea.style.height = 0;
      textArea.clientHeight = 0;
      textArea.clientWidth = 0;
      document.body.appendChild(textArea);
    }
    //选择内容
    function selectText() {
      var range,
        selection;

      if (isOS()) {
        range = document.createRange();
        range.selectNodeContents(textArea);
        selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        textArea.setSelectionRange(0, 999999);
      } else {
        textArea.select();
      }
    }

    //复制到剪贴板
    function copyToClipboard() {
      try {
        document.execCommand("Copy")
      } catch (err) {
        alert("复制错误！请手动复制！")
      }
      document.body.removeChild(textArea);
    }

    copy = function (text) {
      createTextArea(text);
      selectText();
      copyToClipboard();
    };

    return {
      copy: copy
    };
  })(window, document, navigator);

  function copyCode(e) {
    if (e.srcElement.tagName === 'SPAN' && e.srcElement.classList.contains('copy-code')) {
      let code = e.currentTarget.querySelector('code');
      var text = code.innerText;
      if (e.srcElement.textContent === '复制成功') {
        return;
      }
      e.srcElement.textContent = '复制成功';
      (function (elem) {
        setTimeout(() => {
          if (elem.textContent === '复制成功') {
            elem.textContent = '复制代码'
          }
        }, 1000);
      })(e.srcElement)
      Clipboard.copy(text);
    }
  }

  let pres = document.querySelectorAll('pre');
  pres.forEach(pre => {
    let code = pre.querySelector('code');
    let copyElem = document.createElement('span');
    copyElem.classList.add('copy-code');
    copyElem.textContent = '复制代码';
    pre.appendChild(copyElem);
    pre.onclick = copyCode
  })

</script>
<script src="/media/js/motion.js"></script>


  <script
    src="https://cdn.jsdelivr.net/gh/cferdinandi/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
  <script>
    var scroll = new SmoothScroll('a[href*="#"]', {
      speed: 200
    });
  </script>



<script src="/media/js/mouse/peace.js"></script>





</html>